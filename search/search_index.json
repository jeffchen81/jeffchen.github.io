{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u9996\u9875 \u5173\u4e8e\u7ad9\u957f Jeff.Chen: \u4e00\u4e2a80\u540e\u7684\u8f6f\u4ef6\u5de5\u7a0b\u5e08\uff0c\u73b0\u5c45\u4f4f\u5728\u4e0a\u6d77\u3002","title":"\u9996\u9875"},{"location":"#_1","text":"","title":"\u9996\u9875"},{"location":"#_2","text":"Jeff.Chen: \u4e00\u4e2a80\u540e\u7684\u8f6f\u4ef6\u5de5\u7a0b\u5e08\uff0c\u73b0\u5c45\u4f4f\u5728\u4e0a\u6d77\u3002","title":"\u5173\u4e8e\u7ad9\u957f"},{"location":"01.\u53c2\u8003\u624b\u518c/markdown/","text":"Markdown\u8bed\u6cd5 \u5e38\u7528\u8bed\u6cd5 \u94fe\u63a5 [\u663e\u793a\u6587\u672c](\u76ee\u6807URI) \u5206\u6bb5 ## H2\u6bb5\u843d\u6807\u9898 \u5217\u8868 * \u5217\u8868\u9879 \u6e90\u7801\u5757 `\u4ee3\u7801` \u5f15\u7528 \u5f15\u7528\u7684\u6587\u672c \u6587\u672c\u52a0\u7c97 __\u6587\u5b57__ \u8868\u683c \u7b2c\u4e00\u5217\u540d | \u7b2c\u4e8c\u5217\u540d :-----: | ------: \u5c45\u4e2d\u884c1 | \u5c45\u53f3\u884c1 \u5c45\u4e2d\u884c1 | \u5c45\u53f3\u884c2","title":"Markdown\u8bed\u6cd5"},{"location":"01.\u53c2\u8003\u624b\u518c/markdown/#markdown","text":"","title":"Markdown\u8bed\u6cd5"},{"location":"01.\u53c2\u8003\u624b\u518c/markdown/#_1","text":"\u94fe\u63a5 [\u663e\u793a\u6587\u672c](\u76ee\u6807URI) \u5206\u6bb5 ## H2\u6bb5\u843d\u6807\u9898 \u5217\u8868 * \u5217\u8868\u9879 \u6e90\u7801\u5757 `\u4ee3\u7801` \u5f15\u7528 \u5f15\u7528\u7684\u6587\u672c \u6587\u672c\u52a0\u7c97 __\u6587\u5b57__ \u8868\u683c \u7b2c\u4e00\u5217\u540d | \u7b2c\u4e8c\u5217\u540d :-----: | ------: \u5c45\u4e2d\u884c1 | \u5c45\u53f3\u884c1 \u5c45\u4e2d\u884c1 | \u5c45\u53f3\u884c2","title":"\u5e38\u7528\u8bed\u6cd5"},{"location":"01.\u53c2\u8003\u624b\u518c/svn/","text":"SVN \u7248\u672c\u7ba1\u7406 \u5e38\u7528\u547d\u4ee4 \u68c0\u51fa\u9879\u76ee svn checkout http://IP:Port/svn/docs/ \u9879\u76ee\u8def\u5f84 / --username= \u7528\u6237\u540d \u6dfb\u52a0\u6587\u4ef6 svn add \u6587\u4ef6|\u76ee\u5f55 \u63d0\u4ea4\u8fdc\u7aef\u670d\u52a1\u5668 svn commit -m 'commit msg' \u53c2\u8003 SVN \u6559\u7a0b|\u83dc\u9e1f\u6559\u7a0b","title":"SVN \u7248\u672c\u7ba1\u7406"},{"location":"01.\u53c2\u8003\u624b\u518c/svn/#svn","text":"","title":"SVN \u7248\u672c\u7ba1\u7406"},{"location":"01.\u53c2\u8003\u624b\u518c/svn/#_1","text":"\u68c0\u51fa\u9879\u76ee svn checkout http://IP:Port/svn/docs/ \u9879\u76ee\u8def\u5f84 / --username= \u7528\u6237\u540d \u6dfb\u52a0\u6587\u4ef6 svn add \u6587\u4ef6|\u76ee\u5f55 \u63d0\u4ea4\u8fdc\u7aef\u670d\u52a1\u5668 svn commit -m 'commit msg'","title":"\u5e38\u7528\u547d\u4ee4"},{"location":"01.\u53c2\u8003\u624b\u518c/svn/#_2","text":"SVN \u6559\u7a0b|\u83dc\u9e1f\u6559\u7a0b","title":"\u53c2\u8003"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/mkdocs/","text":"MkDocs \u9759\u6001\u7f51\u9875\u751f\u6210 For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"MkDocs \u9759\u6001\u7f51\u9875\u751f\u6210"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/mkdocs/#mkdocs","text":"For full documentation visit mkdocs.org .","title":"MkDocs \u9759\u6001\u7f51\u9875\u751f\u6210"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/mkdocs/#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message.","title":"Commands"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/mkdocs/#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/js\u5e93/iview-admin/","text":"\u57fa\u4e8eVue\u7684\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u524d\u7aefUI\u65b9\u6848 \u53c2\u8003 \u5b98\u65b9github","title":"\u57fa\u4e8eVue\u7684\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u524d\u7aefUI\u65b9\u6848"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/js\u5e93/iview-admin/#vueui","text":"","title":"\u57fa\u4e8eVue\u7684\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u524d\u7aefUI\u65b9\u6848"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/js\u5e93/iview-admin/#_1","text":"\u5b98\u65b9github","title":"\u53c2\u8003"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/jvm\u7cfb/jvm\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536gc/","text":"JVM\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536GC JVM\u5185\u5b58\u57fa\u7840 JVM\u5806 Java\u5bf9\u8c61\u7684\u6d3b\u52a8\u7a7a\u95f4\uff0c\u7a0b\u5e8f\u4e2d\u7684\u7c7b\u7684\u5bf9\u8c61\u4ece\u4e2d\u5206\u914d\u7a7a\u95f4\uff0c\u5176\u5b58\u50a8\u7740\u6b63\u5728\u8fd0\u884c\u7740\u7684\u5e94\u7528\u7a0b\u5e8f\u7528\u5230\u7684\u6240\u6709\u5bf9\u8c61\u3002 \u5bf9\u8c61\u7684\u5efa\u7acb\u65b9\u5f0f\u5c31\u662f\u90a3\u4e9bnew\u4e00\u7c7b\u7684\u64cd\u4f5c\uff0c\u5f53\u5bf9\u8c61\u65e0\u7528\u540e\uff0c\u662fGC\u6765\u8d1f\u8d23\u8fd9\u4e2a\u65e0\u7528\u7684\u5bf9\u8c61\u3002 \u5206\u7c7b\uff1a \u65b0\u57df\uff1a\u5b58\u50a8\u6240\u6709\u65b0\u6210\u751f\u7684\u5bf9\u8c61 Eden: From Space: \u7b80\u79f0A\u7a7a\u95f4 To Space: \u7b80\u79f0B\u7a7a\u95f4 \u65e7\u57df\uff1a\u65b0\u57df\u4e2d\u7684\u5bf9\u8c61\uff0c\u7ecf\u8fc7\u4e86\u4e00\u5b9a\u6b21\u6570\u7684GC\u5faa\u73af\u540e\uff0c\u88ab\u79fb\u5165\u65e7\u57df \u6c38\u4e45\u57df\uff1a\u5b58\u50a8\u7c7b\u548c\u65b9\u6cd5\u5bf9\u8c61\uff0c\u4ece\u914d\u7f6e\u7684\u89d2\u5ea6\u770b\uff0c\u8fd9\u4e2a\u57df\u662f\u72ec\u7acb\u7684\uff0c\u4e0d\u5305\u62ec\u5728JVM\u5806\u5185\u3002\u9ed8\u8ba4\u4e3a4M\u3002 \u4e00\u4e2a2G\u5806\u5927\u5c0f\u7684JVM\uff0c\u53ef\u80fd\u603b\u5171\u5360\u7528\u591a\u5c11\u5185\u5b58\u7684\uff1f \u5806\u5185\u5b58 \uff0b \u7ebf\u7a0b\u6570 \uff0a \u7ebf\u7a0b\u6808 \uff0b \u6c38\u4e45\u4ee3 \uff0b \u4e8c\u8fdb\u5236\u4ee3\u7801 \uff0b \u5806\u5916\u5185\u5b58 \u5806\u5185\u5b58\uff1a \u5b58\u50a8Java\u5bf9\u8c61\uff0c\u9ed8\u8ba4\u4e3a\u7269\u7406\u5185\u5b58\u76841/64 \u7ebf\u7a0b\u6808\uff1a \u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\uff08\u539f\u5b50\u7c7b\u578b\uff0c\u5f15\u7528\uff09\u53ca\u5176\u4ed6\uff0c\u9ed8\u8ba4\u4e3a1M \u6c38\u4e45\u4ee3\uff1a \u5b58\u50a8\u7c7b\u5b9a\u4e49\u53ca\u5e38\u91cf\u6c60\uff0c\u6ce8\u610fJDK7/8\u7684\u533a\u522b \u4e8c\u8fdb\u5236\u4ee3\u7801\uff1aJDK7\u4e0e8\uff0c\u6253\u5f00\u591a\u5c42\u7f16\u8bd1\u65f6\u7684\u9ed8\u8ba4\u503c\u4e0d\u4e00\u6837\uff0c\u4ece48\u5230240M \u5806\u5916\u5185\u5b58\uff1a \u88abNetty\uff0c\u5806\u5916\u7f13\u5b58\u7b49\u4f7f\u7528\uff0c\u9ed8\u8ba4\u6700\u5927\u503c\u7ea6\u4e3a\u5806\u5185\u5b58\u5927\u5c0f \u5806\u5185\u5b58\u8bbe\u7f6e\u4e3a2G\uff0c\u90a3\u4e00\u4e2a\u67091000\u4e2a\u7ebf\u7a0b\u7684JVM\u53ef\u80fd\u9700\u8981: 2G + 1000 * 1M + 256M + 48/240M + (\uff5e2G) = 5.5G (3.5G) \u5783\u573e\u56de\u6536GC \u76ee\u7684\uff1a\u5728\u5806\u4e2d\uff0c\u627e\u5230\u5df2\u7ecf\u65e0\u7528\u7684\u5bf9\u8c61\uff0c\u5e76\u628a\u8fd9\u4e9b\u5bf9\u8c61\u5360\u7528\u7684\u7a7a\u95f4\u6536\u56de\u4f7f\u5176\u53ef\u4ee5\u91cd\u65b0\u5229\u7528\u3002 \u7b97\u6cd5\u601d\u8def\uff1a \u628a\u6240\u6709\u5bf9\u8c61\u7ec4\u6210\u4e00\u4e2a\u6811\u72b6\u7ed3\u6784\u96c6\u5408 \u4ece\u6811\u6839\u5f00\u59cb\u627e\uff0c\u53ea\u8981\u53ef\u4ee5\u627e\u5230\u7684\u90fd\u662f\u6d3b\u52a8\u5bf9\u8c61\uff0c\u5982\u679c\u627e\u4e0d\u5230\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u5e94\u8be5\u88ab\u56de\u6536 \u5bf9\u4e8e\u65b0\u57df(MinorGC)\uff0c\u91c7\u7528coping\u7b97\u6cd5(copy collect)\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u514b\u670d\u53e5\u67c4\u7684\u5f00\u9500\u548c\u89e3\u51b3\u5806\u788e\u7247\u7684\u5783\u573e\u56de\u6536 \u5f00\u59cb\u65f6\u628a\u5806\u5212\u5206\u4e3a\u4e00\u5757\u8f83\u5927\u7684Eden\u548c\u4e8c\u5757\u8f83\u5c0f\u7684Survior\u533a\u57df\uff08From Space\u548cTo Space\uff09\uff0c\u5728Hotspot\u4e2d\uff0c\u9ed8\u8ba4\u6bd4\u4f8b\u662f8:1:1 \u5bf9\u4e8e\u65b0\u751f\u6210\u7684\u5bf9\u8c61\uff0c\u90fd\u653e\u5728Eden\u4e2d\uff1b\u5f53Eden\u5145\u6ee1\u65f6\uff0cGC\u5f00\u59cb: \u9996\u5148\u505c\u6b62\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\uff0c\u5f00\u59cbGC\uff0c\u4ece\u6839\u96c6\u4e2d\u626b\u63cf\u6d3b\u52a8\u5bf9\u8c61\uff0c\u628a\u6240\u6709\u53ef\u627e\u5230\u7684\u5bf9\u8c61\u90fd\u590d\u5236\u5230A\u7a7a\u95f4\u4e2d\uff0c\u7136\u540eEden\u4f1a\u6e05\u7a7a\uff0c\u5b9e\u8df5\u8868\u660e98\uff05\u7684\u65b0\u751f\u4ee3\u7684\u5bf9\u8c61\u90fd\u662f\u671d\u751f\u5915\u6b7b \u4e00\u65e6\u5f53A\u7a7a\u95f4\u5145\u6ee1\uff0cGC\u5c31\u628a\u5728A\u7a7a\u95f4\u4e2d\u53ef\u627e\u5230\u7684\u5bf9\u8c61\u90fd\u590d\u5236\u5230B\u7a7a\u95f4\u4e2d(\u4f1a\u8986\u76d6\u539f\u6709\u7684\u5b58\u50a8\u5bf9\u8c61\uff0c\u6d3b\u52a8\u5bf9\u8c61\u6240\u5360\u7684\u5185\u5b58\u4e4b\u95f4\u6ca1\u6709\u7a7a\u95f2\u6d1e) \u5f53B\u7a7a\u95f4\u6ee1\u7684\u65f6\u95f4\uff0cGC\u5c31\u628a\u5728B\u7a7a\u95f4\u4e2d\u53ef\u627e\u5230\u7684\u5bf9\u8c61\u90fd\u590d\u5236\u5230A\u7a7a\u95f4\u4e2d\uff0cAB\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u4e92\u6362\u89d2\u8272 \u6d3b\u52a8\u5bf9\u8c61\u7ecf\u8fc7\u4e00\u5b9a\u6b21\u6570\uff08\u5c0f\u4e8e-XX:MaxTenuringThreshold(\u9ed8\u8ba4\u4e3a 31 \u6b21)\u6b21\uff09\u7684GC\u64cd\u4f5c\u540e\uff0c\u5c31\u4f1a\u88ab\u653e\u5230\u65e7\u57df\u4e2d \u5bf9\u4e8e\u65e7\u57df(MajorGC/FullGC)\uff0c\u91c7\u7528tracing\u7b97\u6cd5\u7684\u4e00\u79cd(mark sweep/mark compatc)\uff0c\u79f0\u4e3a\u6807\u8bb0-\u6e05\u9664-\u538b\u7f29\u6536\u96c6\u5668\uff0c\u6ce8\u610f\uff0c\u538b\u7f29\uff0c\u8fd9\u662f\u4e2a\u5f00\u9500\u633a\u5927\u7684\u64cd\u4f5c\uff0c\u7528\u6237\u7ebf\u7a0b\u90fd\u4f1a\u88abblock \u6848\u4f8b # \u5185\u5b58\u76d1\u63a7\u7684\u65b9\u6cd5: jmap -heap pid(\u67e5\u770bjava \u5806\uff08heap\uff09\u4f7f\u7528\u60c5\u51b5) /usr/java/jdk1.8.0_162/bin/jmap -heap 87303 jmap_87303.txt # \u5185\u5bb9\u5982\u4e0b\uff1a Attaching to process ID 87303, please wait... Debugger attached successfully. Server compiler detected. JVM version is 25.162-b12 using thread-local object allocation. Parallel GC with 23 thread(s) # GC\u65b9\u5f0f Heap Configuration: # \u5806\u5185\u5b58\u521d\u59cb\u5316\u914d\u7f6e MinHeapFreeRatio = 0 # -XX:MinHeapFreeRatio\u8bbe\u7f6eJVM\u5806\u6700\u5c0f\u7a7a\u95f2\u6bd4\u7387(default 40) MaxHeapFreeRatio = 100 # -XX:MaxHeapFreeRatio\u8bbe\u7f6eJVM\u5806\u6700\u5927\u7a7a\u95f2\u6bd4\u7387(default 70) MaxHeapSize = 536870912 (512.0MB) # -XX:MaxHeapSize=\u8bbe\u7f6eJVM\u5806\u7684\u6700\u5927 NewSize = 178782208 (170.5MB) # -XX:NewSize=\u8bbe\u7f6eJVM\u5806\u7684\u2018\u65b0\u751f\u4ee3\u2019\u7684\u9ed8\u8ba4\u5927\u5c0f MaxNewSize = 178782208 (170.5MB) # -XX:MaxNewSize=\u8bbe\u7f6eJVM\u5806\u7684\u2018\u65b0\u751f\u4ee3\u2019\u7684\u6700\u5927 OldSize = 358088704 (341.5MB) # -XX:OldSize= value :\u8bbe\u7f6eJVM\u5806\u7684\u2018\u8001\u751f\u4ee3\u2019\u7684\u5927\u5c0f NewRatio = 2 # -XX:NewRatio=:\u2018\u65b0\u751f\u4ee3\u2019\u548c\u2018\u8001\u751f\u4ee3\u2019\u7684\u5927\u5c0f\u6bd4 SurvivorRatio = 8 # -XX:SurvivorRatio=\u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u4e2dEden\u533a\u4e0eSurvivor\u533a\u7684\u5927\u5c0f\u6bd4 MetaspaceSize = 21807104 (20.796875MB) # -XX:PermSize= value :\u8bbe\u7f6eJVM\u5806\u7684\u2018\u6c38\u751f\u4ee3\u2019\u7684\u521d\u59cb\u5927\u5c0f\uff08\u73b0\u5728\u662fjdk8\uff09 CompressedClassSpaceSize = 1073741824 (1024.0MB) MaxMetaspaceSize = 17592186044415 MB # -XX:MaxPermSize= value :\u8bbe\u7f6eJVM\u5806\u7684\u2018\u6c38\u751f\u4ee3\u2019\u7684\u6700\u5927\uff08\u73b0\u5728\u662fjdk8\uff09 G1HeapRegionSize = 0 (0.0MB) Heap Usage: # \u5806\u5185\u5b58\u5206\u5e03 PS Young Generation Eden Space: # Eden\u533a\u5185\u5b58\u5206\u5e03 capacity = 174587904 (166.5MB) # Eden\u533a\u603b\u5bb9\u91cf used = 4099296 (3.909393310546875MB) # Eden\u533a\u5df2\u4f7f\u7528 free = 170488608 (162.59060668945312MB) #Eden\u533a\u5269\u4f59\u5bb9\u91cf 2.3479839702984235% used # Eden\u533a\u4f7f\u7528\u6bd4\u7387 From Space: # Survivor\u533a\uff08A\u533a\uff09\u7684\u5185\u5b58\u5206\u5e03 capacity = 2097152 (2.0MB) used = 0 (0.0MB) free = 2097152 (2.0MB) 0.0% used To Space: # \u53e6\u4e00\u4e2aSurvivor\u533a\uff08B\u533a\uff09\u7684\u5185\u5b58\u5206\u5e03 capacity = 2097152 (2.0MB) used = 0 (0.0MB) free = 2097152 (2.0MB) 0.0% used PS Old Generation # Old\u533a\u5185\u5b58\u5206\u5e03 capacity = 358088704 (341.5MB) used = 78736888 (75.08934783935547MB) free = 279351816 (266.41065216064453MB) 21.988095999811264% used 38991 interned Strings occupying 3906872 bytes. # \u8fd9\u53f0\u673a\u5668\u7b80\u5355\u8bf4YG\u5185\u5b581G\uff0cOG\u5185\u5b582G\uff0c\u603b\u5185\u5b584G # \u5728\u8fd9\u6837\u7684\u914d\u7f6e\u4e0b\uff0cGC\u8fd0\u884c\u60c5\u51b5\uff1a /usr/java/jdk1.8.0_162/bin/jstat -gcutil -h5 87303 4s 100 S0 S1 E O M CCS YGC YGCT FGC FGCT GCT 0.00 0.00 5.51 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 6.00 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 6.33 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 6.94 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 15.80 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 S0 S1 E O M CCS YGC YGCT FGC FGCT GCT 0.00 0.00 16.37 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 # \u53d1\u751f\u4e86\u4e00\u6b21YG GC\uff0c\u4e5f\u5c31\u662fMinorGC\uff0c\u8017\u65f60.3s\uff084665.847 - 4665.547\uff09 0.00 0.00 0.56 22.02 98.42 96.83 32999 157.921 32956 4507.926 4665.847 0.00 0.00 1.33 22.02 98.42 96.83 32999 157.921 32956 4507.926 4665.847 0.00 0.00 1.75 22.02 98.42 96.83 32999 157.921 32956 4507.926 4665.847 \u5c0f\u7ed3 JVM\u5806\u7684\u5927\u5c0f\u51b3\u5b9a\u4e86GC\u7684\u8fd0\u884c\u65f6\u95f4\u3002\u5982\u679cJVM\u5806\u7684\u5927\u5c0f\u8d85\u8fc7\u4e00\u5b9a\u7684\u9650\u5ea6\uff0c\u90a3\u4e48GC\u7684\u8fd0\u884c\u65f6\u95f4\u4f1a\u5f88\u957f\u3002 \u5bf9\u8c61\u751f\u5b58\u7684\u65f6\u95f4\u8d8a\u957f\uff0cGC\u9700\u8981\u7684\u56de\u6536\u65f6\u95f4\u4e5f\u8d8a\u957f\uff0c\u5f71\u54cd\u56de\u6536\u901f\u5ea6\u3002 \u5927\u591a\u6570\u5bf9\u8c61\u90fd\u662f\u77ed\u547d\u7684\uff0c\u6240\u4ee5\uff0c\u5c3d\u53ef\u80fd\u8ba9\u8fd9\u4e9b\u5bf9\u8c61\u7684\u751f\u5b58\u671f\u5728GC\u7684\u4e00\u6b21\u8fd0\u884c\u5468\u671f\u5185 \u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u5efa\u7acb\u4e0e\u91ca\u653e\u5bf9\u8c61\u7684\u901f\u5ea6\u51b3\u5b9a\u4e86\u5783\u573e\u6536\u96c6\u7684\u9891\u7387\u3002 \u5982\u679cGC\u4e00\u6b21\u8fd0\u884c\u5468\u671f\u8d85\u8fc73-5\u79d2\uff0c\u8fd9\u4f1a\u5f88\u5f71\u54cd\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\uff0c\u5982\u679c\u53ef\u4ee5\uff0c\u5e94\u8be5\u51cf\u5c11JVM\u5806\u7684\u5927\u5c0f\u3002 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0cJVM\u5806\u7684\u5927\u5c0f\u5e94\u4e3a\u7269\u7406\u5185\u5b58\u768480%\uff08\u7ecf\u9a8c\u503c\uff09 Java\u542f\u52a8\u53c2\u6570 \u53c2\u6570\u5b9a\u4e49 Xss\uff1a\u6bcf\u4e2a\u7ebf\u7a0b\u7684stack\u5927\u5c0f\uff08\u6808\uff09\uff0c\u9ed8\u8ba4\u6bcf\u6761\u7ebf\u7a0b\u4e3a1M\uff0c\u5b58\u653e\u65b9\u6cd5\u8c03\u7528\u51fa\u53c2\u5165\u53c2\u7684\u6808\u3001\u5c40\u90e8\u53d8\u91cf\u3001\u6807\u91cf\u66ff\u6362\u540e\u7684\u5c40\u90e8\u53d8\u91cf\u7b49 \u8bbe\u5c0f\u70b9\u8282\u7ea6\u5185\u5b58\u5f00\u66f4\u591a\u7ebf\u7a0b\uff0cOS\u5bf9\u4e00\u4e2a\u8fdb\u7a0b\u5185\u7684\u7ebf\u7a0b\u6570\u6709\u9650\u5236\uff0c\u4e0d\u80fd\u65e0\u9650\u751f\u6210\uff0c\u7ecf\u9a8c\u503c\u57283000~5000 \u6709JSON\u89e3\u6790\u4e4b\u7c7b\u7684\u9012\u5f52\u8c03\u7528\u65f6\u4e0d\u80fd\u8bbe\u592a\u5c0f Xms\uff1aJAVA HEAP\u7684\u521d\u59cb\u503c\uff0c\u9ed8\u8ba4\u4e3a\u7269\u7406\u5185\u5b58\u76841/64\uff0cserver\u7aef\u6700\u597dXms\u4e0eXmx\u4e00\u6837 Xmx\uff1aJAVA HEAP\u7684\u6700\u5927\u503c\u3001\u9ed8\u8ba4\u4e3a\u7269\u7406\u5185\u5b58\u76841/4\uff08\u53ea\u6709\u8fd0\u884c\u5728 server \u6a21\u5f0f\u4e0b\u7684\u65f6\u5019\u624d\u662f min(1G, \u7269\u7406\u5185\u5b58\u7684\u56db\u5206\u4e4b\u4e00)\uff09 -Xms2g -Xmx2g \u6bd4\u8f83\u5408\u9002\u7684\u6570\u503c\u662f2-4g\uff0c\u518d\u5927\u5c31\u5f97\u8003\u8651GC\u65f6\u95f4 Xmn\uff1aJAVA HEAP young\u533a\u7684\u5927\u5c0f\uff0c\u9ed8\u8ba4\u65b0\u751f\u4ee3\u5360\u5806\u5185\u5b58\u5927\u5c0f\u76841/3\uff08-XX:NewRatio=2\uff09 -Xmn1g \u6216 -XX:NewRatio=1 -XX:NewRatio=4 \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\uff08\u5305\u62ecEden\u548c\u4e24\u4e2aSurvivor\u533a\uff09\u4e0e\u5e74\u8001\u4ee3\u7684\u6bd4\u503c\uff08\u9664\u53bb\u6301\u4e45\u4ee3\uff09\u3002\u8bbe\u7f6e\u4e3a4\uff0c\u5219\u5e74\u8f7b\u4ee3\u4e0e\u5e74\u8001\u4ee3\u6240\u5360\u6bd4\u503c\u4e3a1:4\uff0c\u5e74\u8f7b\u4ee3\u5360\u6574\u4e2a\u5806\u6808\u76841/5 -XX:SurvivorRatio=4 \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u4e2dEden\u533a\u4e0eSurvivor\u533a\u7684\u5927\u5c0f\u6bd4\u503c\u3002\u8bbe\u7f6e\u4e3a4\uff0c\u5219\u4e24\u4e2aSurvivor\u533a\u4e0e\u4e00\u4e2aEden\u533a\u7684\u6bd4\u503c\u4e3a2:4\uff0c\u4e00\u4e2aSurvivor\u533a\u5360\u6574\u4e2a\u5e74\u8f7b\u4ee3\u76841/6 -XX:MaxTenuringThreshold=0 \u8bbe\u7f6e\u5783\u573e\u6700\u5927\u5e74\u9f84\u3002\u5982\u679c\u8bbe\u7f6e\u4e3a0\u7684\u8bdd\uff0c\u5219\u5e74\u8f7b\u4ee3\u5bf9\u8c61\u4e0d\u7ecf\u8fc7Survivor\u533a\uff0c\u76f4\u63a5\u8fdb\u5165\u5e74\u8001\u4ee3\uff0c\u5bf9\u4e8e\u5e74\u8001\u4ee3\u6bd4\u8f83\u591a\u7684\u5e94\u7528\uff0c\u53ef\u4ee5\u63d0\u9ad8\u6548\u7387 \u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u8f83\u5927\u503c\uff0c\u5219\u5e74\u8f7b\u4ee3\u5bf9\u8c61\u4f1a\u5728Survivor\u533a\u8fdb\u884c\u591a\u6b21\u590d\u5236\uff0c\u53ef\u4ee5\u589e\u52a0\u5bf9\u8c61\u518d\u5e74\u8f7b\u4ee3\u7684\u5b58\u6d3b\u65f6\u95f4 XX:PermSize\uff1a\u8bbe\u5b9a\u5185\u5b58\u7684\u6c38\u4e45\u4fdd\u5b58\u533a\u57df XX:MaxPermSize\uff1a\u8bbe\u5b9a\u6700\u5927\u5185\u5b58\u7684\u6c38\u4e45\u4fdd\u5b58\u533a\u57df\uff0c\u51e0\u4e4e\u53ef\u7528\u5b8c\u673a\u5668\u7684\u6240\u6709\u5185\u5b58 -server \u4e0b\u9ed8\u8ba4MaxPermSize\u4e3a64m MaxPermSize\u8bbe\u7f6e\u8fc7\u5c0f\u4f1a\u5bfc\u81f4 java.lang.OutOfMemoryError: PermGen space \u5728JDK1.8\u4e2d\uff0c\u53d6\u6d88\u4e86PermGen\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662fMetaspace \u4e3e\u4f8b\uff1a -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=512m \u56de\u6536\u7b97\u6cd5 \u2013XX:+UseSerialGC \u5f3a\u5236 java -client \u9ed8\u8ba4\u4f1a\u4f7f\u7528, \u901f\u5ea6\u6162\u3002\u670d\u52a1\u5668\u5e94\u7528\u4e0d\u63a8\u8350\u3002 \u2013XX:+UseParallelGC linux x64\u4e0a\u9ed8\u8ba4\uff0c\u5176\u4ed6\u5e73\u53f0\u8981\u52a0 -server \u624d\u4f1a\u9009\u7528 young = parallel\uff0c\u591a\u4e2athread\u540c\u65f6copy; old = mark-sweep-compact = 1 \u4f18\u70b9\uff1a\u65b0\u751f\u4ee3\u56de\u6536\u66f4\u5feb\u3002\u56e0\u4e3a\u7cfb\u7edf\u5927\u90e8\u5206\u65f6\u95f4\u505a\u7684gc\u90fd\u662f\u65b0\u751f\u4ee3\u7684 \u7f3a\u70b9\uff1a\u5f53\u8fd0\u884c\u57288G/16G server\u4e0aold generation live object\u592a\u591a\u65f6\u5019pause time\u8fc7\u957f \u2013XX:+UseParallelOldGC young = parallel = 2; old = parallel\uff0c\u5206\u6210\u591a\u4e2a\u72ec\u7acb\u7684\u5355\u5143\uff0c\u5982\u679c\u5355\u5143\u4e2dlive object\u5c11\u5219\u56de\u6536\uff0c\u591a\u5219\u8df3\u8fc7 \u4f18\u70b9\uff1aold generation\u4e0a\u6027\u80fd\u8f83 parallel \u65b9\u5f0f\u6709\u63d0\u9ad8 \u7f3a\u70b9\uff1a\u5927\u90e8\u5206server\u7cfb\u7edfold generation\u5185\u5b58\u5360\u7528\u4f1a\u8fbe\u523060%-80%, \u6ca1\u6709\u90a3\u4e48\u591a\u7406\u60f3\u7684\u5355\u5143live object\u5f88\u5c11\u65b9\u4fbf\u8fc5\u901f\u56de\u6536\uff0c\u540c\u65f6compact\u65b9\u9762\u5f00\u9500\u6bd4\u8d77parallel\u5e76\u6ca1\u660e\u663e\u51cf\u5c11 \u2013XX:+UseConcMarkSweepGC Concurent Mark-Sweep(CMS) Collector young generation = parallel collector = 2; old = cms\uff0c\u540c\u65f6\u4e0d\u505a compact \u64cd\u4f5c \u4f18\u70b9\uff1apause time\u4f1a\u964d\u4f4e, pause\u654f\u611f \u7f3a\u70b9\uff1acpu\u5360\u7528\u8fc7\u591a\uff0ccpu\u5bc6\u96c6\u578b\u670d\u52a1\u5668\u4e0d\u9002\u5408\u3002\u53e6\u5916\u788e\u7247\u592a\u591a\uff0c\u6bcf\u4e2aobject\u7684\u5b58\u50a8\u90fd\u8981\u901a\u8fc7\u94fe\u8868\u8fde\u7eed\u8df3n\u4e2a\u5730\u65b9\uff0c\u7a7a\u95f4\u6d6a\u8d39\u95ee\u9898\u4e5f\u4f1a\u589e\u5927 # \u67e5\u770bJVM\u9ed8\u8ba4\u53c2\u6570\u4e2d\u7684\u5806\u6700\u5927\u503c java -XX:+PrintFlagsFinal -version | grep HeapSize # \u7eafjar\u542f\u52a8\uff0c\u9002\u7528JDK7 java \\ -Xmx512M \\ -XX:MaxPermSize=128M \\ -jar ./biz-1.0.0-SNAPSHOT.jar # Tomcat\u542f\u52a8 java \\ -Djava.util.logging.config.file=/usr/local/tomcat/conf/logging.properties \\ -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager \\ -Djdk.tls.ephemeralDHKeySize=2048 \\ -Dignore.endorsed.dirs= \\ -classpath /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jar \\ -Dcatalina.base=/usr/local/tomcat \\ -Dcatalina.home=/usr/local/tomcat \\ -Djava.io.tmpdir=/usr/local/tomcat/temp org.apache.catalina.startup.Bootstrap start","title":"JVM\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536GC"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/jvm\u7cfb/jvm\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536gc/#jvmgc","text":"","title":"JVM\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536GC"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/jvm\u7cfb/jvm\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536gc/#jvm","text":"","title":"JVM\u5185\u5b58\u57fa\u7840"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/jvm\u7cfb/jvm\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536gc/#jvm_1","text":"Java\u5bf9\u8c61\u7684\u6d3b\u52a8\u7a7a\u95f4\uff0c\u7a0b\u5e8f\u4e2d\u7684\u7c7b\u7684\u5bf9\u8c61\u4ece\u4e2d\u5206\u914d\u7a7a\u95f4\uff0c\u5176\u5b58\u50a8\u7740\u6b63\u5728\u8fd0\u884c\u7740\u7684\u5e94\u7528\u7a0b\u5e8f\u7528\u5230\u7684\u6240\u6709\u5bf9\u8c61\u3002 \u5bf9\u8c61\u7684\u5efa\u7acb\u65b9\u5f0f\u5c31\u662f\u90a3\u4e9bnew\u4e00\u7c7b\u7684\u64cd\u4f5c\uff0c\u5f53\u5bf9\u8c61\u65e0\u7528\u540e\uff0c\u662fGC\u6765\u8d1f\u8d23\u8fd9\u4e2a\u65e0\u7528\u7684\u5bf9\u8c61\u3002 \u5206\u7c7b\uff1a \u65b0\u57df\uff1a\u5b58\u50a8\u6240\u6709\u65b0\u6210\u751f\u7684\u5bf9\u8c61 Eden: From Space: \u7b80\u79f0A\u7a7a\u95f4 To Space: \u7b80\u79f0B\u7a7a\u95f4 \u65e7\u57df\uff1a\u65b0\u57df\u4e2d\u7684\u5bf9\u8c61\uff0c\u7ecf\u8fc7\u4e86\u4e00\u5b9a\u6b21\u6570\u7684GC\u5faa\u73af\u540e\uff0c\u88ab\u79fb\u5165\u65e7\u57df \u6c38\u4e45\u57df\uff1a\u5b58\u50a8\u7c7b\u548c\u65b9\u6cd5\u5bf9\u8c61\uff0c\u4ece\u914d\u7f6e\u7684\u89d2\u5ea6\u770b\uff0c\u8fd9\u4e2a\u57df\u662f\u72ec\u7acb\u7684\uff0c\u4e0d\u5305\u62ec\u5728JVM\u5806\u5185\u3002\u9ed8\u8ba4\u4e3a4M\u3002","title":"JVM\u5806"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/jvm\u7cfb/jvm\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536gc/#2gjvm","text":"\u5806\u5185\u5b58 \uff0b \u7ebf\u7a0b\u6570 \uff0a \u7ebf\u7a0b\u6808 \uff0b \u6c38\u4e45\u4ee3 \uff0b \u4e8c\u8fdb\u5236\u4ee3\u7801 \uff0b \u5806\u5916\u5185\u5b58 \u5806\u5185\u5b58\uff1a \u5b58\u50a8Java\u5bf9\u8c61\uff0c\u9ed8\u8ba4\u4e3a\u7269\u7406\u5185\u5b58\u76841/64 \u7ebf\u7a0b\u6808\uff1a \u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\uff08\u539f\u5b50\u7c7b\u578b\uff0c\u5f15\u7528\uff09\u53ca\u5176\u4ed6\uff0c\u9ed8\u8ba4\u4e3a1M \u6c38\u4e45\u4ee3\uff1a \u5b58\u50a8\u7c7b\u5b9a\u4e49\u53ca\u5e38\u91cf\u6c60\uff0c\u6ce8\u610fJDK7/8\u7684\u533a\u522b \u4e8c\u8fdb\u5236\u4ee3\u7801\uff1aJDK7\u4e0e8\uff0c\u6253\u5f00\u591a\u5c42\u7f16\u8bd1\u65f6\u7684\u9ed8\u8ba4\u503c\u4e0d\u4e00\u6837\uff0c\u4ece48\u5230240M \u5806\u5916\u5185\u5b58\uff1a \u88abNetty\uff0c\u5806\u5916\u7f13\u5b58\u7b49\u4f7f\u7528\uff0c\u9ed8\u8ba4\u6700\u5927\u503c\u7ea6\u4e3a\u5806\u5185\u5b58\u5927\u5c0f \u5806\u5185\u5b58\u8bbe\u7f6e\u4e3a2G\uff0c\u90a3\u4e00\u4e2a\u67091000\u4e2a\u7ebf\u7a0b\u7684JVM\u53ef\u80fd\u9700\u8981: 2G + 1000 * 1M + 256M + 48/240M + (\uff5e2G) = 5.5G (3.5G)","title":"\u4e00\u4e2a2G\u5806\u5927\u5c0f\u7684JVM\uff0c\u53ef\u80fd\u603b\u5171\u5360\u7528\u591a\u5c11\u5185\u5b58\u7684\uff1f"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/jvm\u7cfb/jvm\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536gc/#gc","text":"\u76ee\u7684\uff1a\u5728\u5806\u4e2d\uff0c\u627e\u5230\u5df2\u7ecf\u65e0\u7528\u7684\u5bf9\u8c61\uff0c\u5e76\u628a\u8fd9\u4e9b\u5bf9\u8c61\u5360\u7528\u7684\u7a7a\u95f4\u6536\u56de\u4f7f\u5176\u53ef\u4ee5\u91cd\u65b0\u5229\u7528\u3002 \u7b97\u6cd5\u601d\u8def\uff1a \u628a\u6240\u6709\u5bf9\u8c61\u7ec4\u6210\u4e00\u4e2a\u6811\u72b6\u7ed3\u6784\u96c6\u5408 \u4ece\u6811\u6839\u5f00\u59cb\u627e\uff0c\u53ea\u8981\u53ef\u4ee5\u627e\u5230\u7684\u90fd\u662f\u6d3b\u52a8\u5bf9\u8c61\uff0c\u5982\u679c\u627e\u4e0d\u5230\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u5e94\u8be5\u88ab\u56de\u6536 \u5bf9\u4e8e\u65b0\u57df(MinorGC)\uff0c\u91c7\u7528coping\u7b97\u6cd5(copy collect)\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u514b\u670d\u53e5\u67c4\u7684\u5f00\u9500\u548c\u89e3\u51b3\u5806\u788e\u7247\u7684\u5783\u573e\u56de\u6536 \u5f00\u59cb\u65f6\u628a\u5806\u5212\u5206\u4e3a\u4e00\u5757\u8f83\u5927\u7684Eden\u548c\u4e8c\u5757\u8f83\u5c0f\u7684Survior\u533a\u57df\uff08From Space\u548cTo Space\uff09\uff0c\u5728Hotspot\u4e2d\uff0c\u9ed8\u8ba4\u6bd4\u4f8b\u662f8:1:1 \u5bf9\u4e8e\u65b0\u751f\u6210\u7684\u5bf9\u8c61\uff0c\u90fd\u653e\u5728Eden\u4e2d\uff1b\u5f53Eden\u5145\u6ee1\u65f6\uff0cGC\u5f00\u59cb: \u9996\u5148\u505c\u6b62\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\uff0c\u5f00\u59cbGC\uff0c\u4ece\u6839\u96c6\u4e2d\u626b\u63cf\u6d3b\u52a8\u5bf9\u8c61\uff0c\u628a\u6240\u6709\u53ef\u627e\u5230\u7684\u5bf9\u8c61\u90fd\u590d\u5236\u5230A\u7a7a\u95f4\u4e2d\uff0c\u7136\u540eEden\u4f1a\u6e05\u7a7a\uff0c\u5b9e\u8df5\u8868\u660e98\uff05\u7684\u65b0\u751f\u4ee3\u7684\u5bf9\u8c61\u90fd\u662f\u671d\u751f\u5915\u6b7b \u4e00\u65e6\u5f53A\u7a7a\u95f4\u5145\u6ee1\uff0cGC\u5c31\u628a\u5728A\u7a7a\u95f4\u4e2d\u53ef\u627e\u5230\u7684\u5bf9\u8c61\u90fd\u590d\u5236\u5230B\u7a7a\u95f4\u4e2d(\u4f1a\u8986\u76d6\u539f\u6709\u7684\u5b58\u50a8\u5bf9\u8c61\uff0c\u6d3b\u52a8\u5bf9\u8c61\u6240\u5360\u7684\u5185\u5b58\u4e4b\u95f4\u6ca1\u6709\u7a7a\u95f2\u6d1e) \u5f53B\u7a7a\u95f4\u6ee1\u7684\u65f6\u95f4\uff0cGC\u5c31\u628a\u5728B\u7a7a\u95f4\u4e2d\u53ef\u627e\u5230\u7684\u5bf9\u8c61\u90fd\u590d\u5236\u5230A\u7a7a\u95f4\u4e2d\uff0cAB\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u4e92\u6362\u89d2\u8272 \u6d3b\u52a8\u5bf9\u8c61\u7ecf\u8fc7\u4e00\u5b9a\u6b21\u6570\uff08\u5c0f\u4e8e-XX:MaxTenuringThreshold(\u9ed8\u8ba4\u4e3a 31 \u6b21)\u6b21\uff09\u7684GC\u64cd\u4f5c\u540e\uff0c\u5c31\u4f1a\u88ab\u653e\u5230\u65e7\u57df\u4e2d \u5bf9\u4e8e\u65e7\u57df(MajorGC/FullGC)\uff0c\u91c7\u7528tracing\u7b97\u6cd5\u7684\u4e00\u79cd(mark sweep/mark compatc)\uff0c\u79f0\u4e3a\u6807\u8bb0-\u6e05\u9664-\u538b\u7f29\u6536\u96c6\u5668\uff0c\u6ce8\u610f\uff0c\u538b\u7f29\uff0c\u8fd9\u662f\u4e2a\u5f00\u9500\u633a\u5927\u7684\u64cd\u4f5c\uff0c\u7528\u6237\u7ebf\u7a0b\u90fd\u4f1a\u88abblock","title":"\u5783\u573e\u56de\u6536GC"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/jvm\u7cfb/jvm\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536gc/#_1","text":"# \u5185\u5b58\u76d1\u63a7\u7684\u65b9\u6cd5: jmap -heap pid(\u67e5\u770bjava \u5806\uff08heap\uff09\u4f7f\u7528\u60c5\u51b5) /usr/java/jdk1.8.0_162/bin/jmap -heap 87303 jmap_87303.txt # \u5185\u5bb9\u5982\u4e0b\uff1a Attaching to process ID 87303, please wait... Debugger attached successfully. Server compiler detected. JVM version is 25.162-b12 using thread-local object allocation. Parallel GC with 23 thread(s) # GC\u65b9\u5f0f Heap Configuration: # \u5806\u5185\u5b58\u521d\u59cb\u5316\u914d\u7f6e MinHeapFreeRatio = 0 # -XX:MinHeapFreeRatio\u8bbe\u7f6eJVM\u5806\u6700\u5c0f\u7a7a\u95f2\u6bd4\u7387(default 40) MaxHeapFreeRatio = 100 # -XX:MaxHeapFreeRatio\u8bbe\u7f6eJVM\u5806\u6700\u5927\u7a7a\u95f2\u6bd4\u7387(default 70) MaxHeapSize = 536870912 (512.0MB) # -XX:MaxHeapSize=\u8bbe\u7f6eJVM\u5806\u7684\u6700\u5927 NewSize = 178782208 (170.5MB) # -XX:NewSize=\u8bbe\u7f6eJVM\u5806\u7684\u2018\u65b0\u751f\u4ee3\u2019\u7684\u9ed8\u8ba4\u5927\u5c0f MaxNewSize = 178782208 (170.5MB) # -XX:MaxNewSize=\u8bbe\u7f6eJVM\u5806\u7684\u2018\u65b0\u751f\u4ee3\u2019\u7684\u6700\u5927 OldSize = 358088704 (341.5MB) # -XX:OldSize= value :\u8bbe\u7f6eJVM\u5806\u7684\u2018\u8001\u751f\u4ee3\u2019\u7684\u5927\u5c0f NewRatio = 2 # -XX:NewRatio=:\u2018\u65b0\u751f\u4ee3\u2019\u548c\u2018\u8001\u751f\u4ee3\u2019\u7684\u5927\u5c0f\u6bd4 SurvivorRatio = 8 # -XX:SurvivorRatio=\u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u4e2dEden\u533a\u4e0eSurvivor\u533a\u7684\u5927\u5c0f\u6bd4 MetaspaceSize = 21807104 (20.796875MB) # -XX:PermSize= value :\u8bbe\u7f6eJVM\u5806\u7684\u2018\u6c38\u751f\u4ee3\u2019\u7684\u521d\u59cb\u5927\u5c0f\uff08\u73b0\u5728\u662fjdk8\uff09 CompressedClassSpaceSize = 1073741824 (1024.0MB) MaxMetaspaceSize = 17592186044415 MB # -XX:MaxPermSize= value :\u8bbe\u7f6eJVM\u5806\u7684\u2018\u6c38\u751f\u4ee3\u2019\u7684\u6700\u5927\uff08\u73b0\u5728\u662fjdk8\uff09 G1HeapRegionSize = 0 (0.0MB) Heap Usage: # \u5806\u5185\u5b58\u5206\u5e03 PS Young Generation Eden Space: # Eden\u533a\u5185\u5b58\u5206\u5e03 capacity = 174587904 (166.5MB) # Eden\u533a\u603b\u5bb9\u91cf used = 4099296 (3.909393310546875MB) # Eden\u533a\u5df2\u4f7f\u7528 free = 170488608 (162.59060668945312MB) #Eden\u533a\u5269\u4f59\u5bb9\u91cf 2.3479839702984235% used # Eden\u533a\u4f7f\u7528\u6bd4\u7387 From Space: # Survivor\u533a\uff08A\u533a\uff09\u7684\u5185\u5b58\u5206\u5e03 capacity = 2097152 (2.0MB) used = 0 (0.0MB) free = 2097152 (2.0MB) 0.0% used To Space: # \u53e6\u4e00\u4e2aSurvivor\u533a\uff08B\u533a\uff09\u7684\u5185\u5b58\u5206\u5e03 capacity = 2097152 (2.0MB) used = 0 (0.0MB) free = 2097152 (2.0MB) 0.0% used PS Old Generation # Old\u533a\u5185\u5b58\u5206\u5e03 capacity = 358088704 (341.5MB) used = 78736888 (75.08934783935547MB) free = 279351816 (266.41065216064453MB) 21.988095999811264% used 38991 interned Strings occupying 3906872 bytes. # \u8fd9\u53f0\u673a\u5668\u7b80\u5355\u8bf4YG\u5185\u5b581G\uff0cOG\u5185\u5b582G\uff0c\u603b\u5185\u5b584G # \u5728\u8fd9\u6837\u7684\u914d\u7f6e\u4e0b\uff0cGC\u8fd0\u884c\u60c5\u51b5\uff1a /usr/java/jdk1.8.0_162/bin/jstat -gcutil -h5 87303 4s 100 S0 S1 E O M CCS YGC YGCT FGC FGCT GCT 0.00 0.00 5.51 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 6.00 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 6.33 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 6.94 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 0.00 0.00 15.80 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 S0 S1 E O M CCS YGC YGCT FGC FGCT GCT 0.00 0.00 16.37 22.00 98.42 96.83 32997 157.912 32954 4507.634 4665.547 # \u53d1\u751f\u4e86\u4e00\u6b21YG GC\uff0c\u4e5f\u5c31\u662fMinorGC\uff0c\u8017\u65f60.3s\uff084665.847 - 4665.547\uff09 0.00 0.00 0.56 22.02 98.42 96.83 32999 157.921 32956 4507.926 4665.847 0.00 0.00 1.33 22.02 98.42 96.83 32999 157.921 32956 4507.926 4665.847 0.00 0.00 1.75 22.02 98.42 96.83 32999 157.921 32956 4507.926 4665.847","title":"\u6848\u4f8b"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/jvm\u7cfb/jvm\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536gc/#_2","text":"JVM\u5806\u7684\u5927\u5c0f\u51b3\u5b9a\u4e86GC\u7684\u8fd0\u884c\u65f6\u95f4\u3002\u5982\u679cJVM\u5806\u7684\u5927\u5c0f\u8d85\u8fc7\u4e00\u5b9a\u7684\u9650\u5ea6\uff0c\u90a3\u4e48GC\u7684\u8fd0\u884c\u65f6\u95f4\u4f1a\u5f88\u957f\u3002 \u5bf9\u8c61\u751f\u5b58\u7684\u65f6\u95f4\u8d8a\u957f\uff0cGC\u9700\u8981\u7684\u56de\u6536\u65f6\u95f4\u4e5f\u8d8a\u957f\uff0c\u5f71\u54cd\u56de\u6536\u901f\u5ea6\u3002 \u5927\u591a\u6570\u5bf9\u8c61\u90fd\u662f\u77ed\u547d\u7684\uff0c\u6240\u4ee5\uff0c\u5c3d\u53ef\u80fd\u8ba9\u8fd9\u4e9b\u5bf9\u8c61\u7684\u751f\u5b58\u671f\u5728GC\u7684\u4e00\u6b21\u8fd0\u884c\u5468\u671f\u5185 \u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u5efa\u7acb\u4e0e\u91ca\u653e\u5bf9\u8c61\u7684\u901f\u5ea6\u51b3\u5b9a\u4e86\u5783\u573e\u6536\u96c6\u7684\u9891\u7387\u3002 \u5982\u679cGC\u4e00\u6b21\u8fd0\u884c\u5468\u671f\u8d85\u8fc73-5\u79d2\uff0c\u8fd9\u4f1a\u5f88\u5f71\u54cd\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\uff0c\u5982\u679c\u53ef\u4ee5\uff0c\u5e94\u8be5\u51cf\u5c11JVM\u5806\u7684\u5927\u5c0f\u3002 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0cJVM\u5806\u7684\u5927\u5c0f\u5e94\u4e3a\u7269\u7406\u5185\u5b58\u768480%\uff08\u7ecf\u9a8c\u503c\uff09","title":"\u5c0f\u7ed3"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/jvm\u7cfb/jvm\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536gc/#java","text":"","title":"Java\u542f\u52a8\u53c2\u6570"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/jvm\u7cfb/jvm\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536gc/#_3","text":"Xss\uff1a\u6bcf\u4e2a\u7ebf\u7a0b\u7684stack\u5927\u5c0f\uff08\u6808\uff09\uff0c\u9ed8\u8ba4\u6bcf\u6761\u7ebf\u7a0b\u4e3a1M\uff0c\u5b58\u653e\u65b9\u6cd5\u8c03\u7528\u51fa\u53c2\u5165\u53c2\u7684\u6808\u3001\u5c40\u90e8\u53d8\u91cf\u3001\u6807\u91cf\u66ff\u6362\u540e\u7684\u5c40\u90e8\u53d8\u91cf\u7b49 \u8bbe\u5c0f\u70b9\u8282\u7ea6\u5185\u5b58\u5f00\u66f4\u591a\u7ebf\u7a0b\uff0cOS\u5bf9\u4e00\u4e2a\u8fdb\u7a0b\u5185\u7684\u7ebf\u7a0b\u6570\u6709\u9650\u5236\uff0c\u4e0d\u80fd\u65e0\u9650\u751f\u6210\uff0c\u7ecf\u9a8c\u503c\u57283000~5000 \u6709JSON\u89e3\u6790\u4e4b\u7c7b\u7684\u9012\u5f52\u8c03\u7528\u65f6\u4e0d\u80fd\u8bbe\u592a\u5c0f Xms\uff1aJAVA HEAP\u7684\u521d\u59cb\u503c\uff0c\u9ed8\u8ba4\u4e3a\u7269\u7406\u5185\u5b58\u76841/64\uff0cserver\u7aef\u6700\u597dXms\u4e0eXmx\u4e00\u6837 Xmx\uff1aJAVA HEAP\u7684\u6700\u5927\u503c\u3001\u9ed8\u8ba4\u4e3a\u7269\u7406\u5185\u5b58\u76841/4\uff08\u53ea\u6709\u8fd0\u884c\u5728 server \u6a21\u5f0f\u4e0b\u7684\u65f6\u5019\u624d\u662f min(1G, \u7269\u7406\u5185\u5b58\u7684\u56db\u5206\u4e4b\u4e00)\uff09 -Xms2g -Xmx2g \u6bd4\u8f83\u5408\u9002\u7684\u6570\u503c\u662f2-4g\uff0c\u518d\u5927\u5c31\u5f97\u8003\u8651GC\u65f6\u95f4 Xmn\uff1aJAVA HEAP young\u533a\u7684\u5927\u5c0f\uff0c\u9ed8\u8ba4\u65b0\u751f\u4ee3\u5360\u5806\u5185\u5b58\u5927\u5c0f\u76841/3\uff08-XX:NewRatio=2\uff09 -Xmn1g \u6216 -XX:NewRatio=1 -XX:NewRatio=4 \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\uff08\u5305\u62ecEden\u548c\u4e24\u4e2aSurvivor\u533a\uff09\u4e0e\u5e74\u8001\u4ee3\u7684\u6bd4\u503c\uff08\u9664\u53bb\u6301\u4e45\u4ee3\uff09\u3002\u8bbe\u7f6e\u4e3a4\uff0c\u5219\u5e74\u8f7b\u4ee3\u4e0e\u5e74\u8001\u4ee3\u6240\u5360\u6bd4\u503c\u4e3a1:4\uff0c\u5e74\u8f7b\u4ee3\u5360\u6574\u4e2a\u5806\u6808\u76841/5 -XX:SurvivorRatio=4 \u8bbe\u7f6e\u5e74\u8f7b\u4ee3\u4e2dEden\u533a\u4e0eSurvivor\u533a\u7684\u5927\u5c0f\u6bd4\u503c\u3002\u8bbe\u7f6e\u4e3a4\uff0c\u5219\u4e24\u4e2aSurvivor\u533a\u4e0e\u4e00\u4e2aEden\u533a\u7684\u6bd4\u503c\u4e3a2:4\uff0c\u4e00\u4e2aSurvivor\u533a\u5360\u6574\u4e2a\u5e74\u8f7b\u4ee3\u76841/6 -XX:MaxTenuringThreshold=0 \u8bbe\u7f6e\u5783\u573e\u6700\u5927\u5e74\u9f84\u3002\u5982\u679c\u8bbe\u7f6e\u4e3a0\u7684\u8bdd\uff0c\u5219\u5e74\u8f7b\u4ee3\u5bf9\u8c61\u4e0d\u7ecf\u8fc7Survivor\u533a\uff0c\u76f4\u63a5\u8fdb\u5165\u5e74\u8001\u4ee3\uff0c\u5bf9\u4e8e\u5e74\u8001\u4ee3\u6bd4\u8f83\u591a\u7684\u5e94\u7528\uff0c\u53ef\u4ee5\u63d0\u9ad8\u6548\u7387 \u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u8f83\u5927\u503c\uff0c\u5219\u5e74\u8f7b\u4ee3\u5bf9\u8c61\u4f1a\u5728Survivor\u533a\u8fdb\u884c\u591a\u6b21\u590d\u5236\uff0c\u53ef\u4ee5\u589e\u52a0\u5bf9\u8c61\u518d\u5e74\u8f7b\u4ee3\u7684\u5b58\u6d3b\u65f6\u95f4 XX:PermSize\uff1a\u8bbe\u5b9a\u5185\u5b58\u7684\u6c38\u4e45\u4fdd\u5b58\u533a\u57df XX:MaxPermSize\uff1a\u8bbe\u5b9a\u6700\u5927\u5185\u5b58\u7684\u6c38\u4e45\u4fdd\u5b58\u533a\u57df\uff0c\u51e0\u4e4e\u53ef\u7528\u5b8c\u673a\u5668\u7684\u6240\u6709\u5185\u5b58 -server \u4e0b\u9ed8\u8ba4MaxPermSize\u4e3a64m MaxPermSize\u8bbe\u7f6e\u8fc7\u5c0f\u4f1a\u5bfc\u81f4 java.lang.OutOfMemoryError: PermGen space \u5728JDK1.8\u4e2d\uff0c\u53d6\u6d88\u4e86PermGen\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662fMetaspace \u4e3e\u4f8b\uff1a -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=512m","title":"\u53c2\u6570\u5b9a\u4e49"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/jvm\u7cfb/jvm\u5185\u5b58\u673a\u5236\u548c\u5783\u573e\u56de\u6536gc/#_4","text":"\u2013XX:+UseSerialGC \u5f3a\u5236 java -client \u9ed8\u8ba4\u4f1a\u4f7f\u7528, \u901f\u5ea6\u6162\u3002\u670d\u52a1\u5668\u5e94\u7528\u4e0d\u63a8\u8350\u3002 \u2013XX:+UseParallelGC linux x64\u4e0a\u9ed8\u8ba4\uff0c\u5176\u4ed6\u5e73\u53f0\u8981\u52a0 -server \u624d\u4f1a\u9009\u7528 young = parallel\uff0c\u591a\u4e2athread\u540c\u65f6copy; old = mark-sweep-compact = 1 \u4f18\u70b9\uff1a\u65b0\u751f\u4ee3\u56de\u6536\u66f4\u5feb\u3002\u56e0\u4e3a\u7cfb\u7edf\u5927\u90e8\u5206\u65f6\u95f4\u505a\u7684gc\u90fd\u662f\u65b0\u751f\u4ee3\u7684 \u7f3a\u70b9\uff1a\u5f53\u8fd0\u884c\u57288G/16G server\u4e0aold generation live object\u592a\u591a\u65f6\u5019pause time\u8fc7\u957f \u2013XX:+UseParallelOldGC young = parallel = 2; old = parallel\uff0c\u5206\u6210\u591a\u4e2a\u72ec\u7acb\u7684\u5355\u5143\uff0c\u5982\u679c\u5355\u5143\u4e2dlive object\u5c11\u5219\u56de\u6536\uff0c\u591a\u5219\u8df3\u8fc7 \u4f18\u70b9\uff1aold generation\u4e0a\u6027\u80fd\u8f83 parallel \u65b9\u5f0f\u6709\u63d0\u9ad8 \u7f3a\u70b9\uff1a\u5927\u90e8\u5206server\u7cfb\u7edfold generation\u5185\u5b58\u5360\u7528\u4f1a\u8fbe\u523060%-80%, \u6ca1\u6709\u90a3\u4e48\u591a\u7406\u60f3\u7684\u5355\u5143live object\u5f88\u5c11\u65b9\u4fbf\u8fc5\u901f\u56de\u6536\uff0c\u540c\u65f6compact\u65b9\u9762\u5f00\u9500\u6bd4\u8d77parallel\u5e76\u6ca1\u660e\u663e\u51cf\u5c11 \u2013XX:+UseConcMarkSweepGC Concurent Mark-Sweep(CMS) Collector young generation = parallel collector = 2; old = cms\uff0c\u540c\u65f6\u4e0d\u505a compact \u64cd\u4f5c \u4f18\u70b9\uff1apause time\u4f1a\u964d\u4f4e, pause\u654f\u611f \u7f3a\u70b9\uff1acpu\u5360\u7528\u8fc7\u591a\uff0ccpu\u5bc6\u96c6\u578b\u670d\u52a1\u5668\u4e0d\u9002\u5408\u3002\u53e6\u5916\u788e\u7247\u592a\u591a\uff0c\u6bcf\u4e2aobject\u7684\u5b58\u50a8\u90fd\u8981\u901a\u8fc7\u94fe\u8868\u8fde\u7eed\u8df3n\u4e2a\u5730\u65b9\uff0c\u7a7a\u95f4\u6d6a\u8d39\u95ee\u9898\u4e5f\u4f1a\u589e\u5927 # \u67e5\u770bJVM\u9ed8\u8ba4\u53c2\u6570\u4e2d\u7684\u5806\u6700\u5927\u503c java -XX:+PrintFlagsFinal -version | grep HeapSize # \u7eafjar\u542f\u52a8\uff0c\u9002\u7528JDK7 java \\ -Xmx512M \\ -XX:MaxPermSize=128M \\ -jar ./biz-1.0.0-SNAPSHOT.jar # Tomcat\u542f\u52a8 java \\ -Djava.util.logging.config.file=/usr/local/tomcat/conf/logging.properties \\ -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager \\ -Djdk.tls.ephemeralDHKeySize=2048 \\ -Dignore.endorsed.dirs= \\ -classpath /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jar \\ -Dcatalina.base=/usr/local/tomcat \\ -Dcatalina.home=/usr/local/tomcat \\ -Djava.io.tmpdir=/usr/local/tomcat/temp org.apache.catalina.startup.Bootstrap start","title":"\u56de\u6536\u7b97\u6cd5"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/mutt/","text":"Mutt \u547d\u4ee4\u884c\u90ae\u4ef6\u5ba2\u6237\u7aef \u73af\u5883\uff1aMac \u5b89\u88c5 brew install mutt msmtp getmail \u53d1\u90ae\u4ef6\u914d\u7f6e msmtp --host=smtp.163.com --port=25 --serverinfo \u67e5\u8be2smtp\u670d\u52a1\u652f\u6301\u7684\u767b\u5165\u65b9\u5f0f \u7f16\u8f91\u53d1\u90ae\u4ef6\u914d\u7f6e ~/.msmtprc account wy163 # \u81ea\u5b9a\u4e49\u8d26\u53f7 host smtp.163.com # \u53d1\u9001smtp\u670d\u52a1\u5668\u57df\u540d from chenqing24@163.com # \u53d1\u9001\u8005 auth login # \u767b\u5165\u65b9\u5f0f\uff0c\u5bf9\u5e94\u4e0a\u9762\u67e5\u5230\u7684 user xxx@163.com # \u767b\u5165\u670d\u52a1\u5668\u7684\u8d26\u53f7 password ******** # \u4e0a\u9762\u8d26\u53f7\u5bf9\u5e94\u7684\u5bc6\u7801 account default : wy163 # \u9ed8\u8ba4\u53d1\u9001\u8d26\u53f7 chmod 600 ~/.msmtprc which msmtp \u786e\u8ba4\u53d1\u90ae\u4ef6\u4ee3\u7406\u7684\u8def\u5f84 \u7f16\u8f91\u90ae\u4ef6\u5ba2\u6237\u7aef\u914d\u7f6e ~/.muttrc set sendmail=\"/usr/local/bin/msmtp\" set realname=\"xxx\" # \u53d1\u4fe1\u4eba\u540d\u79f0 set from=\"xxx@163.com\" # \u9ed8\u8ba4\u7684\u53d1\u4fe1\u5730\u5740 set envelope_from=yes # \u4f7f\u7528from\u57df\u4f5c\u4e3asender, \u5426\u5219\u4f7f\u7528user@localhost set use_from=yes # \u81ea\u52a8\u751f\u6210from\u5730\u5740 set editor=\"vim -nw\" # \u8bbe\u7f6e\u4f7f\u7528\u7684\u7f16\u8f91\u5668 echo \"hello world\" | mutt -s \"mail title\" -- xxx@yyy.com \u6d4b\u8bd5\u53d1\u9001\u90ae\u4ef6\u7ed9xxx@yyy.com \u6536\u90ae\u4ef6\u914d\u7f6e mkdir -p ~/Mail/inbox/{cur,new,tmp} \u521b\u5efa\u6536\u4ef6\u7bb1\u76f8\u5173\u76ee\u5f55 \u7f16\u8f91\u6536\u90ae\u4ef6\u914d\u7f6e ~/.getmail/getmailrc [retriever] # \u90ae\u7bb1\u7684\u8d26\u6237\u4fe1\u606f\uff0c\u7528\u4e8e\u6536\u53d6\u90ae\u4ef6. type = SimplePOP3SSLRetriever server = pop.163.com username = xxx@163.com port = 995 password = ******** [destination] # \u5982\u4f55\u5904\u7406\u5df2\u7ecf\u6536\u53d6\u5230\u7684\u90ae\u4ef6 type = Maildir path = ~/Mail/inbox/ [option] # \u9ed8\u8ba4\u4e3aTrue, \u6bcf\u6b21\u6267\u884cgetmail\u6536\u53d6\u5168\u90e8\u90ae\u4ef6, False\u8868\u793a\u53ea\u6536\u53d6\u672a\u6536\u53d6\u8fc7\u7684\u90ae\u4ef6 read_all = False # \u672c\u5730\u5220\u9664\u670d\u52a1\u5668\u662f\u5426\u4e5f\u5220\u9664\u90ae\u4ef6 delete = False message_log = ~/.getmail/getmail.log getmail -n \u6536\u90ae\u4ef6\u6d4b\u8bd5 \u7f16\u8f91\u90ae\u4ef6\u5ba2\u6237\u7aef\u914d\u7f6e ~/.muttrc # \u6536\u4fe1\u914d\u7f6e set mbox_type=Maildir set folder=~/Mail/inbox set spoolfile=~/Mail/inbox/ set header_cache=~/Mail/.hcache \u4f7f\u7528 Mutt\u547d\u4ee4 mutt [-nx] [-e cmd] [-F file] [-s subj] [-b addr] [-c addr] [-a file [...] --] addr [...] message \u53c2\u6570\uff1a -a \u6587\u4ef6 \u90ae\u4ef6\u9644\u52a0\u6587\u4ef6 -b \u5730\u5740 BCC\u5bc6\u9001 -c \u5730\u5740 CC\u6284\u9001 -F \u914d\u7f6e\u6587\u4ef6 \u6307\u5b9a.muttrc\u6587\u4ef6 -m \u7c7b\u578b \u6307\u5b9a\u9884\u8bbe\u7684\u90ae\u4ef6\u4fe1\u7bb1\u7c7b\u578b -p \u90ae\u4ef6\u6682\u7f13\u5bc4\u51fa -R \u4ee5\u53ea\u8bfb\u7684\u65b9\u5f0f\u5f00\u542f\u90ae\u4ef6 -s \u4e3b\u9898 \u6307\u5b9a\u90ae\u4ef6\u7684\u4e3b\u9898","title":"Mutt \u547d\u4ee4\u884c\u90ae\u4ef6\u5ba2\u6237\u7aef"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/mutt/#mutt","text":"\u73af\u5883\uff1aMac","title":"Mutt \u547d\u4ee4\u884c\u90ae\u4ef6\u5ba2\u6237\u7aef"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/mutt/#_1","text":"brew install mutt msmtp getmail","title":"\u5b89\u88c5"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/mutt/#_2","text":"msmtp --host=smtp.163.com --port=25 --serverinfo \u67e5\u8be2smtp\u670d\u52a1\u652f\u6301\u7684\u767b\u5165\u65b9\u5f0f \u7f16\u8f91\u53d1\u90ae\u4ef6\u914d\u7f6e ~/.msmtprc account wy163 # \u81ea\u5b9a\u4e49\u8d26\u53f7 host smtp.163.com # \u53d1\u9001smtp\u670d\u52a1\u5668\u57df\u540d from chenqing24@163.com # \u53d1\u9001\u8005 auth login # \u767b\u5165\u65b9\u5f0f\uff0c\u5bf9\u5e94\u4e0a\u9762\u67e5\u5230\u7684 user xxx@163.com # \u767b\u5165\u670d\u52a1\u5668\u7684\u8d26\u53f7 password ******** # \u4e0a\u9762\u8d26\u53f7\u5bf9\u5e94\u7684\u5bc6\u7801 account default : wy163 # \u9ed8\u8ba4\u53d1\u9001\u8d26\u53f7 chmod 600 ~/.msmtprc which msmtp \u786e\u8ba4\u53d1\u90ae\u4ef6\u4ee3\u7406\u7684\u8def\u5f84 \u7f16\u8f91\u90ae\u4ef6\u5ba2\u6237\u7aef\u914d\u7f6e ~/.muttrc set sendmail=\"/usr/local/bin/msmtp\" set realname=\"xxx\" # \u53d1\u4fe1\u4eba\u540d\u79f0 set from=\"xxx@163.com\" # \u9ed8\u8ba4\u7684\u53d1\u4fe1\u5730\u5740 set envelope_from=yes # \u4f7f\u7528from\u57df\u4f5c\u4e3asender, \u5426\u5219\u4f7f\u7528user@localhost set use_from=yes # \u81ea\u52a8\u751f\u6210from\u5730\u5740 set editor=\"vim -nw\" # \u8bbe\u7f6e\u4f7f\u7528\u7684\u7f16\u8f91\u5668 echo \"hello world\" | mutt -s \"mail title\" -- xxx@yyy.com \u6d4b\u8bd5\u53d1\u9001\u90ae\u4ef6\u7ed9xxx@yyy.com","title":"\u53d1\u90ae\u4ef6\u914d\u7f6e"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/mutt/#_3","text":"mkdir -p ~/Mail/inbox/{cur,new,tmp} \u521b\u5efa\u6536\u4ef6\u7bb1\u76f8\u5173\u76ee\u5f55 \u7f16\u8f91\u6536\u90ae\u4ef6\u914d\u7f6e ~/.getmail/getmailrc [retriever] # \u90ae\u7bb1\u7684\u8d26\u6237\u4fe1\u606f\uff0c\u7528\u4e8e\u6536\u53d6\u90ae\u4ef6. type = SimplePOP3SSLRetriever server = pop.163.com username = xxx@163.com port = 995 password = ******** [destination] # \u5982\u4f55\u5904\u7406\u5df2\u7ecf\u6536\u53d6\u5230\u7684\u90ae\u4ef6 type = Maildir path = ~/Mail/inbox/ [option] # \u9ed8\u8ba4\u4e3aTrue, \u6bcf\u6b21\u6267\u884cgetmail\u6536\u53d6\u5168\u90e8\u90ae\u4ef6, False\u8868\u793a\u53ea\u6536\u53d6\u672a\u6536\u53d6\u8fc7\u7684\u90ae\u4ef6 read_all = False # \u672c\u5730\u5220\u9664\u670d\u52a1\u5668\u662f\u5426\u4e5f\u5220\u9664\u90ae\u4ef6 delete = False message_log = ~/.getmail/getmail.log getmail -n \u6536\u90ae\u4ef6\u6d4b\u8bd5 \u7f16\u8f91\u90ae\u4ef6\u5ba2\u6237\u7aef\u914d\u7f6e ~/.muttrc # \u6536\u4fe1\u914d\u7f6e set mbox_type=Maildir set folder=~/Mail/inbox set spoolfile=~/Mail/inbox/ set header_cache=~/Mail/.hcache","title":"\u6536\u90ae\u4ef6\u914d\u7f6e"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/mutt/#_4","text":"Mutt\u547d\u4ee4 mutt [-nx] [-e cmd] [-F file] [-s subj] [-b addr] [-c addr] [-a file [...] --] addr [...] message \u53c2\u6570\uff1a -a \u6587\u4ef6 \u90ae\u4ef6\u9644\u52a0\u6587\u4ef6 -b \u5730\u5740 BCC\u5bc6\u9001 -c \u5730\u5740 CC\u6284\u9001 -F \u914d\u7f6e\u6587\u4ef6 \u6307\u5b9a.muttrc\u6587\u4ef6 -m \u7c7b\u578b \u6307\u5b9a\u9884\u8bbe\u7684\u90ae\u4ef6\u4fe1\u7bb1\u7c7b\u578b -p \u90ae\u4ef6\u6682\u7f13\u5bc4\u51fa -R \u4ee5\u53ea\u8bfb\u7684\u65b9\u5f0f\u5f00\u542f\u90ae\u4ef6 -s \u4e3b\u9898 \u6307\u5b9a\u90ae\u4ef6\u7684\u4e3b\u9898","title":"\u4f7f\u7528"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/ops_bash/","text":"\u5e38\u7528\u8fd0\u7ef4\u547d\u4ee4 \u67e5\u8be2\u4fe1\u606f grep 'processor' /proc/cpuinfo | sort -u | wc -l \u67e5\u8be2\u4e3b\u673a\u903b\u8f91CPU\u603b\u6838\u6570 ifconfig | grep 'inet' | grep -v '127.0.0.1' | awk '{print $2}' \u4e3b\u673aip free -m \u5185\u5b58\u72b6\u6001\uff08\u5355\u4f4dM\uff09 hostname \u4e3b\u673a\u540d cat /etc/system-release OS\u7248\u672c uname -r \u5185\u6838\u7248\u672c ps aux|grep java|grep -v grep|wc -l \u5f53\u524djava\u8fdb\u7a0b\u603b\u6570\uff0c\u6392\u9664grep\u5e72\u6270 ifconfig eth0 | grep \"inet addr:\" | awk '{print $2}' | cut -c 6- \u67e5\u8be2\u4e3b\u673aeth0\u4e0a\u7684IP netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' \u6309\u72b6\u6001\u67e5\u8be2\u4e3b\u673a\u4e0aTCP\u8fde\u63a5\u6570 du -s * | sort -nr | head \u9009\u51fa\u6587\u4ef6\u5939\u5927\u5c0f\uff0c\u5e76\u6309\u5927\u5c0f\u8fdb\u884c\u6392\u5e8f\uff0c\u524d\u9762\u768410\u4e2a watch -n 60 -d 'ls -l -rt | tail' \u627e\u5230\u5f53\u524d\u76ee\u5f55\u6700\u65b0\u768410\u4e2a\u6587\u4ef6\uff0c1\u5206\u949f\u5237\u65b0\u4e00\u6b21 dd if=/dev/zero of=test bs=1M count=10000 oflag=direct \u6d4b\u8bd5\u78c1\u76d8IO\uff0c\u5199test,1\u4e2aM\u4e00\u6b21\uff0c10000\u6b21\uff0c\u91c7\u7528\u76f4\u63a5IO\u65b9\u5f0f \u5feb\u901f\u6267\u884c for i in `find /opt/*/bin/nohup.out`; do cat /dev/null $i; done \u627e\u5230\u6279\u91cfnohup.out\uff0c\u5e76\u6e05\u9664\u5185\u5bb9 find /opt/ -ctime +7 -name \"trace*.log\" | xargs rm -f \u627e\u52307\u5929\u4ee5\u524d\u7684log\u6587\u4ef6\uff0c\u5e76\u5220\u9664","title":"\u5e38\u7528\u8fd0\u7ef4\u547d\u4ee4"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/ops_bash/#_1","text":"","title":"\u5e38\u7528\u8fd0\u7ef4\u547d\u4ee4"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/ops_bash/#_2","text":"grep 'processor' /proc/cpuinfo | sort -u | wc -l \u67e5\u8be2\u4e3b\u673a\u903b\u8f91CPU\u603b\u6838\u6570 ifconfig | grep 'inet' | grep -v '127.0.0.1' | awk '{print $2}' \u4e3b\u673aip free -m \u5185\u5b58\u72b6\u6001\uff08\u5355\u4f4dM\uff09 hostname \u4e3b\u673a\u540d cat /etc/system-release OS\u7248\u672c uname -r \u5185\u6838\u7248\u672c ps aux|grep java|grep -v grep|wc -l \u5f53\u524djava\u8fdb\u7a0b\u603b\u6570\uff0c\u6392\u9664grep\u5e72\u6270 ifconfig eth0 | grep \"inet addr:\" | awk '{print $2}' | cut -c 6- \u67e5\u8be2\u4e3b\u673aeth0\u4e0a\u7684IP netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' \u6309\u72b6\u6001\u67e5\u8be2\u4e3b\u673a\u4e0aTCP\u8fde\u63a5\u6570 du -s * | sort -nr | head \u9009\u51fa\u6587\u4ef6\u5939\u5927\u5c0f\uff0c\u5e76\u6309\u5927\u5c0f\u8fdb\u884c\u6392\u5e8f\uff0c\u524d\u9762\u768410\u4e2a watch -n 60 -d 'ls -l -rt | tail' \u627e\u5230\u5f53\u524d\u76ee\u5f55\u6700\u65b0\u768410\u4e2a\u6587\u4ef6\uff0c1\u5206\u949f\u5237\u65b0\u4e00\u6b21 dd if=/dev/zero of=test bs=1M count=10000 oflag=direct \u6d4b\u8bd5\u78c1\u76d8IO\uff0c\u5199test,1\u4e2aM\u4e00\u6b21\uff0c10000\u6b21\uff0c\u91c7\u7528\u76f4\u63a5IO\u65b9\u5f0f","title":"\u67e5\u8be2\u4fe1\u606f"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/ops_bash/#_3","text":"for i in `find /opt/*/bin/nohup.out`; do cat /dev/null $i; done \u627e\u5230\u6279\u91cfnohup.out\uff0c\u5e76\u6e05\u9664\u5185\u5bb9 find /opt/ -ctime +7 -name \"trace*.log\" | xargs rm -f \u627e\u52307\u5929\u4ee5\u524d\u7684log\u6587\u4ef6\uff0c\u5e76\u5220\u9664","title":"\u5feb\u901f\u6267\u884c"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/supervisor/","text":"supervisord\u540e\u53f0\u8fdb\u7a0b\u7ba1\u7406 \u53c2\u8003 \u5b98\u7f51\u6587\u6863\uff1ahttp://supervisord.org/ \u670d\u52a1\u7ed3\u6784 supervisord\uff1a\u670d\u52a1\u540e\u53f0\u8fdb\u7a0b\uff0c\u5c06\u6240\u7ba1\u7406\u7684\u8fdb\u7a0b\u4f5c\u4e3a\u81ea\u5df1\u7684\u5b50\u8fdb\u7a0b\u6765\u542f\u52a8\uff0c\u53ef\u4ee5\u5728\u5b50\u8fdb\u7a0b\u5d29\u6e83\u65f6\u81ea\u52a8\u91cd\u542f\u4e4b\u3002 supervisorctl\uff1a\u547d\u4ee4\u884c\u7ba1\u7406\u5de5\u5177\uff0c\u6267\u884c stop\u3001start\u3001restart \u7b49\u547d\u4ee4\uff0c\u6765\u7ba1\u7406\u5b50\u8fdb\u7a0b\u3002 \u5b89\u88c5\u548c\u914d\u7f6e pip install supervisor \u4ee5root\u89d2\u8272\u5b89\u88c5 echo_supervisord_conf /opt/supervisor/supervisord.conf \u5efa\u8bae\u4ee5\u666e\u901a\u7528\u6237\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\uff0c\u53ef\u4ee5\u7075\u6d3b\u7f16\u8f91\u6269\u5c55 supervisord -u op -c /opt/supervisor/supervisord.conf \u4ee5\u666e\u901a\u7528\u6237op\u542f\u52a8supervisord\uff0c\u8bfb\u53d6\u6307\u5b9a\u914d\u7f6e \u5f00\u673a\u542f\u52a8supervisord \u4ee5CentOS\u4e3a\u4f8b \u65b0\u5efa\u6587\u4ef6supervisord.service [Unit] Description=Supervisord [Service] Type=forking ExecStart=/usr/bin/supervisord -u op -c /opt/supervisor/supervisord.conf ExecStop=/usr/bin/supervisorctl shutdown ExecReload=/usr/bin/supervisorctl reload KillMode=process Restart=on-failure RestartSec=42s [Install] WantedBy=multi-user.target \u6587\u4ef6\u62f7\u8d1d\u5230 /usr/lib/systemd/system/ chmod 766 supervisord.service \u6743\u9650\u8bbe\u5b9a systemctl enable supervisord \u542f\u52a8\u670d\u52a1 systemctl is-enabled supervisord \u9a8c\u8bc1\u662f\u5426\u4e3a\u5f00\u673a\u542f\u52a8 \u5e38\u7528cli #program_name \u4e3a [groupworker:program_name] \u91cc\u7684 program_name # \u505c\u6b62\u67d0\u4e00\u4e2a\u8fdb\u7a0b supervisorctl stop program_name # \u542f\u52a8\u67d0\u4e2a\u8fdb\u7a0b supervisorctl start program_name # \u91cd\u542f\u67d0\u4e2a\u8fdb\u7a0b supervisorctl restart program_name # \u7ed3\u675f\u6240\u6709\u5c5e\u4e8e\u540d\u4e3a groupworker \u8fd9\u4e2a\u5206\u7ec4\u7684\u8fdb\u7a0b (start\uff0crestart \u540c\u7406) supervisorctl stop groupworker: # \u7ed3\u675f groupworker:name1 \u8fd9\u4e2a\u8fdb\u7a0b (start\uff0crestart \u540c\u7406) supervisorctl stop groupworker:name1 # \u505c\u6b62\u5168\u90e8\u8fdb\u7a0b\uff0c\u6ce8\uff1astart\u3001restart\u3001stop \u90fd\u4e0d\u4f1a\u8f7d\u5165\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6 supervisorctl stop all # \u8f7d\u5165\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u505c\u6b62\u539f\u6709\u8fdb\u7a0b\u5e76\u6309\u65b0\u7684\u914d\u7f6e\u542f\u52a8\u3001\u7ba1\u7406\u6240\u6709\u8fdb\u7a0b supervisorctl reload # \u6839\u636e\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u542f\u52a8\u65b0\u914d\u7f6e\u6216\u6709\u6539\u52a8\u7684\u8fdb\u7a0b\uff0c\u914d\u7f6e\u6ca1\u6709\u6539\u52a8\u7684\u8fdb\u7a0b\u4e0d\u4f1a\u53d7\u5f71\u54cd\u800c\u91cd\u542f supervisorctl update supervisord.conf\u914d\u7f6e\u8be6\u89e3 ; \u6ce8\u610f\uff1a ; - \u73af\u5883\u53d8\u91cf\u652f\u6301\u6a21\u5f0f\uff1a %(ENV_HOME)s ; - \u4e0d\u652f\u6301value\u5957\u5f15\u53f7 ; - ;\u6ce8\u91ca\u4e4b\u524d\u9700\u8981\u5e26\u7a7a\u683c ; - Command\u4e2d;\u540e\u9762\u7684\u5185\u5bb9\u4f1a\u88ab\u5ffd\u7565 [unix_http_server] file=/tmp/supervisor.sock ; supervisorctl\u7528XML_RPC\u548csupervisord\u901a\u4fe1\u5c31\u662f\u901a\u8fc7\u5b83\u8fdb\u884c\u7684\u3002\u5982\u679c\u4e0d\u8bbe\u7f6e\u7684\u8bdd\uff0csupervisorctl\u5c31\u4e0d\u80fd\u7528\uff0c\u9ed8\u8ba4\u4e3anone\u3002\u975e\u5fc5\u987b ;chmod=0700 ; socket file mode (default 0700) ;chown=nobody:nogroup ; socket file uid:gid owner ;username=user ; \u4f7f\u7528supervisorctl\u8fde\u63a5\u7684\u65f6\u5019\u7684\u7528\u6237\u540d\uff0c\u9ed8\u8ba4\u4e3a\u4e0d\u9700\u8981\u8ba4\u8bc1\u3002 \u975e\u5fc5\u987b ;password=123 ; \u5bf9\u5e94\u7684\u5bc6\u7801\uff0c\u53ef\u660e\u7801\uff0c\u4e5f\u53ef\u7528SHA\u52a0\u5bc6\u5982\uff1a{SHA}82ab876d1387bfafe46cc1c8a2ef074eae50cb1d\uff0c\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e\u3002\u975e\u5fc5\u987b ;[inet_http_server] ; \u4fa6\u542c\u7684socket\uff0cWeb Server\u548c\u8fdc\u7a0b\u7684supervisorctl\u8981\u7528\u5230\uff0c\u9ed8\u8ba4\u4e0d\u5f00\u542f\u3002\u975e\u5fc5\u987b ;port=127.0.0.1:9001 ; ip_address:port specifier, *:port for all iface ;username=user ; default is no username (open server) ;password=123 ; default is no password (open server) [supervisord] ; \u5b9a\u4e49supervisord\u670d\u52a1\u7aef\u8fdb\u7a0b\u53c2\u6570\uff0c\u5fc5\u987b\u8bbe\u7f6e logfile=/tmp/supervisord.log ; main log file; default $CWD/supervisord.log logfile_maxbytes=50MB ; max main logfile bytes b4 rotation; default 50MB logfile_backups=10 ; # of main logfile backups; 0 means none, default 10 loglevel=info ; log level; default info; others: debug,warn,trace pidfile=/tmp/supervisord.pid ; supervisord pidfile; default supervisord.pid nodaemon=false ; \u540e\u53f0\u4ee5\u5b88\u62a4\u8fdb\u7a0b\u8fd0\u884c\uff0c\u5982\u679ctrue\uff0csupervisord\u8fdb\u7a0b\u5c06\u5728\u524d\u53f0\u8fd0\u884c\uff0c\u975e\u5fc5\u987b minfds=1024 ; \u6700\u5c11\u7cfb\u7edf\u7a7a\u95f2\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08/proc/sys/fs/file-max\uff09\uff0c\u4f4e\u4e8e\u8fd9\u4e2a\u503c\u670d\u52a1\u4e0d\u4f1a\u542f\u52a8\uff0c\u975e\u5fc5\u987b minprocs=200 ; \u6700\u5c0f\u53ef\u7528\u7684\u8fdb\u7a0b\u6570\uff08ulimit -u\uff09\uff0c\u4f4e\u4e8e\u8fd9\u4e2a\u503c\u670d\u52a1\u4e0d\u4f1a\u6b63\u5e38\u542f\u52a8\u3002\u9ed8\u8ba4200\u3002\u975e\u5fc5\u987b ;umask=022 ; process file creation umask; default 022 user=op ; \u4ee5root\u542f\u52a8supervisord\u540e\u3002\u8fd9\u4e2a\u7528\u6237\u4e5f\u53ef\u4ee5\u5bf9supervisord\u8fdb\u884c\u7ba1\u7406\u3002\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e\u3002\u975e\u5fc5\u987b ;identifier=supervisor ; supervisord\u7684\u6807\u8bc6\u7b26\uff0c\u7ed9XML_RPC\u7528\u7684\u3002\u5f53\u6709\u591a\u4e2asupervisor\u7684\u65f6\u5019\uff0c\u4e14\u60f3\u7528XML_RPC\u7edf\u4e00\u7ba1\u7406\uff0c\u9700\u8981\u4e3a\u6bcf\u4e2asupervisor\u8bbe\u7f6e\u4e0d\u540c\u7684\u6807\u8bc6\u7b26\u3002\u9ed8\u8ba4\u662fsupervisord\u3002\u975e\u5fc5\u987b ;directory=/tmp ; default is not to cd during start ;nocleanup=true ; don't clean up tempfiles at start; default false ;childlogdir=/tmp ; \u5f53\u5b50\u8fdb\u7a0b\u65e5\u5fd7\u8def\u5f84\u4e3aAUTO\u7684\u65f6\u5019\uff0c\u5b50\u8fdb\u7a0b\u65e5\u5fd7\u6587\u4ef6\u7684\u5b58\u653e\u8def\u5f84(python -c import tempfile;print tempfile.gettempdir() ) ;environment=KEY= value ; supervisord\u5728\u542f\u52a8\u65f6\uff0c\u9ed8\u8ba4\u7ee7\u627flinux\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5728\u8fd9\u91cc\u53ef\u4ee5\u8bbe\u7f6esupervisord\u8fdb\u7a0b\u7279\u6709\u7684\u5176\u4ed6\u73af\u5883\u53d8\u91cf\u3002supervisord\u542f\u52a8\u5b50\u8fdb\u7a0b\u65f6\uff0c\u5b50\u8fdb\u7a0b\u4f1a\u62f7\u8d1d\u7236\u8fdb\u7a0b\u7684\u5185\u5b58\u7a7a\u95f4\u5185\u5bb9\u3002 \u6240\u4ee5\u8bbe\u7f6e\u7684\u8fd9\u4e9b\u73af\u5883\u53d8\u91cf\u4e5f\u4f1a\u88ab\u5b50\u8fdb\u7a0b\u7ee7\u627f\u3002\u4f8b\uff1aenvironment=name= haha ,age= hehe ;strip_ansi=false ; \u6e05\u9664\u5b50\u8fdb\u7a0b\u65e5\u5fd7\u4e2d\u7684\u6240\u6709ANSI\u5e8f\u5217\uff08\u4f8b\u5982\\n,\\t\uff09 [rpcinterface:supervisor] ; \u7ed9XML_RPC\u7528\u7684\uff0c\u5982\u679c\u60f3\u4f7f\u7528supervisord\u6216\u8005web server\uff0c\u8be5\u9009\u9879\u5fc5\u987b\u8981\u5f00\u542f supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface [supervisorctl] serverurl=unix:///tmp/supervisor.sock ; supervisorctl\u672c\u5730\u8fde\u63a5supervisord\u65f6\uff0c\u672c\u5730UNIX socket\u8def\u5f84\uff0c\u548c\u524d\u9762\u7684[unix_http_server]\u5bf9\u5e94\u7684\uff0c\u9ed8\u8ba4\u503c\u5c31\u662funix:///tmp/supervisor.sock\uff0c\u975e\u5fc5\u987b ;serverurl=http://127.0.0.1:9001 ; supervisorctl\u8fdc\u7a0b\u8fde\u63a5supervisord\u7684\u65f6\u5019\uff0c\u7528\u5230\u7684TCP socket\u8def\u5f84\uff0c\u6ce8\u610f\u8fd9\u548c\u524d\u9762\u7684[inet_http_server]\u5bf9\u5e94\uff0c\u975e\u5fc5\u987b ;username=chris ; should be same as in [*_http_server] if set ;password=123 ; should be same as in [*_http_server] if set ;prompt=mysupervisor ; \u8f93\u5165\u7528\u6237\u540d\u5bc6\u7801\u65f6\u5019\u7684\u63d0\u793a\u7b26 ;history_file=~/.sc_history ; \u548cshell\u4e2dhistory\u7c7b\u4f3c\uff0c\u53ef\u7528\u4e0a\u4e0b\u952e\u6765\u67e5\u627e\u524d\u9762\u6267\u884c\u8fc7\u7684\u547d\u4ee4\uff0c\u9ed8\u8ba4\u662fno file\u3002\u975e\u5fc5\u987b ;[program:theprogramname] ; \u8981\u7ba1\u7406\u7684\u5b50\u8fdb\u7a0b\uff0c : \u540e\u9762\u7684\u662f\u540d\u5b57\uff0cprogram\u53ef\u4ee5\u8bbe\u7f6e\u591a\u4e2a\uff0c\u4e00\u4e2aprogram\u5c31\u662f\u8981\u88ab\u7ba1\u7406\u7684\u4e00\u4e2a\u8fdb\u7a0b ;command=/bin/cat ; \u8981\u542f\u52a8\u8fdb\u7a0b\u7684\u547d\u4ee4\u8def\u5f84\uff0c\u53ef\u5e26\u53c2\u6570\uff0c\u4f8b\u5b50\uff1a/home/test.py -a 'hehe'\u3002\u6ce8\u610f\uff1acommand\u4e0d\u80fd\u662f\u5b88\u62a4\u8fdb\u7a0b\u3002\u5fc5\u987b\u9879 ;process_name=%(program_name)s ; \u8fdb\u7a0b\u540d\uff0c\u5982\u679c\u4e0b\u9762\u7684numprocs=1\u7684\u8bdd\uff0c\u5c31\u4e0d\u7528\u7ba1\u3002\u9ed8\u8ba4\u503c%(program_name)s\uff0c\u4e5f\u5c31\u662f\u4e0a\u9762\u7684\u90a3\u4e2aprogram\u5192\u53f7\u540e\u9762\u7684\u540d\u5b57\uff0c\u4f46\u5982\u679cnumprocs\u4e3a\u591a\u4e2a\u65f6\uff0c\u9700\u8981\u914d\u7f6e\u3002 ;numprocs=1 ; \u542f\u52a8\u8fdb\u7a0b\u6570\u3002\u5f53\u4e0d\u4e3a1\u65f6\uff0c\u5c31\u662f\u8fdb\u7a0b\u6c60\u3002\u6ce8\u610fprocess_name\u7684\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u4e3a1\u3002\u975e\u5fc5\u987b ;directory=/tmp ; \u8fdb\u7a0b\u8fd0\u884c\u524d\uff0c\u4f1a\u524d\u5207\u6362\u5230\u8be5\u76ee\u5f55 ;umask=022 ; umask for process (default None) ;priority=999 ; \u5b50\u8fdb\u7a0b\u542f\u52a8\u5173\u95ed\u4f18\u5148\u7ea7\uff0c\u4f18\u5148\u7ea7\u4f4e\u7684\uff0c\u6700\u5148\u542f\u52a8\uff0c\u6700\u540e\u5173\u95ed ;autostart=true ; start at supervisord start (default: true) ;startsecs=1 ; \u5b50\u8fdb\u7a0b\u542f\u52a8\u591a\u5c11\u79d2\u4e4b\u540e\uff0c\u72b6\u6001\u5982\u679c\u662frunning\uff0c\u5219\u8ba4\u4e3a\u542f\u52a8\u6210\u529f ;startretries=3 ; \u5f53\u8fdb\u7a0b\u542f\u52a8\u5931\u8d25\u540e\uff0c\u6700\u5927\u5c1d\u8bd5\u542f\u52a8\u7684\u6b21\u6570\uff0c\u5f53\u8d85\u8fc7\u540e\uff0csupervisor\u628a\u6b64\u8fdb\u7a0b\u7684\u72b6\u6001\u7f6e\u4e3aFAIL ;autorestart=unexpected ; \u8bbe\u7f6e\u5b50\u8fdb\u7a0b\u6302\u6389\u540e\u81ea\u52a8\u91cd\u542f\u7684\u60c5\u51b5\uff0c\u6709\u4e09\u4e2a\u9009\u9879\uff1afalse,unexpected\u548ctrue ; false\uff0c\u65e0\u8bba\u4ec0\u4e48\u60c5\u51b5\u4e0b\uff0c\u90fd\u4e0d\u4f1a\u88ab\u91cd\u65b0\u542f\u52a8 ; unexpected\uff0c\u5f53\u8fdb\u7a0b\u7684\u9000\u51fa\u7801\u4e0d\u5728exitcodes\u91cc\u9762\u5b9a\u4e49\u65f6\uff0c\u624d\u4f1a\u88ab\u81ea\u52a8\u91cd\u542f ; true\uff0c\u53ea\u8981\u5b50\u8fdb\u7a0b\u6302\u6389\uff0c\u5c06\u4f1a\u88ab\u65e0\u6761\u4ef6\u7684\u91cd\u542f ;exitcodes=0,2 ; 'expected' exit codes used with autorestart (default 0,2) ;stopsignal=QUIT ; \u8fdb\u7a0b\u505c\u6b62\u4fe1\u53f7\uff0c\u53ef\u4ee5\u4e3aTERM, HUP, INT, QUIT, KILL, USR1, or USR2\u7b49\u4fe1\u53f7 ;stopwaitsecs=10 ; \u5411\u5b50\u8fdb\u7a0b\u53d1\u9001stopsignal\u4fe1\u53f7\u540e\uff0c\u5230\u7cfb\u7edf\u8fd4\u56de\u4fe1\u606f\uff0c\u6240\u7b49\u5f85\u7684\u6700\u5927\u65f6\u95f4\u3002\u8d85\u8fc7\u8fd9\u4e2a\u65f6\u95f4\uff0c\u4f1a\u5411\u8be5\u5b50\u8fdb\u7a0b\u53d1\u9001\u4e00\u4e2a\u5f3a\u5236kill\u7684\u4fe1\u53f7 ;stopasgroup=false ; \u7528\u4e8e\u7ba1\u7406\u7684\u5b50\u8fdb\u7a0b\u672c\u8eab\u8fd8\u6709\u5b50\u8fdb\u7a0b\u3002\u5982\u679c\u4ec5\u4ec5\u5e72\u6389\u5b50\u8fdb\u7a0b\u7684\u8bdd\uff0c\u5b50\u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b\u6709\u53ef\u80fd\u53d8\u6210\u5b64\u513f\u8fdb\u7a0b\u3002\u8be5\u9009\u9879true\u65f6\uff0c\u628a\u8be5\u5b50\u8fdb\u7a0b\u7684\u6574\u4e2a\u8fdb\u7a0b\u7ec4\u90fd\u5e72\u6389\u3002\u6ce8\u610f\uff0c\u8be5\u9009\u9879\u53d1\u9001\u7684\u662fstop\u4fe1\u53f7\uff0c\u9ed8\u8ba4false\u3002\u975e\u5fc5\u987b ;killasgroup=false ; \u548cstopasgroup\u7c7b\u4f3c\uff0c\u53d1\u9001\u7684\u662fkill\u4fe1\u53f7 ;user=chrism ; setuid to this UNIX account to run the program ;redirect_stderr=true ; true\u65f6\uff0cstderr\u65e5\u5fd7\u88ab\u5199\u5165stdout\u65e5\u5fd7\u6587\u4ef6\u4e2d\u3002\u9ed8\u8ba4\u4e3afalse\uff0c\u975e\u5fc5\u987b ;stdout_logfile=/a/path ; \u5b50\u8fdb\u7a0b\u7684stdout\u7684\u65e5\u5fd7\u8def\u5f84\uff0c\u53ef\u4ee5\u6307\u5b9a\u8def\u5f84\uff0cAUTO\uff0cnone\u4e09\u4e2a\u9009\u9879 ; AUTO\u65f6\uff0c\u968f\u673a\u627e\u4e00\u4e2a\u5730\u65b9\u751f\u6210\u65e5\u5fd7\uff0c\u800c\u5f53supervisord\u91cd\u65b0\u542f\u52a8\u65f6\uff0c\u4ee5\u524d\u65e5\u5fd7\u4f1a\u6e05\u7a7a ;stdout_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stdout_logfile_backups=10 ; # of stdout logfile backups (0 means none, default 10) ;stdout_capture_maxbytes=1MB ; \u8bbe\u5b9acapture\u7ba1\u9053\u7684\u5927\u5c0f\uff0c\u5f53\u503c\u4e0d\u4e3a0\u7684\u65f6\u5019\uff0c\u5b50\u8fdb\u7a0b\u53ef\u4ee5\u4ecestdout\u53d1\u9001\u4fe1\u606f\uff0c\u800csupervisor\u53ef\u4ee5\u6839\u636e\u4fe1\u606f\uff0c\u53d1\u9001\u76f8\u5e94\u7684event\u3002\u9ed8\u8ba4\u4e3a0\uff0c\u8868\u8fbe\u5173\u95ed\u7ba1\u9053\u3002\u975e\u5fc5\u987b ;stdout_events_enabled=false ; \u4e3ature\u65f6\uff0c\u5f53\u5b50\u8fdb\u7a0b\u7531stdout\u5411\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e2d\u5199\u65e5\u5fd7\u65f6\uff0c\u5c06\u89e6\u53d1supervisord\u53d1\u9001PROCESS_LOG_STDOUT\u7c7b\u578b\u7684event\u3002\u8ba4\u4e3afalse\u3002\u975e\u5fc5\u987b ;stderr_logfile=/a/path ; stderr log path, NONE for none; default AUTO ;stderr_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stderr_logfile_backups=10 ; # of stderr logfile backups (0 means none, default 10) ;stderr_capture_maxbytes=1MB ; number of bytes in 'capturemode' (default 0) ;stderr_events_enabled=false ; emit events on stderr writes (default false) ;environment=A= 1 ,B= 2 ; \u8be5\u5b50\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\uff0c\u548c\u522b\u7684\u5b50\u8fdb\u7a0b\u662f\u4e0d\u5171\u4eab ;serverurl=AUTO ; override serverurl computation (childutils) ;[eventlistener:theeventlistenername] ; \u8ba2\u9605supervisord\u53d1\u9001\u7684event\u3002\u53ef\u5728listener\u91cc\u9762\u505a\u4e00\u7cfb\u5217\u5904\u7406\uff0c\u6bd4\u5982\u62a5\u8b66\u7b49 ;command=/bin/eventlistener ; the program (relative uses PATH, can take args) ;process_name=%(program_name)s ; process_name expr (default %(program_name)s) ;numprocs=1 ; number of processes copies to start (def 1) ;events=EVENT ; \u4e8b\u4ef6\u7684\u7c7b\u578b\uff0c\u53ea\u6709\u8be5\u4e8b\u4ef6\u7c7b\u578b\u3002\u624d\u4f1a\u88ab\u53d1\u9001(req'd) ;buffer_size=10 ; event\u961f\u5217\u7f13\u5b58\u5927\u5c0f (default 10) ;directory=/tmp ; directory to cwd to before exec (def no cwd) ;umask=022 ; umask for process (default None) ;priority=-1 ; the relative start priority (default -1) ;autostart=true ; start at supervisord start (default: true) ;startsecs=1 ; # of secs prog must stay up to be running (def. 1) ;startretries=3 ; max # of serial start failures when starting (default 3) ;autorestart=unexpected ; autorestart if exited after running (def: unexpected) ;exitcodes=0,2 ; 'expected' exit codes used with autorestart (default 0,2) ;stopsignal=QUIT ; signal used to kill process (default TERM) ;stopwaitsecs=10 ; max num secs to wait b4 SIGKILL (default 10) ;stopasgroup=false ; send stop signal to the UNIX process group (default false) ;killasgroup=false ; SIGKILL the UNIX process group (def false) ;user=chrism ; setuid to this UNIX account to run the program ;redirect_stderr=false ; redirect_stderr=true is not allowed for eventlisteners ;stdout_logfile=/a/path ; stdout log path, NONE for none; default AUTO ;stdout_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stdout_logfile_backups=10 ; # of stdout logfile backups (0 means none, default 10) ;stdout_events_enabled=false ; emit events on stdout writes (default false) ;stderr_logfile=/a/path ; stderr log path, NONE for none; default AUTO ;stderr_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stderr_logfile_backups=10 ; # of stderr logfile backups (0 means none, default 10) ;stderr_events_enabled=false ; emit events on stderr writes (default false) ;environment=A= 1 ,B= 2 ; process environment additions ;serverurl=AUTO ; override serverurl computation (childutils) ;[group:thegroupname] ; \u7ed9programs\u5206\u7ec4\uff0c\u5212\u5206\u5230\u7ec4\u91cc\u9762\u7684program\u3002\u53ef\u4ee5\u5bf9\u7ec4\u540d\u8fdb\u884c\u7edf\u4e00\u7684\u64cd\u4f5c\u3002\u6ce8\u610f\uff1aprogram\u88ab\u5212\u5206\u5230\u7ec4\u91cc\u9762\u4e4b\u540e\uff0c\u76f8\u5f53\u4e8e\u539f\u6765\u7684\u914d\u7f6e\u5931\u6548\u3002supervisor\u53ea\u5bf9\u7ec4\u8fdb\u884c\u7ba1\u7406\uff0c\u800c\u4e0d\u518d\u5bf9\u7ec4\u91cc\u9762\u7684\u5355\u4e2aprogram\u8fdb\u884c\u7ba1\u7406 ;programs=progname1,progname2 ; each refers to 'x' in [program:x] definitions ;priority=999 ; the relative start priority (default 999) ; The [include] section can just contain the files setting. This ; setting can list multiple files (separated by whitespace or ; newlines). It can also contain wildcards. The filenames are ; interpreted as relative to this file. Included files *cannot* ; include files themselves. ;[include] ; \u5f53\u6211\u4eec\u8981\u7ba1\u7406\u7684\u8fdb\u7a0b\u5f88\u591a\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u628a\u914d\u7f6e\u4fe1\u606f\u5199\u5230\u591a\u4e2a\u6587\u4ef6\u4e2d\uff0c\u7136\u540einclude\u8fc7\u6765 ;files = relative/directory/*.ini","title":"supervisord\u540e\u53f0\u8fdb\u7a0b\u7ba1\u7406"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/supervisor/#supervisord","text":"","title":"supervisord\u540e\u53f0\u8fdb\u7a0b\u7ba1\u7406"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/supervisor/#_1","text":"\u5b98\u7f51\u6587\u6863\uff1ahttp://supervisord.org/","title":"\u53c2\u8003"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/supervisor/#_2","text":"supervisord\uff1a\u670d\u52a1\u540e\u53f0\u8fdb\u7a0b\uff0c\u5c06\u6240\u7ba1\u7406\u7684\u8fdb\u7a0b\u4f5c\u4e3a\u81ea\u5df1\u7684\u5b50\u8fdb\u7a0b\u6765\u542f\u52a8\uff0c\u53ef\u4ee5\u5728\u5b50\u8fdb\u7a0b\u5d29\u6e83\u65f6\u81ea\u52a8\u91cd\u542f\u4e4b\u3002 supervisorctl\uff1a\u547d\u4ee4\u884c\u7ba1\u7406\u5de5\u5177\uff0c\u6267\u884c stop\u3001start\u3001restart \u7b49\u547d\u4ee4\uff0c\u6765\u7ba1\u7406\u5b50\u8fdb\u7a0b\u3002","title":"\u670d\u52a1\u7ed3\u6784"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/supervisor/#_3","text":"pip install supervisor \u4ee5root\u89d2\u8272\u5b89\u88c5 echo_supervisord_conf /opt/supervisor/supervisord.conf \u5efa\u8bae\u4ee5\u666e\u901a\u7528\u6237\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\uff0c\u53ef\u4ee5\u7075\u6d3b\u7f16\u8f91\u6269\u5c55 supervisord -u op -c /opt/supervisor/supervisord.conf \u4ee5\u666e\u901a\u7528\u6237op\u542f\u52a8supervisord\uff0c\u8bfb\u53d6\u6307\u5b9a\u914d\u7f6e","title":"\u5b89\u88c5\u548c\u914d\u7f6e"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/supervisor/#supervisord_1","text":"\u4ee5CentOS\u4e3a\u4f8b \u65b0\u5efa\u6587\u4ef6supervisord.service [Unit] Description=Supervisord [Service] Type=forking ExecStart=/usr/bin/supervisord -u op -c /opt/supervisor/supervisord.conf ExecStop=/usr/bin/supervisorctl shutdown ExecReload=/usr/bin/supervisorctl reload KillMode=process Restart=on-failure RestartSec=42s [Install] WantedBy=multi-user.target \u6587\u4ef6\u62f7\u8d1d\u5230 /usr/lib/systemd/system/ chmod 766 supervisord.service \u6743\u9650\u8bbe\u5b9a systemctl enable supervisord \u542f\u52a8\u670d\u52a1 systemctl is-enabled supervisord \u9a8c\u8bc1\u662f\u5426\u4e3a\u5f00\u673a\u542f\u52a8","title":"\u5f00\u673a\u542f\u52a8supervisord"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/supervisor/#cli","text":"#program_name \u4e3a [groupworker:program_name] \u91cc\u7684 program_name # \u505c\u6b62\u67d0\u4e00\u4e2a\u8fdb\u7a0b supervisorctl stop program_name # \u542f\u52a8\u67d0\u4e2a\u8fdb\u7a0b supervisorctl start program_name # \u91cd\u542f\u67d0\u4e2a\u8fdb\u7a0b supervisorctl restart program_name # \u7ed3\u675f\u6240\u6709\u5c5e\u4e8e\u540d\u4e3a groupworker \u8fd9\u4e2a\u5206\u7ec4\u7684\u8fdb\u7a0b (start\uff0crestart \u540c\u7406) supervisorctl stop groupworker: # \u7ed3\u675f groupworker:name1 \u8fd9\u4e2a\u8fdb\u7a0b (start\uff0crestart \u540c\u7406) supervisorctl stop groupworker:name1 # \u505c\u6b62\u5168\u90e8\u8fdb\u7a0b\uff0c\u6ce8\uff1astart\u3001restart\u3001stop \u90fd\u4e0d\u4f1a\u8f7d\u5165\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6 supervisorctl stop all # \u8f7d\u5165\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u505c\u6b62\u539f\u6709\u8fdb\u7a0b\u5e76\u6309\u65b0\u7684\u914d\u7f6e\u542f\u52a8\u3001\u7ba1\u7406\u6240\u6709\u8fdb\u7a0b supervisorctl reload # \u6839\u636e\u6700\u65b0\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u542f\u52a8\u65b0\u914d\u7f6e\u6216\u6709\u6539\u52a8\u7684\u8fdb\u7a0b\uff0c\u914d\u7f6e\u6ca1\u6709\u6539\u52a8\u7684\u8fdb\u7a0b\u4e0d\u4f1a\u53d7\u5f71\u54cd\u800c\u91cd\u542f supervisorctl update","title":"\u5e38\u7528cli"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/linux\u5de5\u5177/supervisor/#supervisordconf","text":"; \u6ce8\u610f\uff1a ; - \u73af\u5883\u53d8\u91cf\u652f\u6301\u6a21\u5f0f\uff1a %(ENV_HOME)s ; - \u4e0d\u652f\u6301value\u5957\u5f15\u53f7 ; - ;\u6ce8\u91ca\u4e4b\u524d\u9700\u8981\u5e26\u7a7a\u683c ; - Command\u4e2d;\u540e\u9762\u7684\u5185\u5bb9\u4f1a\u88ab\u5ffd\u7565 [unix_http_server] file=/tmp/supervisor.sock ; supervisorctl\u7528XML_RPC\u548csupervisord\u901a\u4fe1\u5c31\u662f\u901a\u8fc7\u5b83\u8fdb\u884c\u7684\u3002\u5982\u679c\u4e0d\u8bbe\u7f6e\u7684\u8bdd\uff0csupervisorctl\u5c31\u4e0d\u80fd\u7528\uff0c\u9ed8\u8ba4\u4e3anone\u3002\u975e\u5fc5\u987b ;chmod=0700 ; socket file mode (default 0700) ;chown=nobody:nogroup ; socket file uid:gid owner ;username=user ; \u4f7f\u7528supervisorctl\u8fde\u63a5\u7684\u65f6\u5019\u7684\u7528\u6237\u540d\uff0c\u9ed8\u8ba4\u4e3a\u4e0d\u9700\u8981\u8ba4\u8bc1\u3002 \u975e\u5fc5\u987b ;password=123 ; \u5bf9\u5e94\u7684\u5bc6\u7801\uff0c\u53ef\u660e\u7801\uff0c\u4e5f\u53ef\u7528SHA\u52a0\u5bc6\u5982\uff1a{SHA}82ab876d1387bfafe46cc1c8a2ef074eae50cb1d\uff0c\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e\u3002\u975e\u5fc5\u987b ;[inet_http_server] ; \u4fa6\u542c\u7684socket\uff0cWeb Server\u548c\u8fdc\u7a0b\u7684supervisorctl\u8981\u7528\u5230\uff0c\u9ed8\u8ba4\u4e0d\u5f00\u542f\u3002\u975e\u5fc5\u987b ;port=127.0.0.1:9001 ; ip_address:port specifier, *:port for all iface ;username=user ; default is no username (open server) ;password=123 ; default is no password (open server) [supervisord] ; \u5b9a\u4e49supervisord\u670d\u52a1\u7aef\u8fdb\u7a0b\u53c2\u6570\uff0c\u5fc5\u987b\u8bbe\u7f6e logfile=/tmp/supervisord.log ; main log file; default $CWD/supervisord.log logfile_maxbytes=50MB ; max main logfile bytes b4 rotation; default 50MB logfile_backups=10 ; # of main logfile backups; 0 means none, default 10 loglevel=info ; log level; default info; others: debug,warn,trace pidfile=/tmp/supervisord.pid ; supervisord pidfile; default supervisord.pid nodaemon=false ; \u540e\u53f0\u4ee5\u5b88\u62a4\u8fdb\u7a0b\u8fd0\u884c\uff0c\u5982\u679ctrue\uff0csupervisord\u8fdb\u7a0b\u5c06\u5728\u524d\u53f0\u8fd0\u884c\uff0c\u975e\u5fc5\u987b minfds=1024 ; \u6700\u5c11\u7cfb\u7edf\u7a7a\u95f2\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08/proc/sys/fs/file-max\uff09\uff0c\u4f4e\u4e8e\u8fd9\u4e2a\u503c\u670d\u52a1\u4e0d\u4f1a\u542f\u52a8\uff0c\u975e\u5fc5\u987b minprocs=200 ; \u6700\u5c0f\u53ef\u7528\u7684\u8fdb\u7a0b\u6570\uff08ulimit -u\uff09\uff0c\u4f4e\u4e8e\u8fd9\u4e2a\u503c\u670d\u52a1\u4e0d\u4f1a\u6b63\u5e38\u542f\u52a8\u3002\u9ed8\u8ba4200\u3002\u975e\u5fc5\u987b ;umask=022 ; process file creation umask; default 022 user=op ; \u4ee5root\u542f\u52a8supervisord\u540e\u3002\u8fd9\u4e2a\u7528\u6237\u4e5f\u53ef\u4ee5\u5bf9supervisord\u8fdb\u884c\u7ba1\u7406\u3002\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e\u3002\u975e\u5fc5\u987b ;identifier=supervisor ; supervisord\u7684\u6807\u8bc6\u7b26\uff0c\u7ed9XML_RPC\u7528\u7684\u3002\u5f53\u6709\u591a\u4e2asupervisor\u7684\u65f6\u5019\uff0c\u4e14\u60f3\u7528XML_RPC\u7edf\u4e00\u7ba1\u7406\uff0c\u9700\u8981\u4e3a\u6bcf\u4e2asupervisor\u8bbe\u7f6e\u4e0d\u540c\u7684\u6807\u8bc6\u7b26\u3002\u9ed8\u8ba4\u662fsupervisord\u3002\u975e\u5fc5\u987b ;directory=/tmp ; default is not to cd during start ;nocleanup=true ; don't clean up tempfiles at start; default false ;childlogdir=/tmp ; \u5f53\u5b50\u8fdb\u7a0b\u65e5\u5fd7\u8def\u5f84\u4e3aAUTO\u7684\u65f6\u5019\uff0c\u5b50\u8fdb\u7a0b\u65e5\u5fd7\u6587\u4ef6\u7684\u5b58\u653e\u8def\u5f84(python -c import tempfile;print tempfile.gettempdir() ) ;environment=KEY= value ; supervisord\u5728\u542f\u52a8\u65f6\uff0c\u9ed8\u8ba4\u7ee7\u627flinux\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5728\u8fd9\u91cc\u53ef\u4ee5\u8bbe\u7f6esupervisord\u8fdb\u7a0b\u7279\u6709\u7684\u5176\u4ed6\u73af\u5883\u53d8\u91cf\u3002supervisord\u542f\u52a8\u5b50\u8fdb\u7a0b\u65f6\uff0c\u5b50\u8fdb\u7a0b\u4f1a\u62f7\u8d1d\u7236\u8fdb\u7a0b\u7684\u5185\u5b58\u7a7a\u95f4\u5185\u5bb9\u3002 \u6240\u4ee5\u8bbe\u7f6e\u7684\u8fd9\u4e9b\u73af\u5883\u53d8\u91cf\u4e5f\u4f1a\u88ab\u5b50\u8fdb\u7a0b\u7ee7\u627f\u3002\u4f8b\uff1aenvironment=name= haha ,age= hehe ;strip_ansi=false ; \u6e05\u9664\u5b50\u8fdb\u7a0b\u65e5\u5fd7\u4e2d\u7684\u6240\u6709ANSI\u5e8f\u5217\uff08\u4f8b\u5982\\n,\\t\uff09 [rpcinterface:supervisor] ; \u7ed9XML_RPC\u7528\u7684\uff0c\u5982\u679c\u60f3\u4f7f\u7528supervisord\u6216\u8005web server\uff0c\u8be5\u9009\u9879\u5fc5\u987b\u8981\u5f00\u542f supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface [supervisorctl] serverurl=unix:///tmp/supervisor.sock ; supervisorctl\u672c\u5730\u8fde\u63a5supervisord\u65f6\uff0c\u672c\u5730UNIX socket\u8def\u5f84\uff0c\u548c\u524d\u9762\u7684[unix_http_server]\u5bf9\u5e94\u7684\uff0c\u9ed8\u8ba4\u503c\u5c31\u662funix:///tmp/supervisor.sock\uff0c\u975e\u5fc5\u987b ;serverurl=http://127.0.0.1:9001 ; supervisorctl\u8fdc\u7a0b\u8fde\u63a5supervisord\u7684\u65f6\u5019\uff0c\u7528\u5230\u7684TCP socket\u8def\u5f84\uff0c\u6ce8\u610f\u8fd9\u548c\u524d\u9762\u7684[inet_http_server]\u5bf9\u5e94\uff0c\u975e\u5fc5\u987b ;username=chris ; should be same as in [*_http_server] if set ;password=123 ; should be same as in [*_http_server] if set ;prompt=mysupervisor ; \u8f93\u5165\u7528\u6237\u540d\u5bc6\u7801\u65f6\u5019\u7684\u63d0\u793a\u7b26 ;history_file=~/.sc_history ; \u548cshell\u4e2dhistory\u7c7b\u4f3c\uff0c\u53ef\u7528\u4e0a\u4e0b\u952e\u6765\u67e5\u627e\u524d\u9762\u6267\u884c\u8fc7\u7684\u547d\u4ee4\uff0c\u9ed8\u8ba4\u662fno file\u3002\u975e\u5fc5\u987b ;[program:theprogramname] ; \u8981\u7ba1\u7406\u7684\u5b50\u8fdb\u7a0b\uff0c : \u540e\u9762\u7684\u662f\u540d\u5b57\uff0cprogram\u53ef\u4ee5\u8bbe\u7f6e\u591a\u4e2a\uff0c\u4e00\u4e2aprogram\u5c31\u662f\u8981\u88ab\u7ba1\u7406\u7684\u4e00\u4e2a\u8fdb\u7a0b ;command=/bin/cat ; \u8981\u542f\u52a8\u8fdb\u7a0b\u7684\u547d\u4ee4\u8def\u5f84\uff0c\u53ef\u5e26\u53c2\u6570\uff0c\u4f8b\u5b50\uff1a/home/test.py -a 'hehe'\u3002\u6ce8\u610f\uff1acommand\u4e0d\u80fd\u662f\u5b88\u62a4\u8fdb\u7a0b\u3002\u5fc5\u987b\u9879 ;process_name=%(program_name)s ; \u8fdb\u7a0b\u540d\uff0c\u5982\u679c\u4e0b\u9762\u7684numprocs=1\u7684\u8bdd\uff0c\u5c31\u4e0d\u7528\u7ba1\u3002\u9ed8\u8ba4\u503c%(program_name)s\uff0c\u4e5f\u5c31\u662f\u4e0a\u9762\u7684\u90a3\u4e2aprogram\u5192\u53f7\u540e\u9762\u7684\u540d\u5b57\uff0c\u4f46\u5982\u679cnumprocs\u4e3a\u591a\u4e2a\u65f6\uff0c\u9700\u8981\u914d\u7f6e\u3002 ;numprocs=1 ; \u542f\u52a8\u8fdb\u7a0b\u6570\u3002\u5f53\u4e0d\u4e3a1\u65f6\uff0c\u5c31\u662f\u8fdb\u7a0b\u6c60\u3002\u6ce8\u610fprocess_name\u7684\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u4e3a1\u3002\u975e\u5fc5\u987b ;directory=/tmp ; \u8fdb\u7a0b\u8fd0\u884c\u524d\uff0c\u4f1a\u524d\u5207\u6362\u5230\u8be5\u76ee\u5f55 ;umask=022 ; umask for process (default None) ;priority=999 ; \u5b50\u8fdb\u7a0b\u542f\u52a8\u5173\u95ed\u4f18\u5148\u7ea7\uff0c\u4f18\u5148\u7ea7\u4f4e\u7684\uff0c\u6700\u5148\u542f\u52a8\uff0c\u6700\u540e\u5173\u95ed ;autostart=true ; start at supervisord start (default: true) ;startsecs=1 ; \u5b50\u8fdb\u7a0b\u542f\u52a8\u591a\u5c11\u79d2\u4e4b\u540e\uff0c\u72b6\u6001\u5982\u679c\u662frunning\uff0c\u5219\u8ba4\u4e3a\u542f\u52a8\u6210\u529f ;startretries=3 ; \u5f53\u8fdb\u7a0b\u542f\u52a8\u5931\u8d25\u540e\uff0c\u6700\u5927\u5c1d\u8bd5\u542f\u52a8\u7684\u6b21\u6570\uff0c\u5f53\u8d85\u8fc7\u540e\uff0csupervisor\u628a\u6b64\u8fdb\u7a0b\u7684\u72b6\u6001\u7f6e\u4e3aFAIL ;autorestart=unexpected ; \u8bbe\u7f6e\u5b50\u8fdb\u7a0b\u6302\u6389\u540e\u81ea\u52a8\u91cd\u542f\u7684\u60c5\u51b5\uff0c\u6709\u4e09\u4e2a\u9009\u9879\uff1afalse,unexpected\u548ctrue ; false\uff0c\u65e0\u8bba\u4ec0\u4e48\u60c5\u51b5\u4e0b\uff0c\u90fd\u4e0d\u4f1a\u88ab\u91cd\u65b0\u542f\u52a8 ; unexpected\uff0c\u5f53\u8fdb\u7a0b\u7684\u9000\u51fa\u7801\u4e0d\u5728exitcodes\u91cc\u9762\u5b9a\u4e49\u65f6\uff0c\u624d\u4f1a\u88ab\u81ea\u52a8\u91cd\u542f ; true\uff0c\u53ea\u8981\u5b50\u8fdb\u7a0b\u6302\u6389\uff0c\u5c06\u4f1a\u88ab\u65e0\u6761\u4ef6\u7684\u91cd\u542f ;exitcodes=0,2 ; 'expected' exit codes used with autorestart (default 0,2) ;stopsignal=QUIT ; \u8fdb\u7a0b\u505c\u6b62\u4fe1\u53f7\uff0c\u53ef\u4ee5\u4e3aTERM, HUP, INT, QUIT, KILL, USR1, or USR2\u7b49\u4fe1\u53f7 ;stopwaitsecs=10 ; \u5411\u5b50\u8fdb\u7a0b\u53d1\u9001stopsignal\u4fe1\u53f7\u540e\uff0c\u5230\u7cfb\u7edf\u8fd4\u56de\u4fe1\u606f\uff0c\u6240\u7b49\u5f85\u7684\u6700\u5927\u65f6\u95f4\u3002\u8d85\u8fc7\u8fd9\u4e2a\u65f6\u95f4\uff0c\u4f1a\u5411\u8be5\u5b50\u8fdb\u7a0b\u53d1\u9001\u4e00\u4e2a\u5f3a\u5236kill\u7684\u4fe1\u53f7 ;stopasgroup=false ; \u7528\u4e8e\u7ba1\u7406\u7684\u5b50\u8fdb\u7a0b\u672c\u8eab\u8fd8\u6709\u5b50\u8fdb\u7a0b\u3002\u5982\u679c\u4ec5\u4ec5\u5e72\u6389\u5b50\u8fdb\u7a0b\u7684\u8bdd\uff0c\u5b50\u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b\u6709\u53ef\u80fd\u53d8\u6210\u5b64\u513f\u8fdb\u7a0b\u3002\u8be5\u9009\u9879true\u65f6\uff0c\u628a\u8be5\u5b50\u8fdb\u7a0b\u7684\u6574\u4e2a\u8fdb\u7a0b\u7ec4\u90fd\u5e72\u6389\u3002\u6ce8\u610f\uff0c\u8be5\u9009\u9879\u53d1\u9001\u7684\u662fstop\u4fe1\u53f7\uff0c\u9ed8\u8ba4false\u3002\u975e\u5fc5\u987b ;killasgroup=false ; \u548cstopasgroup\u7c7b\u4f3c\uff0c\u53d1\u9001\u7684\u662fkill\u4fe1\u53f7 ;user=chrism ; setuid to this UNIX account to run the program ;redirect_stderr=true ; true\u65f6\uff0cstderr\u65e5\u5fd7\u88ab\u5199\u5165stdout\u65e5\u5fd7\u6587\u4ef6\u4e2d\u3002\u9ed8\u8ba4\u4e3afalse\uff0c\u975e\u5fc5\u987b ;stdout_logfile=/a/path ; \u5b50\u8fdb\u7a0b\u7684stdout\u7684\u65e5\u5fd7\u8def\u5f84\uff0c\u53ef\u4ee5\u6307\u5b9a\u8def\u5f84\uff0cAUTO\uff0cnone\u4e09\u4e2a\u9009\u9879 ; AUTO\u65f6\uff0c\u968f\u673a\u627e\u4e00\u4e2a\u5730\u65b9\u751f\u6210\u65e5\u5fd7\uff0c\u800c\u5f53supervisord\u91cd\u65b0\u542f\u52a8\u65f6\uff0c\u4ee5\u524d\u65e5\u5fd7\u4f1a\u6e05\u7a7a ;stdout_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stdout_logfile_backups=10 ; # of stdout logfile backups (0 means none, default 10) ;stdout_capture_maxbytes=1MB ; \u8bbe\u5b9acapture\u7ba1\u9053\u7684\u5927\u5c0f\uff0c\u5f53\u503c\u4e0d\u4e3a0\u7684\u65f6\u5019\uff0c\u5b50\u8fdb\u7a0b\u53ef\u4ee5\u4ecestdout\u53d1\u9001\u4fe1\u606f\uff0c\u800csupervisor\u53ef\u4ee5\u6839\u636e\u4fe1\u606f\uff0c\u53d1\u9001\u76f8\u5e94\u7684event\u3002\u9ed8\u8ba4\u4e3a0\uff0c\u8868\u8fbe\u5173\u95ed\u7ba1\u9053\u3002\u975e\u5fc5\u987b ;stdout_events_enabled=false ; \u4e3ature\u65f6\uff0c\u5f53\u5b50\u8fdb\u7a0b\u7531stdout\u5411\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e2d\u5199\u65e5\u5fd7\u65f6\uff0c\u5c06\u89e6\u53d1supervisord\u53d1\u9001PROCESS_LOG_STDOUT\u7c7b\u578b\u7684event\u3002\u8ba4\u4e3afalse\u3002\u975e\u5fc5\u987b ;stderr_logfile=/a/path ; stderr log path, NONE for none; default AUTO ;stderr_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stderr_logfile_backups=10 ; # of stderr logfile backups (0 means none, default 10) ;stderr_capture_maxbytes=1MB ; number of bytes in 'capturemode' (default 0) ;stderr_events_enabled=false ; emit events on stderr writes (default false) ;environment=A= 1 ,B= 2 ; \u8be5\u5b50\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\uff0c\u548c\u522b\u7684\u5b50\u8fdb\u7a0b\u662f\u4e0d\u5171\u4eab ;serverurl=AUTO ; override serverurl computation (childutils) ;[eventlistener:theeventlistenername] ; \u8ba2\u9605supervisord\u53d1\u9001\u7684event\u3002\u53ef\u5728listener\u91cc\u9762\u505a\u4e00\u7cfb\u5217\u5904\u7406\uff0c\u6bd4\u5982\u62a5\u8b66\u7b49 ;command=/bin/eventlistener ; the program (relative uses PATH, can take args) ;process_name=%(program_name)s ; process_name expr (default %(program_name)s) ;numprocs=1 ; number of processes copies to start (def 1) ;events=EVENT ; \u4e8b\u4ef6\u7684\u7c7b\u578b\uff0c\u53ea\u6709\u8be5\u4e8b\u4ef6\u7c7b\u578b\u3002\u624d\u4f1a\u88ab\u53d1\u9001(req'd) ;buffer_size=10 ; event\u961f\u5217\u7f13\u5b58\u5927\u5c0f (default 10) ;directory=/tmp ; directory to cwd to before exec (def no cwd) ;umask=022 ; umask for process (default None) ;priority=-1 ; the relative start priority (default -1) ;autostart=true ; start at supervisord start (default: true) ;startsecs=1 ; # of secs prog must stay up to be running (def. 1) ;startretries=3 ; max # of serial start failures when starting (default 3) ;autorestart=unexpected ; autorestart if exited after running (def: unexpected) ;exitcodes=0,2 ; 'expected' exit codes used with autorestart (default 0,2) ;stopsignal=QUIT ; signal used to kill process (default TERM) ;stopwaitsecs=10 ; max num secs to wait b4 SIGKILL (default 10) ;stopasgroup=false ; send stop signal to the UNIX process group (default false) ;killasgroup=false ; SIGKILL the UNIX process group (def false) ;user=chrism ; setuid to this UNIX account to run the program ;redirect_stderr=false ; redirect_stderr=true is not allowed for eventlisteners ;stdout_logfile=/a/path ; stdout log path, NONE for none; default AUTO ;stdout_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stdout_logfile_backups=10 ; # of stdout logfile backups (0 means none, default 10) ;stdout_events_enabled=false ; emit events on stdout writes (default false) ;stderr_logfile=/a/path ; stderr log path, NONE for none; default AUTO ;stderr_logfile_maxbytes=1MB ; max # logfile bytes b4 rotation (default 50MB) ;stderr_logfile_backups=10 ; # of stderr logfile backups (0 means none, default 10) ;stderr_events_enabled=false ; emit events on stderr writes (default false) ;environment=A= 1 ,B= 2 ; process environment additions ;serverurl=AUTO ; override serverurl computation (childutils) ;[group:thegroupname] ; \u7ed9programs\u5206\u7ec4\uff0c\u5212\u5206\u5230\u7ec4\u91cc\u9762\u7684program\u3002\u53ef\u4ee5\u5bf9\u7ec4\u540d\u8fdb\u884c\u7edf\u4e00\u7684\u64cd\u4f5c\u3002\u6ce8\u610f\uff1aprogram\u88ab\u5212\u5206\u5230\u7ec4\u91cc\u9762\u4e4b\u540e\uff0c\u76f8\u5f53\u4e8e\u539f\u6765\u7684\u914d\u7f6e\u5931\u6548\u3002supervisor\u53ea\u5bf9\u7ec4\u8fdb\u884c\u7ba1\u7406\uff0c\u800c\u4e0d\u518d\u5bf9\u7ec4\u91cc\u9762\u7684\u5355\u4e2aprogram\u8fdb\u884c\u7ba1\u7406 ;programs=progname1,progname2 ; each refers to 'x' in [program:x] definitions ;priority=999 ; the relative start priority (default 999) ; The [include] section can just contain the files setting. This ; setting can list multiple files (separated by whitespace or ; newlines). It can also contain wildcards. The filenames are ; interpreted as relative to this file. Included files *cannot* ; include files themselves. ;[include] ; \u5f53\u6211\u4eec\u8981\u7ba1\u7406\u7684\u8fdb\u7a0b\u5f88\u591a\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u628a\u914d\u7f6e\u4fe1\u606f\u5199\u5230\u591a\u4e2a\u6587\u4ef6\u4e2d\uff0c\u7136\u540einclude\u8fc7\u6765 ;files = relative/directory/*.ini","title":"supervisord.conf\u914d\u7f6e\u8be6\u89e3"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/py\u5e93/spiff_workflow/","text":"SpiffWorkflow \u5de5\u4f5c\u6d41\u5f15\u64ce \u7279\u6027 \u9075\u5faa\u7f16\u5236BPMN\u89c4\u8303 \u63d0\u4f9bPy API \u5f00\u6e90\u6388\u6743\uff1aLGPL-3.0 \u5b89\u88c5 pip install SpiffWorkflow \u5b9a\u4e49\u4e00\u4e2a\u5de5\u4f5c\u6d41 Task\u7684\u72b6\u6001\u6d41\u8f6c MAYBE: Task\u5728\u672a\u6765\u53ef\u80fd\u6267\u884c\uff0c\u53d6\u51b3\u4e8e\u67d0\u4e2aExclusiveChoice Task\u7684\u8f93\u51fa\u7ed3\u679c LIKELY: \u7c7b\u4f3cMAYBE\uff0c\u662fExclusiveChoice Task\u7684\u9ed8\u8ba4\u9009\u62e9 FUTURE: \u8be5Task\u786e\u5b9a\u5728\u67d0\u4e2a\u70b9\u4f1a\u8fd0\u884c\uff08\u9664\u975e\u8be5\u5b9e\u4f8b\u5728Task\u6267\u884c\u524d\uff0c\u88ab\u660e\u786eCANCELLED\u4e86\uff09 WAITING: (\u53ef\u9009\u7684)Task\u5728\u6267\u884c\u4e2d\uff0c\u8fd8\u672a\u5b8c\u6210\uff1b\u5b8c\u6210\u540e\u8f6c\u4e3aREADY READY: \u5f53\u524dTask\u7684\u524d\u63d0\u6761\u4ef6\u5df2\u7ecf\u5168\u90e8\u6ee1\u8db3\uff0c\u51c6\u5907\u6267\u884c COMPLETED: Task\u6267\u884c\u5b8c\u6210 CANCELLED: Task\u88ab\u660e\u786e\u53d6\u6d88 \u5de5\u4f5c\u6d41\u7684\u6570\u636e\u5b58\u50a8 TaskSpec\u5bf9\u8c61 : \u5b58\u6d41\u7a0b\u89c4\u5219\uff0c\u5982\u679c\u53d8\u5316\uff0c\u5219\u5f71\u54cd\u6240\u6709\u6d41\u7a0b\u5b9e\u4f8b Task\u5bf9\u8c61 : \u6d41\u7a0b\u4e2d\u6bcf\u4e2aTask\u8282\u70b9\u7684\u6570\u636e","title":"SpiffWorkflow \u5de5\u4f5c\u6d41\u5f15\u64ce"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/py\u5e93/spiff_workflow/#spiffworkflow","text":"","title":"SpiffWorkflow \u5de5\u4f5c\u6d41\u5f15\u64ce"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/py\u5e93/spiff_workflow/#_1","text":"\u9075\u5faa\u7f16\u5236BPMN\u89c4\u8303 \u63d0\u4f9bPy API \u5f00\u6e90\u6388\u6743\uff1aLGPL-3.0","title":"\u7279\u6027"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/py\u5e93/spiff_workflow/#_2","text":"pip install SpiffWorkflow","title":"\u5b89\u88c5"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/py\u5e93/spiff_workflow/#_3","text":"","title":"\u5b9a\u4e49\u4e00\u4e2a\u5de5\u4f5c\u6d41"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/py\u5e93/spiff_workflow/#task","text":"MAYBE: Task\u5728\u672a\u6765\u53ef\u80fd\u6267\u884c\uff0c\u53d6\u51b3\u4e8e\u67d0\u4e2aExclusiveChoice Task\u7684\u8f93\u51fa\u7ed3\u679c LIKELY: \u7c7b\u4f3cMAYBE\uff0c\u662fExclusiveChoice Task\u7684\u9ed8\u8ba4\u9009\u62e9 FUTURE: \u8be5Task\u786e\u5b9a\u5728\u67d0\u4e2a\u70b9\u4f1a\u8fd0\u884c\uff08\u9664\u975e\u8be5\u5b9e\u4f8b\u5728Task\u6267\u884c\u524d\uff0c\u88ab\u660e\u786eCANCELLED\u4e86\uff09 WAITING: (\u53ef\u9009\u7684)Task\u5728\u6267\u884c\u4e2d\uff0c\u8fd8\u672a\u5b8c\u6210\uff1b\u5b8c\u6210\u540e\u8f6c\u4e3aREADY READY: \u5f53\u524dTask\u7684\u524d\u63d0\u6761\u4ef6\u5df2\u7ecf\u5168\u90e8\u6ee1\u8db3\uff0c\u51c6\u5907\u6267\u884c COMPLETED: Task\u6267\u884c\u5b8c\u6210 CANCELLED: Task\u88ab\u660e\u786e\u53d6\u6d88","title":"Task\u7684\u72b6\u6001\u6d41\u8f6c"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/py\u5e93/spiff_workflow/#_4","text":"TaskSpec\u5bf9\u8c61 : \u5b58\u6d41\u7a0b\u89c4\u5219\uff0c\u5982\u679c\u53d8\u5316\uff0c\u5219\u5f71\u54cd\u6240\u6709\u6d41\u7a0b\u5b9e\u4f8b Task\u5bf9\u8c61 : \u6d41\u7a0b\u4e2d\u6bcf\u4e2aTask\u8282\u70b9\u7684\u6570\u636e","title":"\u5de5\u4f5c\u6d41\u7684\u6570\u636e\u5b58\u50a8"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/nginx/","text":"Nginx \u53cd\u5411\u4ee3\u7406Web\u670d\u52a1\u5668 \u5e38\u7528\u914d\u7f6e\u8bf4\u660e","title":"Nginx \u53cd\u5411\u4ee3\u7406Web\u670d\u52a1\u5668"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/nginx/#nginx-web","text":"","title":"Nginx \u53cd\u5411\u4ee3\u7406Web\u670d\u52a1\u5668"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/nginx/#_1","text":"","title":"\u5e38\u7528\u914d\u7f6e\u8bf4\u660e"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/rabbitmq/","text":"RabbitMQ\u6d88\u606f\u4e2d\u95f4\u4ef6 \u5e38\u7528cli \u67e5\u8be2 rabbitmqctl status \u5f53\u524d\u8282\u70b9\u72b6\u6001 rabbitmqctl cluster_status \u96c6\u7fa4\u72b6\u6001 \u53d8\u66f4\u64cd\u4f5c","title":"RabbitMQ\u6d88\u606f\u4e2d\u95f4\u4ef6"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/rabbitmq/#rabbitmq","text":"","title":"RabbitMQ\u6d88\u606f\u4e2d\u95f4\u4ef6"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/rabbitmq/#cli","text":"","title":"\u5e38\u7528cli"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/rabbitmq/#_1","text":"rabbitmqctl status \u5f53\u524d\u8282\u70b9\u72b6\u6001 rabbitmqctl cluster_status \u96c6\u7fa4\u72b6\u6001","title":"\u67e5\u8be2"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/rabbitmq/#_2","text":"","title":"\u53d8\u66f4\u64cd\u4f5c"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/rocketmq/","text":"RocketMQ \u5206\u5e03\u5f0fMQ\u548c\u6d41\u5e73\u53f0 \u7b80\u4ecb \u5f00\u6e90\uff0cApache2.0 Pull\u6a21\u5f0f \u4f4e\u5ef6\u65f6\uff0c\u4ebf\u7ea7 \u9ad8\u53ef\u9760\uff0c\u78c1\u76d8\u6570\u636e\u56fa\u5316 \u6613\u6269\u5bb9 \u652f\u6301Scheduled \u652f\u6301\u5e7f\u64ad \u652f\u6301\u6761\u4ef6\u8fc7\u6ee4 \u5b89\u88c5\uff08docker\u7248\uff09 \u5b89\u88c5\u9700\u6c42 \uff1a 64\u4f4d\uff0c\u7c7bUnix\u7cfb\u7edf JDK 1.8\u4ee5\u4e0a Broker\u8282\u70b9\u9700\u89814G\u4ee5\u4e0a\u786c\u76d8 git clone https://github.com/apache/rocketmq-externals.git cd rocketmq-externals/rocketmq-docker/4.4.0 ./play-docker.sh # \u7f16\u8bd1\u5e76\u542f\u52a8\u955c\u50cf\uff0c\u975e\u5e38\u7b80\u5355\u4eba\u6027\u5316 # \u6d4b\u8bd5\u751f\u4ea7\u8005 docker exec -ti rmqbroker sh ./tools.sh org.apache.rocketmq.example.quickstart.Producer # \u6d4b\u8bd5\u6d88\u8d39 docker exec -ti rmqbroker sh ./tools.sh org.apache.rocketmq.example.quickstart.Consumer \u542f\u52a8\u53c2\u6570 \uff1a -e \"MAX_POSSIBLE_HEAP=100000000\" \u6307\u5b9ajvm\u5185\u5b58heap \u8fd0\u884c\u6548\u679c: \u4f18\u96c5\u5173\u673a \uff1a docker exec -ti rmqbroker sh ./mqshutdown broker \u5148\u5173broker The mqbroker(28) is running... Send shutdown request to mqbroker(28) OK docker exec -ti rmqnamesrv sh ./mqshutdown namesrv \u518d\u5173namesrv The mqnamesrv(27) is running... Send shutdown request to mqnamesrv(27) OK \u6838\u5fc3 \u67b6\u6784\u56fe \u4f7f\u7528\uff08CLI\uff09 \u7528\u6cd5\uff1a bin/mqadmin \u547d\u4ee4 \u53c2\u6570 \u547d\u4ee4\u5982\u4e0b\uff1a updateTopic Update or create topic deleteTopic Delete topic from broker and NameServer. updateSubGroup Update or create subscription group deleteSubGroup Delete subscription group from broker. updateBrokerConfig Update broker's config updateTopicPerm Update topic perm topicRoute Examine topic route info topicStatus Examine topic Status info topicClusterList get cluster info for topic brokerStatus Fetch broker runtime status data queryMsgById Query Message by Id queryMsgByKey Query Message by Key queryMsgByUniqueKey Query Message by Unique key queryMsgByOffset Query Message by offset printMsg Print Message Detail printMsgByQueue Print Message Detail sendMsgStatus send msg to broker. brokerConsumeStats Fetch broker consume stats data producerConnection Query producer's socket connection and client version consumerConnection Query consumer's socket connection, client version and subscription consumerProgress Query consumers's progress, speed consumerStatus Query consumer's internal data structure cloneGroupOffset clone offset from other group. clusterList List all of clusters topicList Fetch all topic list from name server updateKvConfig Create or update KV config. deleteKvConfig Delete KV config. wipeWritePerm Wipe write perm of broker in all name server resetOffsetByTime Reset consumer offset by timestamp(without client restart). updateOrderConf Create or update or delete order conf cleanExpiredCQ Clean expired ConsumeQueue on broker. cleanUnusedTopic Clean unused topic on broker. startMonitoring Start Monitoring statsAll Topic and Consumer tps stats allocateMQ Allocate MQ checkMsgSendRT check message send response time clusterRT List All clusters Message Send RT getNamesrvConfig Get configs of name server. updateNamesrvConfig Update configs of name server. getBrokerConfig Get broker config by cluster or special broker! queryCq Query cq command. sendMessage Send a message consumeMessage Consume message \u53c2\u8003 \u5b98\u7f51 github\u6e90\u7801 \u5b98\u65b9docker \u5b98\u65b9Python\u5ba2\u6237\u7aef","title":"RocketMQ \u5206\u5e03\u5f0fMQ\u548c\u6d41\u5e73\u53f0"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/rocketmq/#rocketmq-mq","text":"","title":"RocketMQ \u5206\u5e03\u5f0fMQ\u548c\u6d41\u5e73\u53f0"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/rocketmq/#_1","text":"\u5f00\u6e90\uff0cApache2.0 Pull\u6a21\u5f0f \u4f4e\u5ef6\u65f6\uff0c\u4ebf\u7ea7 \u9ad8\u53ef\u9760\uff0c\u78c1\u76d8\u6570\u636e\u56fa\u5316 \u6613\u6269\u5bb9 \u652f\u6301Scheduled \u652f\u6301\u5e7f\u64ad \u652f\u6301\u6761\u4ef6\u8fc7\u6ee4","title":"\u7b80\u4ecb"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/rocketmq/#docker","text":"\u5b89\u88c5\u9700\u6c42 \uff1a 64\u4f4d\uff0c\u7c7bUnix\u7cfb\u7edf JDK 1.8\u4ee5\u4e0a Broker\u8282\u70b9\u9700\u89814G\u4ee5\u4e0a\u786c\u76d8 git clone https://github.com/apache/rocketmq-externals.git cd rocketmq-externals/rocketmq-docker/4.4.0 ./play-docker.sh # \u7f16\u8bd1\u5e76\u542f\u52a8\u955c\u50cf\uff0c\u975e\u5e38\u7b80\u5355\u4eba\u6027\u5316 # \u6d4b\u8bd5\u751f\u4ea7\u8005 docker exec -ti rmqbroker sh ./tools.sh org.apache.rocketmq.example.quickstart.Producer # \u6d4b\u8bd5\u6d88\u8d39 docker exec -ti rmqbroker sh ./tools.sh org.apache.rocketmq.example.quickstart.Consumer \u542f\u52a8\u53c2\u6570 \uff1a -e \"MAX_POSSIBLE_HEAP=100000000\" \u6307\u5b9ajvm\u5185\u5b58heap \u8fd0\u884c\u6548\u679c: \u4f18\u96c5\u5173\u673a \uff1a docker exec -ti rmqbroker sh ./mqshutdown broker \u5148\u5173broker The mqbroker(28) is running... Send shutdown request to mqbroker(28) OK docker exec -ti rmqnamesrv sh ./mqshutdown namesrv \u518d\u5173namesrv The mqnamesrv(27) is running... Send shutdown request to mqnamesrv(27) OK","title":"\u5b89\u88c5\uff08docker\u7248\uff09"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/rocketmq/#_2","text":"","title":"\u6838\u5fc3"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/rocketmq/#_3","text":"","title":"\u67b6\u6784\u56fe"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/rocketmq/#cli","text":"\u7528\u6cd5\uff1a bin/mqadmin \u547d\u4ee4 \u53c2\u6570 \u547d\u4ee4\u5982\u4e0b\uff1a updateTopic Update or create topic deleteTopic Delete topic from broker and NameServer. updateSubGroup Update or create subscription group deleteSubGroup Delete subscription group from broker. updateBrokerConfig Update broker's config updateTopicPerm Update topic perm topicRoute Examine topic route info topicStatus Examine topic Status info topicClusterList get cluster info for topic brokerStatus Fetch broker runtime status data queryMsgById Query Message by Id queryMsgByKey Query Message by Key queryMsgByUniqueKey Query Message by Unique key queryMsgByOffset Query Message by offset printMsg Print Message Detail printMsgByQueue Print Message Detail sendMsgStatus send msg to broker. brokerConsumeStats Fetch broker consume stats data producerConnection Query producer's socket connection and client version consumerConnection Query consumer's socket connection, client version and subscription consumerProgress Query consumers's progress, speed consumerStatus Query consumer's internal data structure cloneGroupOffset clone offset from other group. clusterList List all of clusters topicList Fetch all topic list from name server updateKvConfig Create or update KV config. deleteKvConfig Delete KV config. wipeWritePerm Wipe write perm of broker in all name server resetOffsetByTime Reset consumer offset by timestamp(without client restart). updateOrderConf Create or update or delete order conf cleanExpiredCQ Clean expired ConsumeQueue on broker. cleanUnusedTopic Clean unused topic on broker. startMonitoring Start Monitoring statsAll Topic and Consumer tps stats allocateMQ Allocate MQ checkMsgSendRT check message send response time clusterRT List All clusters Message Send RT getNamesrvConfig Get configs of name server. updateNamesrvConfig Update configs of name server. getBrokerConfig Get broker config by cluster or special broker! queryCq Query cq command. sendMessage Send a message consumeMessage Consume message","title":"\u4f7f\u7528\uff08CLI\uff09"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u4e2d\u95f4\u4ef6/rocketmq/#_4","text":"\u5b98\u7f51 github\u6e90\u7801 \u5b98\u65b9docker \u5b98\u65b9Python\u5ba2\u6237\u7aef","title":"\u53c2\u8003"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u5927\u6570\u636e/cdh_install/","text":"Cloudera Distribution Hadoop\uff08CDH\uff09\u5b89\u88c5\u6559\u7a0b \u57fa\u4e8e6.1.1\u7248\u672c\uff0c\u5c0f\u578b\u96c6\u7fa4\uff0820\u4e2a\u8282\u70b9\uff09 \u53c2\u8003 \u5b98\u65b9\u624b\u518c\uff1a https://www.cloudera.com/documentation/enterprise/6/6.1/topics/installation.html \u73af\u5883\u8981\u6c42 \u786c\u4ef6 \u5b58\u50a8 /usr 1GB /var 200GB /opt 15GB / 100 GB \u6302\u8f7d\u786c\u76d8\u5206\u533a 12 * 8TB\uff08\u5355\u4e2aDN 100TB\uff0c\u5355\u5206\u533a 8TB\uff09 \u6587\u4ef6\u683c\u5f0f ext3, ext4 CPU 4Core\uff0c\u5efa\u8bae 16Core\u4ee5\u4e0a \u5185\u5b58 32GB\uff0c\u5efa\u8bae 60GB\u4ee5\u4e0a \u8f6f\u4ef6 OS CentOS 7.2~7.6; Ubuntu 16.04 /etc/fstab\u7981\u7528atime\uff0c\u5982 /dev/sdb1 /data1 ext4 defaults,noatime 0 \u91cd\u542f\u81ea\u52a8\u6302\u8f7d mount -o remount /data1 /etc/security/limits.d/20-nproc.conf\u653e\u5927 * soft nproc 655350 /etc/hosts\u652f\u6301\u591a\u57df\u540d\uff0c\u5c0f\u5199\uff0c\u5982 192.168.1.1 cluster-01 \u5173\u95edSELinux \u5173\u95ed\u9632\u706b\u5899\uff0c\u5982iptables /etc/sysconfig/network\u7ed1\u5b9ahostname\uff0c\u5982 HOSTNAME=cluster-01 DB MySQL 5.7; PostgreSQL 9.4+; Oracle 12.2 JDK 1.8u31+ \u5806\u5185\u5b58 20GB \uff08HDFS|YARN\uff1a200\u4e3b\u673a\uff0c4000\u5b9e\u4f8b\uff1bHBase|Kafka\uff1a100\u4e3b\u673a\uff0c3w\u5b9e\u4f8b\uff09 \u975e\u5806\u5185\u5b58 12GB Python 2.7 python-psycopg2 iproute-3.10 \u5b89\u88c5 \u4e3b\u673a\u9884\u521d\u59cb\u5316 # yum\u5b89\u88c5 yum -y install epel-release yum -y install vim unzip zip lrzsz tmux httpd zabbix-agent # py\u5b89\u88c5\uff0c\u955c\u50cf\u52a0\u901f easy_install -i https://pypi.tuna.tsinghua.edu.cn/simple pip #################### # \u7ed1\u5b9ahostname hostname {\u6309\u5b9e\u9645\u66ff\u6362\u4e3a\u5185\u90e8hostname} export hname=$(hostname) export ip=$(ifconfig | grep inet | grep -v '127.0.0.1' | awk '{print $2}') echo $ip $hname /etc/hosts sed -i s/^HOSTNAME.*$/HOSTNAME=$hname/g /etc/sysconfig/network echo -e `hostname` # \u4fee\u6539/etc/hosts\uff0c\u52a0\u5165\u96c6\u7fa4\u76f8\u5173ip\u548c\u5bf9\u5e94\u5185\u90e8\u57df\u540d \u7565 # ulimit # ulimit -HSn 65535 # echo ulimit -HSn 65535 /etc/rc.local # \u9002\u7528centos7 sed -i s/4096/65535/g /etc/security/limits.d/20-nproc.conf # \u7edf\u4e00\u65f6\u533a\uff1a\u4e1c8\u533a (date -R) # ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime # ntp\u65f6\u949f echo */10 * * * * /usr/sbin/ntpdate -u {\u4f60\u7684ntp\u670d\u52a1\u5730\u5740} /dev/null 2 1 /var/spool/cron/root # \u5b89\u88c5\u76d1\u63a7 # \u5173\u95ed\u9632\u706b\u5899 systemctl stop firewalld.service systemctl disable firewalld.service # \u4fee\u6539/etc/selinux/config\uff0c\u5173\u95edSELinux\uff08SELINUX=disabled\uff09\u7565 # yum install -y zabbix-agent sed -i 's!Server=.*!Server={\u4f60\u7684zabbix\u670d\u52a1ip}!' /usr/local/zabbix/etc/zabbix_agentd.conf sed -i 's!ServerActive=.*!ServerActive={\u4f60\u7684zabbix\u670d\u52a1ip}!' /usr/local/zabbix/etc/zabbix_agentd.conf service zabbix_agentd restart # \u4e0azabbix\u5e73\u53f0\uff0c\u786e\u8ba4\u4e3b\u673a\u81ea\u52a8\u53d1\u73b0 # \u8bbe\u7f6eswap\uff08/proc/sys/vm/swappiness \u9ed8\u8ba460 = 10\uff09\u4e3a\u79ef\u6781\u4f7f\u7528\u7269\u7406\u5185\u5b58 echo vm.swappiness = 10 /etc/sysctl.conf # \u7981\u7528\u900f\u660e\u5927\u9875\uff08rh6\u5f15\u5165\uff0c\u7ba1\u7406\u5185\u5b58\u662f\u52a8\u6001\u5206\u914d\u7684\u65b9\u5f0f\uff0c\u5728real application clusters\u73af\u5883\u4e0b\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u5f02\u5e38\u7684\u6027\u80fd\u95ee\u9898\uff09 echo never /sys/kernel/mm/transparent_hugepage/defrag echo never /sys/kernel/mm/transparent_hugepage/enabled # \u7f16\u8f91/etc/rc.d/rc.local\uff0c\u52a0\u5165 if test -f /sys/kernel/mm/transparent_hugepage/enabled; then echo never /sys/kernel/mm/transparent_hugepage/enabled fi if test -f /sys/kernel/mm/transparent_hugepage/defrag; then echo never /sys/kernel/mm/transparent_hugepage/defrag fi # \u786e\u8ba4/etc/rc.d/rc.local\u53ef\u6267\u884c chmod +x /etc/rc.d/rc.local #################### # \u6dfb\u52a0\u64cd\u4f5c\u7528\u6237cdhtool\u8fdbroot\u7ec4 adduser cdhtool usermod -a -G root cdhtool echo -e `id cdhtool` # \u5f00cdhtool\u514d\u5bc6 vim /etc/sudoers # \u6700\u540e\u884c\u6dfb\u52a0\uff0cwq!\u4fdd\u5b58 cdhtool ALL=(ALL) NOPASSWD:ALL # \u8bbe\u7f6e\u76ee\u5f55\u6743\u9650 mkdir -p /opt/software chown cdhtool:cdhtool -R /opt/software/ # httpd\u5f00\u673a\u542f\u52a8 systemctl start httpd systemctl enable httpd.service # datanode\u4e0a\uff0c\u6570\u636e\u76d8\u505araid0\uff0c\u5e76\u6302\u8f7d/data # \u91cd\u542f reboot #################### \u540e\u7eed\u5b89\u88c5\u4ee5cdhtool\u4e3a\u4e3b su - cdhtool # \u4e2d\u63a7key\u590d\u5236\u5230\u6bcf\u4e2a\u8282\u70b9\u4e3b\u673a\u4e0a mkdir .ssh echo '{\u4f60\u7684\u4e2d\u63a7\u516c\u94a5}' ~/.ssh/authorized_keys chmod 700 ~/.ssh/ chmod 600 ~/.ssh/authorized_keys ################### # \u4e0b\u8f7d\u76f8\u5173\u8f6f\u4ef6 mkdir -p /opt/software cd /opt/software # mysql5.7 wget https://cdn.mysql.com//Downloads/MySQL-5.7/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz # cloudera manager wget https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-agent-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-server-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-daemons-6.1.1-853290.el7.x86_64.rpm https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-server-db-2-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/enterprise-debuginfo-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/oracle-j2sdk1.8-1.8.0+update181-1.x86_64.rpm wget https://archive.cloudera.com/cm6/6.1.1/allkeys.asc # cdh6 wget https://archive.cloudera.com/cdh6/6.1.1/parcels/CDH-6.1.1-1.cdh6.1.1.p0.875250-el7.parcel \\ https://archive.cloudera.com/cdh6/6.1.1/parcels/CDH-6.1.1-1.cdh6.1.1.p0.875250-el7.parcel.sha256 \\ https://archive.cloudera.com/cdh6/6.1.1/parcels/manifest.json # TODO \u5b89\u88c5jkd8","title":"Cloudera Distribution Hadoop\uff08CDH\uff09\u5b89\u88c5\u6559\u7a0b"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u5927\u6570\u636e/cdh_install/#cloudera-distribution-hadoopcdh","text":"\u57fa\u4e8e6.1.1\u7248\u672c\uff0c\u5c0f\u578b\u96c6\u7fa4\uff0820\u4e2a\u8282\u70b9\uff09","title":"Cloudera Distribution Hadoop\uff08CDH\uff09\u5b89\u88c5\u6559\u7a0b"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u5927\u6570\u636e/cdh_install/#_1","text":"\u5b98\u65b9\u624b\u518c\uff1a https://www.cloudera.com/documentation/enterprise/6/6.1/topics/installation.html","title":"\u53c2\u8003"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u5927\u6570\u636e/cdh_install/#_2","text":"\u786c\u4ef6 \u5b58\u50a8 /usr 1GB /var 200GB /opt 15GB / 100 GB \u6302\u8f7d\u786c\u76d8\u5206\u533a 12 * 8TB\uff08\u5355\u4e2aDN 100TB\uff0c\u5355\u5206\u533a 8TB\uff09 \u6587\u4ef6\u683c\u5f0f ext3, ext4 CPU 4Core\uff0c\u5efa\u8bae 16Core\u4ee5\u4e0a \u5185\u5b58 32GB\uff0c\u5efa\u8bae 60GB\u4ee5\u4e0a \u8f6f\u4ef6 OS CentOS 7.2~7.6; Ubuntu 16.04 /etc/fstab\u7981\u7528atime\uff0c\u5982 /dev/sdb1 /data1 ext4 defaults,noatime 0 \u91cd\u542f\u81ea\u52a8\u6302\u8f7d mount -o remount /data1 /etc/security/limits.d/20-nproc.conf\u653e\u5927 * soft nproc 655350 /etc/hosts\u652f\u6301\u591a\u57df\u540d\uff0c\u5c0f\u5199\uff0c\u5982 192.168.1.1 cluster-01 \u5173\u95edSELinux \u5173\u95ed\u9632\u706b\u5899\uff0c\u5982iptables /etc/sysconfig/network\u7ed1\u5b9ahostname\uff0c\u5982 HOSTNAME=cluster-01 DB MySQL 5.7; PostgreSQL 9.4+; Oracle 12.2 JDK 1.8u31+ \u5806\u5185\u5b58 20GB \uff08HDFS|YARN\uff1a200\u4e3b\u673a\uff0c4000\u5b9e\u4f8b\uff1bHBase|Kafka\uff1a100\u4e3b\u673a\uff0c3w\u5b9e\u4f8b\uff09 \u975e\u5806\u5185\u5b58 12GB Python 2.7 python-psycopg2 iproute-3.10","title":"\u73af\u5883\u8981\u6c42"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u5927\u6570\u636e/cdh_install/#_3","text":"","title":"\u5b89\u88c5"},{"location":"02.\u8f6f\u4ef6\u7b14\u8bb0/\u5927\u6570\u636e/cdh_install/#_4","text":"# yum\u5b89\u88c5 yum -y install epel-release yum -y install vim unzip zip lrzsz tmux httpd zabbix-agent # py\u5b89\u88c5\uff0c\u955c\u50cf\u52a0\u901f easy_install -i https://pypi.tuna.tsinghua.edu.cn/simple pip #################### # \u7ed1\u5b9ahostname hostname {\u6309\u5b9e\u9645\u66ff\u6362\u4e3a\u5185\u90e8hostname} export hname=$(hostname) export ip=$(ifconfig | grep inet | grep -v '127.0.0.1' | awk '{print $2}') echo $ip $hname /etc/hosts sed -i s/^HOSTNAME.*$/HOSTNAME=$hname/g /etc/sysconfig/network echo -e `hostname` # \u4fee\u6539/etc/hosts\uff0c\u52a0\u5165\u96c6\u7fa4\u76f8\u5173ip\u548c\u5bf9\u5e94\u5185\u90e8\u57df\u540d \u7565 # ulimit # ulimit -HSn 65535 # echo ulimit -HSn 65535 /etc/rc.local # \u9002\u7528centos7 sed -i s/4096/65535/g /etc/security/limits.d/20-nproc.conf # \u7edf\u4e00\u65f6\u533a\uff1a\u4e1c8\u533a (date -R) # ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime # ntp\u65f6\u949f echo */10 * * * * /usr/sbin/ntpdate -u {\u4f60\u7684ntp\u670d\u52a1\u5730\u5740} /dev/null 2 1 /var/spool/cron/root # \u5b89\u88c5\u76d1\u63a7 # \u5173\u95ed\u9632\u706b\u5899 systemctl stop firewalld.service systemctl disable firewalld.service # \u4fee\u6539/etc/selinux/config\uff0c\u5173\u95edSELinux\uff08SELINUX=disabled\uff09\u7565 # yum install -y zabbix-agent sed -i 's!Server=.*!Server={\u4f60\u7684zabbix\u670d\u52a1ip}!' /usr/local/zabbix/etc/zabbix_agentd.conf sed -i 's!ServerActive=.*!ServerActive={\u4f60\u7684zabbix\u670d\u52a1ip}!' /usr/local/zabbix/etc/zabbix_agentd.conf service zabbix_agentd restart # \u4e0azabbix\u5e73\u53f0\uff0c\u786e\u8ba4\u4e3b\u673a\u81ea\u52a8\u53d1\u73b0 # \u8bbe\u7f6eswap\uff08/proc/sys/vm/swappiness \u9ed8\u8ba460 = 10\uff09\u4e3a\u79ef\u6781\u4f7f\u7528\u7269\u7406\u5185\u5b58 echo vm.swappiness = 10 /etc/sysctl.conf # \u7981\u7528\u900f\u660e\u5927\u9875\uff08rh6\u5f15\u5165\uff0c\u7ba1\u7406\u5185\u5b58\u662f\u52a8\u6001\u5206\u914d\u7684\u65b9\u5f0f\uff0c\u5728real application clusters\u73af\u5883\u4e0b\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u5f02\u5e38\u7684\u6027\u80fd\u95ee\u9898\uff09 echo never /sys/kernel/mm/transparent_hugepage/defrag echo never /sys/kernel/mm/transparent_hugepage/enabled # \u7f16\u8f91/etc/rc.d/rc.local\uff0c\u52a0\u5165 if test -f /sys/kernel/mm/transparent_hugepage/enabled; then echo never /sys/kernel/mm/transparent_hugepage/enabled fi if test -f /sys/kernel/mm/transparent_hugepage/defrag; then echo never /sys/kernel/mm/transparent_hugepage/defrag fi # \u786e\u8ba4/etc/rc.d/rc.local\u53ef\u6267\u884c chmod +x /etc/rc.d/rc.local #################### # \u6dfb\u52a0\u64cd\u4f5c\u7528\u6237cdhtool\u8fdbroot\u7ec4 adduser cdhtool usermod -a -G root cdhtool echo -e `id cdhtool` # \u5f00cdhtool\u514d\u5bc6 vim /etc/sudoers # \u6700\u540e\u884c\u6dfb\u52a0\uff0cwq!\u4fdd\u5b58 cdhtool ALL=(ALL) NOPASSWD:ALL # \u8bbe\u7f6e\u76ee\u5f55\u6743\u9650 mkdir -p /opt/software chown cdhtool:cdhtool -R /opt/software/ # httpd\u5f00\u673a\u542f\u52a8 systemctl start httpd systemctl enable httpd.service # datanode\u4e0a\uff0c\u6570\u636e\u76d8\u505araid0\uff0c\u5e76\u6302\u8f7d/data # \u91cd\u542f reboot #################### \u540e\u7eed\u5b89\u88c5\u4ee5cdhtool\u4e3a\u4e3b su - cdhtool # \u4e2d\u63a7key\u590d\u5236\u5230\u6bcf\u4e2a\u8282\u70b9\u4e3b\u673a\u4e0a mkdir .ssh echo '{\u4f60\u7684\u4e2d\u63a7\u516c\u94a5}' ~/.ssh/authorized_keys chmod 700 ~/.ssh/ chmod 600 ~/.ssh/authorized_keys ################### # \u4e0b\u8f7d\u76f8\u5173\u8f6f\u4ef6 mkdir -p /opt/software cd /opt/software # mysql5.7 wget https://cdn.mysql.com//Downloads/MySQL-5.7/mysql-5.7.26-linux-glibc2.12-x86_64.tar.gz # cloudera manager wget https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-agent-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-server-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-daemons-6.1.1-853290.el7.x86_64.rpm https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/cloudera-manager-server-db-2-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/enterprise-debuginfo-6.1.1-853290.el7.x86_64.rpm \\ https://archive.cloudera.com/cm6/6.1.1/redhat7/yum/RPMS/x86_64/oracle-j2sdk1.8-1.8.0+update181-1.x86_64.rpm wget https://archive.cloudera.com/cm6/6.1.1/allkeys.asc # cdh6 wget https://archive.cloudera.com/cdh6/6.1.1/parcels/CDH-6.1.1-1.cdh6.1.1.p0.875250-el7.parcel \\ https://archive.cloudera.com/cdh6/6.1.1/parcels/CDH-6.1.1-1.cdh6.1.1.p0.875250-el7.parcel.sha256 \\ https://archive.cloudera.com/cdh6/6.1.1/parcels/manifest.json # TODO \u5b89\u88c5jkd8","title":"\u4e3b\u673a\u9884\u521d\u59cb\u5316"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/","text":"\u7b80\u4ecb \u652f\u6301\u516c\u53f8\u4e1a\u52a1\u7cfb\u7edf\u7684\u5e94\u7528\u8fd0\u7ef4\u5de5\u7a0b\u5e08\uff0c\u5e2e\u52a9\u4e1a\u52a1\u5b9e\u73b0\u4ef7\u503c\u6700\u5927\u5316\u3002 \"\u8d34\u8fd1\u4e1a\u52a1\uff0c\u7406\u89e3\u4e1a\u52a1\uff0c\u6316\u6398\u4e1a\u52a1\u7684\u4ef7\u503c\uff0c\u6269\u5c55\u670d\u52a1\u4ef7\u503c\u3002\" \u670d\u52a1\u4f53\u7cfb \u8fd0\u7ef4\u7814\u53d1\u5de5\u7a0b\u5e08\u4f1a\u8de8\u4e1a\u52a1\u751f\u547d\u5468\u671f\u7684\u4ecb\u5165\u5176\u4e2d\u3002 \u7814\u53d1\u671f \u8fd0\u8425\u671f \u9ad8\u53ef\u7528\u67b6\u6784\u8bbe\u8ba1 \u6301\u7eed\u96c6\u6210\u548c\u90e8\u7f72 \u9ad8\u53ef\u7528\u4fdd\u969c \u6570\u636e\u670d\u52a1 \u6210\u672c\u4f18\u5316 \u4ea7\u54c1\u8fd0\u8425\u652f\u6301 \u7528\u6237\u4f53\u9a8c\u4f18\u5316","title":"\u7b80\u4ecb"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/#_1","text":"\u652f\u6301\u516c\u53f8\u4e1a\u52a1\u7cfb\u7edf\u7684\u5e94\u7528\u8fd0\u7ef4\u5de5\u7a0b\u5e08\uff0c\u5e2e\u52a9\u4e1a\u52a1\u5b9e\u73b0\u4ef7\u503c\u6700\u5927\u5316\u3002 \"\u8d34\u8fd1\u4e1a\u52a1\uff0c\u7406\u89e3\u4e1a\u52a1\uff0c\u6316\u6398\u4e1a\u52a1\u7684\u4ef7\u503c\uff0c\u6269\u5c55\u670d\u52a1\u4ef7\u503c\u3002\"","title":"\u7b80\u4ecb"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/#_2","text":"\u8fd0\u7ef4\u7814\u53d1\u5de5\u7a0b\u5e08\u4f1a\u8de8\u4e1a\u52a1\u751f\u547d\u5468\u671f\u7684\u4ecb\u5165\u5176\u4e2d\u3002 \u7814\u53d1\u671f \u8fd0\u8425\u671f \u9ad8\u53ef\u7528\u67b6\u6784\u8bbe\u8ba1 \u6301\u7eed\u96c6\u6210\u548c\u90e8\u7f72 \u9ad8\u53ef\u7528\u4fdd\u969c \u6570\u636e\u670d\u52a1 \u6210\u672c\u4f18\u5316 \u4ea7\u54c1\u8fd0\u8425\u652f\u6301 \u7528\u6237\u4f53\u9a8c\u4f18\u5316","title":"\u670d\u52a1\u4f53\u7cfb"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/alarm/","text":"\u544a\u8b66\u670d\u52a1","title":"\u544a\u8b66\u670d\u52a1"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/alarm/#_1","text":"","title":"\u544a\u8b66\u670d\u52a1"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/env_build/","text":"","title":"Env build"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/monitor/","text":"\u76d1\u63a7\u4f53\u7cfb \u76d1\u63a7\u662f\u4fdd\u969c\u4e1a\u52a1\u7a33\u5b9a\u6027\u7684\u6838\u5fc3\u4e1a\u52a1\u80fd\u529b\u4e4b\u4e00\uff0c\u4ece\u4f4e\u5230\u9ad8\u53ef\u5206\u7ea7\u4e3a\uff1a \u65e0\u5e8f\u6df7\u4e71\u7684\uff0c\u6551\u706b\u961f\u5f0f \u5efa\u7acb\u521d\u6b65\u7684\u6807\u51c6\u548c\u6545\u969c\u5904\u7406\u6d41\u7a0b \u5bf9\u4e1a\u52a1\u751f\u547d\u5468\u671f\u6709\u89c4\u8303\u7684\u7ba1\u7406\u80fd\u529b\uff0c\u63d0\u4f9b\u5e73\u53f0\u81ea\u52a9\u670d\u52a1 \u4f9d\u8d56\u6570\u636e\uff0c\u80fd\u9884\u6d4b\u7684\u505a\u8fd0\u7ef4\u51b3\u7b56 \u5e94\u7528\u76d1\u63a7\u80fd\u529b \u76d1\u63a7\u6570\u636e\u662f\u540e\u7eed\u5176\u4ed6\u670d\u52a1\u7684\u57fa\u77f3\uff0c\u9700\u8981\u4ece\u70b9\u5230\u9762\u9010\u6b65\u8986\u76d6\u3002 \u8d28\u91cf\u4f53\u7cfb\u6807\u51c6\u5316 \u4e8b\u4ef6\u54cd\u5e94\u548c\u5904\u7406 \u76d1\u63a7\u5e73\u53f0","title":"\u76d1\u63a7\u4f53\u7cfb"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/monitor/#_1","text":"\u76d1\u63a7\u662f\u4fdd\u969c\u4e1a\u52a1\u7a33\u5b9a\u6027\u7684\u6838\u5fc3\u4e1a\u52a1\u80fd\u529b\u4e4b\u4e00\uff0c\u4ece\u4f4e\u5230\u9ad8\u53ef\u5206\u7ea7\u4e3a\uff1a \u65e0\u5e8f\u6df7\u4e71\u7684\uff0c\u6551\u706b\u961f\u5f0f \u5efa\u7acb\u521d\u6b65\u7684\u6807\u51c6\u548c\u6545\u969c\u5904\u7406\u6d41\u7a0b \u5bf9\u4e1a\u52a1\u751f\u547d\u5468\u671f\u6709\u89c4\u8303\u7684\u7ba1\u7406\u80fd\u529b\uff0c\u63d0\u4f9b\u5e73\u53f0\u81ea\u52a9\u670d\u52a1 \u4f9d\u8d56\u6570\u636e\uff0c\u80fd\u9884\u6d4b\u7684\u505a\u8fd0\u7ef4\u51b3\u7b56","title":"\u76d1\u63a7\u4f53\u7cfb"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/monitor/#_2","text":"\u76d1\u63a7\u6570\u636e\u662f\u540e\u7eed\u5176\u4ed6\u670d\u52a1\u7684\u57fa\u77f3\uff0c\u9700\u8981\u4ece\u70b9\u5230\u9762\u9010\u6b65\u8986\u76d6\u3002","title":"\u5e94\u7528\u76d1\u63a7\u80fd\u529b"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/monitor/#_3","text":"","title":"\u8d28\u91cf\u4f53\u7cfb\u6807\u51c6\u5316"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/monitor/#_4","text":"","title":"\u4e8b\u4ef6\u54cd\u5e94\u548c\u5904\u7406"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/monitor/#_5","text":"","title":"\u76d1\u63a7\u5e73\u53f0"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/ops_interview/","text":"\u5e38\u89c1\u8fd0\u7ef4\u9762\u8bd5\u9898\u76ee \u914d\u7ba1 \u73b0\u6709100\u53f0\u670d\u52a1\u5668\uff0c\u8be5\u5982\u4f55\u7ba1\u7406\uff1f * \u8bbe\u5b9a\u8df3\u677f\u673a\uff0c\u4f7f\u7528\u7edf\u4e00\u8d26\u53f7\u767b\u5f55\uff0c\u4fbf\u4e8e\u5b89\u5168 * \u4f7f\u7528ansiable\u3001puppet\u8fdb\u884c\u7cfb\u7edf\u7684\u7edf\u4e00\u8c03\u5ea6\u4e0e\u914d\u7f6e * \u5efa\u7acb\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u3001\u914d\u7f6e\u3001\u5e94\u7528\u7684cmdb\u4fe1\u606f\u7ba1\u7406\u3002\u4fbf\u4e8e\u67e5\u9605\u5404\u79cd\u4fe1\u606f\u8bb0\u5f55 \u8d1f\u8f7d\u5747\u8861 LVS\u3001Nginx\u3001HAproxy\u6709\u4ec0\u4e48\u533a\u522b\u548c\u9009\u62e9\uff1f * LVS\uff1a \u662f\u57fa\u4e8e\u56db\u5c42\u7684\u8f6c\u53d1\uff0c\u9650\u7aef\u53e3 * HAproxy\uff1a \u662f\u57fa\u4e8e\u56db\u5c42\u548c\u4e03\u5c42\u7684\u8f6c\u53d1 * Nginx\uff1a \u662fWEB\u670d\u52a1\u5668\uff0c\u7f13\u5b58\u670d\u52a1\u5668\uff0c\u53c8\u662f\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u505a\u4e03\u5c42\u7684\u8f6c\u53d1 * \u5927\u5e76\u53d1\u91cf\u7684\u65f6\u5019\u6211\u4eec\u5c31\u8981\u9009\u62e9LVS\uff1b\u5e76\u53d1\u91cf\u6ca1\u90a3\u4e48\u5927\u9009\u62e9HAproxy\u6216\u8005Nginx\u8db3\u5df2 Keepalived\u7684\u5de5\u4f5c\u539f\u7406\uff1f * \u4e00\u4e2a\u865a\u62df\u8def\u7531\u5668\u4e2d\uff0c\u53ea\u6709\u4f5c\u4e3aMASTER\u7684VRRP\u8def\u7531\u5668\u4f1a\u4e00\u76f4\u53d1\u9001VRRP\u901a\u544a * \u5f53MASTER\u4e0d\u53ef\u7528\u65f6(BACKUP\u6536\u4e0d\u5230\u901a\u544a\u4fe1\u606f)\uff0c\u591a\u53f0BACKUP\u4e2d\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u8fd9\u53f0\u4f1a\u88ab\u62a2\u5360\u4e3aMASTER( 1s)\uff0c\u4ee5\u4fdd\u8bc1\u670d\u52a1\u7684\u8fde\u7eed\u6027 * VRRP\u5305\u4f7f\u7528\u4e86\u52a0\u5bc6\u534f\u8bae\u8fdb\u884c\u52a0\u5bc6\u3002BACKUP\u4e0d\u4f1a\u53d1\u9001\u901a\u544a\u4fe1\u606f LVS\u4e09\u79cd\u6a21\u5f0f\uff1f * NAT\u6a21\u5f0f\uff1a\u628a\u5ba2\u6237\u7aef\u53d1\u6765\u7684\u6570\u636e\u5305\u7684IP\u5934\u7684\u76ee\u7684\u5730\u5740\uff0c\u5728\u8d1f\u8f7d\u5747\u8861\u5668\u4e0a\u6362\u6210\u5176\u4e2d\u4e00\u53f0RS\u7684IP\u5730\u5740\uff0c\u5e76\u53d1\u81f3\u6b64RS\u6765\u5904\u7406\uff1bRS\u5904\u7406\u5b8c\u540e\u628a\u6570\u636e\u4ea4\u7ed9\u8d1f\u8f7d\u5747\u8861\u5668,\u8d1f\u8f7d\u5747\u8861\u5668\u518d\u628a\u6570\u636e\u5305\u539fIP\u5730\u5740\u6539\u4e3a\u81ea\u5df1\u7684IP * \u4f18\u70b9\uff1a\u53ea\u6709\u8d1f\u8f7d\u5747\u8861\u5668\u9700\u8981\u4e00\u4e2a\u5408\u6cd5\u7684IP\u5730\u5740 * \u7f3a\u70b9\uff1a\u6269\u5c55\u6027\u6709\u9650\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6210\u4e3a\u6574\u4e2a\u7cfb\u7edf\u7684\u74f6\u9888\uff08\u5927\u91cf\u7684\u6570\u636e\u5305\u90fd\u4ea4\u6c47\u5728\u8d1f\u8f7d\u5747\u8861\u5668\uff09 * TUN\u96a7\u9053\u6a21\u5f0f\uff1a\u628a\u5ba2\u6237\u7aef\u53d1\u6765\u7684\u6570\u636e\u5305\uff0c\u5c01\u88c5\u4e00\u4e2a\u65b0\u7684IP\u5934\u6807\u8bb0(\u4ec5\u76ee\u7684IP)\u53d1\u7ed9RS\uff1bRS\uff08\u5185\u6838\u5fc5\u987b\u652f\u6301IPTUNNEL\u534f\u8bae\uff09\u6536\u5230\u540e,\u5148\u628a\u6570\u636e\u5305\u7684\u5934\u89e3\u5f00,\u8fd8\u539f\u6570\u636e\u5305,\u5904\u7406\u540e,\u76f4\u63a5\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef,\u4e0d\u9700\u8981\u518d\u7ecf\u8fc7LB * \u4f18\u70b9\uff1a\u80fd\u5904\u7406\u5f88\u5de8\u5927\u7684\u8bf7\u6c42\u91cf\uff0cLB\u4e0d\u662f\u74f6\u9888 * \u7f3a\u70b9\uff1aRS\u8282\u70b9\u9700\u8981\u5408\u6cd5IP\uff0c\u6240\u6709\u7684\u670d\u52a1\u5668\u652f\u6301\u201dIP Tunneling\u201d\u534f\u8bae * DR\u76f4\u63a5\u8def\u7531\u6a21\u5f0f\uff1aLB\u548cRS\u90fd\u4f7f\u7528\u540c\u4e00\u4e2aIP\u5bf9\u5916\u670d\u52a1\uff0c\u53ea\u6709DR\u5bf9ARP\u8bf7\u6c42\u8fdb\u884c\u54cd\u5e94\uff08\u6240\u6709RS\u5bf9\u8fd9\u4e2aIP\u7684ARP\u8bf7\u6c42\u4fdd\u6301\u9759\u9ed8\uff09\uff1bDR\u6536\u5230\u6570\u636e\u5305\u540e\u6839\u636e\u8c03\u5ea6\u7b97\u6cd5,\u627e\u51fa\u5bf9\u5e94\u7684RS,\u628a\u76ee\u7684MAC\u5730\u5740\u6539\u4e3aRS\u7684MAC\uff0c\u5e76\u5c06\u8bf7\u6c42\u5206\u53d1\u7ed9\u8fd9\u53f0RS\uff1bRS\u76f4\u63a5\u8fd4\u56de\u6570\u636e\uff08IP\u4e00\u6837\uff09\uff1bLB\u548cRS\u5728\u540c\u4e00\u53f0\u4ea4\u6362\u673a\u4e0b * \u4f18\u70b9\uff1a\u80fd\u5904\u7406\u5f88\u5de8\u5927\u7684\u8bf7\u6c42\u91cf\uff0c\u5e94\u7b54\u5305\u901a\u8fc7\u5355\u72ec\u7684\u8def\u7531\u65b9\u6cd5\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef * \u7f3a\u70b9\uff1aLB\u7684\u7f51\u5361\u5fc5\u987b\u4e0e\u7269\u7406\u7f51\u5361\u5728\u4e00\u4e2a\u7269\u7406\u7f51\u6bb5\u4e0a \u5e38\u7528\u7684Nginx\u6a21\u5757? * rewrite\u6a21\u5757\uff0c\u5b9e\u73b0\u91cd\u5199 * access\u6a21\u5757\uff1a\u6765\u6e90\u63a7\u5236 * ssl\u6a21\u5757\uff1a\u5b89\u5168\u52a0\u5bc6 * ngx_http_gzip_module\uff1a\u7f51\u7edc\u4f20\u8f93\u538b\u7f29\u6a21\u5757 * ngx_http_proxy_module \u6a21\u5757\u5b9e\u73b0\u4ee3\u7406 * ngx_http_upstream_module\u6a21\u5757\u5b9e\u73b0\u5b9a\u4e49\u540e\u7aef\u670d\u52a1\u5668\u5217\u8868 Web\u670d\u52a1 Tomcat8005\u30018009\u30018080\u4e09\u4e2a\u7aef\u53e3\u7684\u542b\u4e49\uff1f * 8005\uff1a\u5173\u95ed\u4f7f\u7528 * 8009\uff1aAJP\u7aef\u53e3\uff0c\u5373\u5bb9\u5668\u4f7f\u7528\uff0c\u5982Apache\u80fd\u901a\u8fc7AJP\u534f\u8bae\u8bbf\u95eeTomcat\u76848009\u7aef\u53e3 * 8080\uff1a\u5e94\u7528\u4f7f\u7528 CDN\uff1f * \u5185\u5bb9\u5206\u53d1\u7f51\u7edc\uff0c\u901a\u8fc7\u5728\u73b0\u6709\u7684Internet\u4e2d\u589e\u52a0\u4e00\u5c42\u65b0\u7684\u7f51\u7edc\u67b6\u6784\uff0c\u5c06\u7f51\u7ad9\u7684\u5185\u5bb9\u53d1\u5e03\u5230\u6700\u63a5\u8fd1\u7528\u6237\u7684\u7f51\u7edc\u8fb9\u7f18\uff0c\u4f7f\u7528\u6237\u53ef\u5c31\u8fd1\u53d6\u5f97\u6240\u9700\u7684\u5185\u5bb9\uff0c\u63d0\u9ad8\u7528\u6237\u8bbf\u95ee\u7f51\u7ad9\u7684\u901f\u5ea6 \u5b58\u50a8 raid0 raid1 raid5 \u5de5\u4f5c\u539f\u7406\u53ca\u7279\u70b9\uff1f * RAID 0\uff0c\u53ef\u4ee5\u662f\u4e00\u5757\u76d8\u548cN\u4e2a\u76d8\u7ec4\u5408\uff0c\u4f18\u70b9\u8bfb\u5199\u5feb\uff0c\u7f3a\u70b9\uff1a\u6ca1\u6709\u5197\u4f59\uff0c\u4e00\u5757\u574f\u4e86\u6570\u636e\u5c31\u5168\u6ca1\u6709\u4e86 * RAID 1\uff0c\u53ea\u80fd2\u5757\u76d8\uff0c\u76d8\u7684\u5927\u5c0f\u53ef\u4ee5\u4e0d\u4e00\u6837\uff0c\u4ee5\u5c0f\u7684\u4e3a\u51c6\uff0c100%\u7684\u5197\u4f59\uff0c\u7f3a\u70b9\uff1a\u6d6a\u8d39\u8d44\u6e90 * RAID 5 \uff0c3\u5757\u76d8\uff0c\u5bb9\u91cf\u8ba1\u7b9710*\uff08n-1\uff09,\u635f\u5931\u4e00\u5757\u76d8\uff0c\u8bfb\u6027\u80fd\u4e00\u822c\uff0c\u5199\u4e0d\u597d * \u5355\u53f0\u670d\u52a1\u5668\uff1a\u7cfb\u7edf\u76d8\uff0cRAID1 * \u6570\u636e\u5e93\u670d\u52a1\u5668\uff1a\u4e3b\u5e93\uff1aRAID10 \u4ece\u5e93 RAID5 \u53d8\u66f4\u4e0e\u53d1\u5e03 \u7070\u5ea6\u53d1\u5e03\uff1f * \u9ed1\u4e0e\u767d\u4e4b\u95f4\uff0c\u80fd\u591f\u5e73\u6ed1\u8fc7\u6e21\u7684\u4e00\u79cd\u53d1\u5e03\u65b9\u5f0f\uff0c\u5982AB Test\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u6574\u4f53\u7cfb\u7edf\u7684\u7a33\u5b9a\uff0c\u5728\u521d\u59cb\u7070\u5ea6\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u53d1\u73b0\u3001\u8c03\u6574\u95ee\u9898\uff0c\u4ee5\u4fdd\u8bc1\u5176\u5f71\u54cd\u5ea6 \u7f51\u7edc DNS\u8fdb\u884c\u57df\u540d\u89e3\u6790\u7684\u8fc7\u7a0b\uff1f * \u672c\u673a\u7684host\u6587\u4ef6-- \u672c\u5730\u8bbe\u7f6e\u7684DNS\u670d\u52a1\u5668-- \u7f51\u7edc\u4e2d\u627e\u6839\u670d\u52a1\u5668-- \u4e00\u7ea7\u57df\u540d\u670d\u52a1\u5668.cn-- \u4e8c\u7ea7\u57df\u540d\u670d\u52a1\u5668.com.cn-- \u4e09\u7ea7\u57df\u540d\u670d\u52a1\u5668.baidu.com.cn\uff0c\u6b63\u597d\u6709\u8fd9\u4e2a\u7f51\u7ad9www.baidu.com\uff0c\u7136\u540e\u53d1\u7ed9\u8bf7\u6c42\u7684\u670d\u52a1\u5668\uff0c\u4fdd\u5b58\u4e00\u4efd\u4e4b\u540e\uff0c\u518d\u53d1\u7ed9\u5ba2\u6237\u7aef \u4e2d\u95f4\u4ef6 RabbitMQ\uff1f * \u6d88\u606f\u4e2d\u95f4\u4ef6\u662f\u5728\u6d88\u606f\u7684\u4f20\u606f\u8fc7\u7a0b\u4e2d\u4fdd\u5b58\u6d88\u606f\u7684\u5bb9\u5668\uff1b\u76ee\u7684\u662f\u63d0\u4f9b\u8def\u7531\u5e76\u4fdd\u8bc1\u6d88\u606f\u7684\u4f20\u9012\uff1b\u5982\u679c\u53d1\u9001\u6d88\u606f\u65f6\u63a5\u6536\u8005\u4e0d\u53ef\u7528\u6d88\u606f\u961f\u5217\u4e0d\u4f1a\u4fdd\u7559\u6d88\u606f\uff0c\u76f4\u5230\u53ef\u4ee5\u6210\u529f\u5730\u4f20\u9012\u4e3a\u6b62\uff0c\u6709\u65f6\u9650 \u6570\u636e\u5e93 mysql\u5982\u4f55\u51cf\u5c11\u4e3b\u4ece\u590d\u5236\u5ef6\u8fdf\uff1f\u53ef\u80fd\u539f\u56e0\uff1f * \u4ece\u5e93\u786c\u4ef6\u6bd4\u4e3b\u5e93\u5dee * \u6162SQL\u8bed\u53e5\u8fc7\u591a * \u7f51\u7edc\u5ef6\u8fdf * \u4e3b\u5e93\u8bfb\u5199\u538b\u529b\u5927\uff0c\u5efa\u8bae\u524d\u7aef\u52a0Cache * \u591a\u53f0slave\u6765\u5206\u644a\u8bfb\u8bf7\uff0c\u5176\u4e2d1\u53f0\u4e13\u7528\u4e8e\u5907\u4efd \u91cd\u7f6emysql root\u5bc6\u7801\uff1f * \u672c\u673ash\u4e0b\uff1a mysqladmin \u2013u root \u2013p password \"\u65b0\u5bc6\u7801\" * mysql \u73af\u5883\u4e2d\uff1a Update mysql.user set password=password('\u65b0\u5bc6\u7801') where user='root';flush privileges; \u6216\u8005 grant all on *.* to root@'localhost' identified by '\u65b0\u5bc6\u7801'\uff1b * \u5fd8\u8bb0root\u5bc6\u7801\u65f6\uff1a * \u505c\u6b62\u670d\u52a1 service mysqld stop * \u5b89\u5168\u6a21\u5f0f mysql/bin/mysqld_safe --skip-grant-table * \u7528\u7a7a\u5bc6\u7801\u7684root\u7528\u6237\u767b\u5f55 mysql -u root \uff0c\u540e\u540c\u4e0a mysql\u6570\u636e\u5907\u4efd? * mysql/bin/mysqldump \uff1a\u652f\u6301\u70ed\u5907\uff0c\u903b\u8f91\u5907\u4efd\uff0c\u901f\u5ea6\u4e0d\u5feb\uff0c\u9002\u5408\u6570\u636e\u6bd4\u8f83\u5c0f\u573a\u666f * LVM\u5feb\u7167\uff1a\u53ea\u80fd\u8fdb\u884c\u6ce0\u5907\u4efd * tar\u5305\u5907\u4efd \u5e38\u7528bash \u5206\u6790nginx\u8bbf\u95ee\u65e5\u5fd7\uff0c\u627e\u51fa\u8bbf\u95ee\u9875\u9762\u6570\u91cf\u5728\u524d\u5341\u4f4d\u7684ip: cat access.log | awk '{print $1}' | uniq -c | sort -rn | head -10 \u76d1\u542c\u4e3b\u673a\u4e3a192.168.1.1\uff0ctcp\u7aef\u53e3\u4e3a80\u7684\u6570\u636e\uff0c\u540c\u65f6\u5c06\u8f93\u51fa\u7ed3\u679c\u4fdd\u5b58\u8f93\u51fa\u5230tcpdump.log: tcpdump 'host 192.168.1.1 and port 80' tcpdump.log \u672c\u573080 \u7aef\u53e3\u7684\u8bf7\u6c42\u8f6c\u53d1\u52308080 \u7aef\u53e3\uff0c\u5f53\u524d\u4e3b\u673aIP \u4e3a192.168.2.1: iptables -A PREROUTING -d 192.168.2.1 -p tcp -m tcp -dport 80 -j DNAT-to-destination 192.168.2.1:8080 \u5b9e\u65f6\u6293\u53d6\u5e76\u663e\u793a\u5f53\u524d\u7cfb\u7edf\u4e2dtcp 80\u7aef\u53e3\u7684\u7f51\u7edc\u6570\u636e: tcpdump -nn tcp port 80 \u67e5\u770bhttp\u7684\u5e76\u53d1\u8bf7\u6c42\u6570\u4e0e\u5176TCP\u8fde\u63a5\u72b6\u6001: netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' \u547d\u4ee4\u53d6\u51fa linux \u4e2d eth0 \u7684 IP: ifconfig eth0|awk 'NR==2'|awk -F \":\" '{print $2}'|awk '{print $1}' \u6bcf\u5929\u665a\u4e0a 12 \u70b9\uff0c\u6253\u5305\u7ad9\u70b9\u76ee\u5f55/var/www/html \u5907\u4efd\u5230/data \u76ee\u5f55\u4e0b: cd /var/www/ /bin/tar zcf /data/html-`date +%m-%d%H`.tar.gz html/ ,\u4f7f\u7528crontab \u64cd\u4f5c\u7cfb\u7edf \u4f18\u5316Linux\u7cfb\u7edf\uff1f * \u4e0d\u7528root\uff0c\u6dfb\u52a0\u666e\u901a\u7528\u6237\uff0c\u901a\u8fc7sudo\u6388\u6743 * \u66f4\u6539\u9ed8\u8ba4\u7684\u8fdc\u7a0b\u8fde\u63a5SSH\u670d\u52a1\u7aef\u53e3\u53ca\u7981\u6b62root\u7528\u6237\u8fdc\u7a0b * \u5b9a\u65f6\u81ea\u52a8\u66f4\u65b0\u670d\u52a1\u5668\u65f6\u95f4 * \u914d\u7f6e\u56fd\u5185yum\u6e90 * \u5173\u95edselinux\u53caiptables\uff0c\u4f46\u662f\u5de5\u4f5c\u573a\u666f\u5982\u679c\u6709\u5916\u7f51IP\u4e00\u5b9a\u8981\u6253\u5f00 * \u8c03\u6574\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u6570\u91cf * \u7cbe\u7b80\u5f00\u673a\u542f\u52a8\u670d\u52a1\uff08crond rsyslog network sshd\uff09 * \u5185\u6838\u53c2\u6570\u4f18\u5316\uff08/etc/sysctl.conf\uff09 * \u66f4\u6539\u5b57\u7b26\u96c6\uff0c\u652f\u6301\u4e2d\u6587\uff0c\u4f46\u5efa\u8bae\u8fd8\u662f\u7528\u82f1\u6587\u5b57\u7b26\u96c6\uff0c\u9632\u6b62\u4e71\u7801 * \u9501\u5b9a\u5173\u952e\u7cfb\u7edf\u6587\u4ef6 * \u6e05\u7a7a/etc/issue\uff0c\u53bb\u9664\u7cfb\u7edf\u53ca\u5185\u6838\u7248\u672c\u767b\u5f55\u524d\u7684\u5c4f\u5e55\u663e\u793a \u4e2a\u4eba\u5b66\u4e60","title":"\u5e38\u89c1\u8fd0\u7ef4\u9762\u8bd5\u9898\u76ee"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/ops_interview/#_1","text":"","title":"\u5e38\u89c1\u8fd0\u7ef4\u9762\u8bd5\u9898\u76ee"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/ops_interview/#_2","text":"\u73b0\u6709100\u53f0\u670d\u52a1\u5668\uff0c\u8be5\u5982\u4f55\u7ba1\u7406\uff1f * \u8bbe\u5b9a\u8df3\u677f\u673a\uff0c\u4f7f\u7528\u7edf\u4e00\u8d26\u53f7\u767b\u5f55\uff0c\u4fbf\u4e8e\u5b89\u5168 * \u4f7f\u7528ansiable\u3001puppet\u8fdb\u884c\u7cfb\u7edf\u7684\u7edf\u4e00\u8c03\u5ea6\u4e0e\u914d\u7f6e * \u5efa\u7acb\u670d\u52a1\u5668\u7684\u7cfb\u7edf\u3001\u914d\u7f6e\u3001\u5e94\u7528\u7684cmdb\u4fe1\u606f\u7ba1\u7406\u3002\u4fbf\u4e8e\u67e5\u9605\u5404\u79cd\u4fe1\u606f\u8bb0\u5f55","title":"\u914d\u7ba1"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/ops_interview/#_3","text":"LVS\u3001Nginx\u3001HAproxy\u6709\u4ec0\u4e48\u533a\u522b\u548c\u9009\u62e9\uff1f * LVS\uff1a \u662f\u57fa\u4e8e\u56db\u5c42\u7684\u8f6c\u53d1\uff0c\u9650\u7aef\u53e3 * HAproxy\uff1a \u662f\u57fa\u4e8e\u56db\u5c42\u548c\u4e03\u5c42\u7684\u8f6c\u53d1 * Nginx\uff1a \u662fWEB\u670d\u52a1\u5668\uff0c\u7f13\u5b58\u670d\u52a1\u5668\uff0c\u53c8\u662f\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u505a\u4e03\u5c42\u7684\u8f6c\u53d1 * \u5927\u5e76\u53d1\u91cf\u7684\u65f6\u5019\u6211\u4eec\u5c31\u8981\u9009\u62e9LVS\uff1b\u5e76\u53d1\u91cf\u6ca1\u90a3\u4e48\u5927\u9009\u62e9HAproxy\u6216\u8005Nginx\u8db3\u5df2 Keepalived\u7684\u5de5\u4f5c\u539f\u7406\uff1f * \u4e00\u4e2a\u865a\u62df\u8def\u7531\u5668\u4e2d\uff0c\u53ea\u6709\u4f5c\u4e3aMASTER\u7684VRRP\u8def\u7531\u5668\u4f1a\u4e00\u76f4\u53d1\u9001VRRP\u901a\u544a * \u5f53MASTER\u4e0d\u53ef\u7528\u65f6(BACKUP\u6536\u4e0d\u5230\u901a\u544a\u4fe1\u606f)\uff0c\u591a\u53f0BACKUP\u4e2d\u4f18\u5148\u7ea7\u6700\u9ad8\u7684\u8fd9\u53f0\u4f1a\u88ab\u62a2\u5360\u4e3aMASTER( 1s)\uff0c\u4ee5\u4fdd\u8bc1\u670d\u52a1\u7684\u8fde\u7eed\u6027 * VRRP\u5305\u4f7f\u7528\u4e86\u52a0\u5bc6\u534f\u8bae\u8fdb\u884c\u52a0\u5bc6\u3002BACKUP\u4e0d\u4f1a\u53d1\u9001\u901a\u544a\u4fe1\u606f LVS\u4e09\u79cd\u6a21\u5f0f\uff1f * NAT\u6a21\u5f0f\uff1a\u628a\u5ba2\u6237\u7aef\u53d1\u6765\u7684\u6570\u636e\u5305\u7684IP\u5934\u7684\u76ee\u7684\u5730\u5740\uff0c\u5728\u8d1f\u8f7d\u5747\u8861\u5668\u4e0a\u6362\u6210\u5176\u4e2d\u4e00\u53f0RS\u7684IP\u5730\u5740\uff0c\u5e76\u53d1\u81f3\u6b64RS\u6765\u5904\u7406\uff1bRS\u5904\u7406\u5b8c\u540e\u628a\u6570\u636e\u4ea4\u7ed9\u8d1f\u8f7d\u5747\u8861\u5668,\u8d1f\u8f7d\u5747\u8861\u5668\u518d\u628a\u6570\u636e\u5305\u539fIP\u5730\u5740\u6539\u4e3a\u81ea\u5df1\u7684IP * \u4f18\u70b9\uff1a\u53ea\u6709\u8d1f\u8f7d\u5747\u8861\u5668\u9700\u8981\u4e00\u4e2a\u5408\u6cd5\u7684IP\u5730\u5740 * \u7f3a\u70b9\uff1a\u6269\u5c55\u6027\u6709\u9650\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6210\u4e3a\u6574\u4e2a\u7cfb\u7edf\u7684\u74f6\u9888\uff08\u5927\u91cf\u7684\u6570\u636e\u5305\u90fd\u4ea4\u6c47\u5728\u8d1f\u8f7d\u5747\u8861\u5668\uff09 * TUN\u96a7\u9053\u6a21\u5f0f\uff1a\u628a\u5ba2\u6237\u7aef\u53d1\u6765\u7684\u6570\u636e\u5305\uff0c\u5c01\u88c5\u4e00\u4e2a\u65b0\u7684IP\u5934\u6807\u8bb0(\u4ec5\u76ee\u7684IP)\u53d1\u7ed9RS\uff1bRS\uff08\u5185\u6838\u5fc5\u987b\u652f\u6301IPTUNNEL\u534f\u8bae\uff09\u6536\u5230\u540e,\u5148\u628a\u6570\u636e\u5305\u7684\u5934\u89e3\u5f00,\u8fd8\u539f\u6570\u636e\u5305,\u5904\u7406\u540e,\u76f4\u63a5\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef,\u4e0d\u9700\u8981\u518d\u7ecf\u8fc7LB * \u4f18\u70b9\uff1a\u80fd\u5904\u7406\u5f88\u5de8\u5927\u7684\u8bf7\u6c42\u91cf\uff0cLB\u4e0d\u662f\u74f6\u9888 * \u7f3a\u70b9\uff1aRS\u8282\u70b9\u9700\u8981\u5408\u6cd5IP\uff0c\u6240\u6709\u7684\u670d\u52a1\u5668\u652f\u6301\u201dIP Tunneling\u201d\u534f\u8bae * DR\u76f4\u63a5\u8def\u7531\u6a21\u5f0f\uff1aLB\u548cRS\u90fd\u4f7f\u7528\u540c\u4e00\u4e2aIP\u5bf9\u5916\u670d\u52a1\uff0c\u53ea\u6709DR\u5bf9ARP\u8bf7\u6c42\u8fdb\u884c\u54cd\u5e94\uff08\u6240\u6709RS\u5bf9\u8fd9\u4e2aIP\u7684ARP\u8bf7\u6c42\u4fdd\u6301\u9759\u9ed8\uff09\uff1bDR\u6536\u5230\u6570\u636e\u5305\u540e\u6839\u636e\u8c03\u5ea6\u7b97\u6cd5,\u627e\u51fa\u5bf9\u5e94\u7684RS,\u628a\u76ee\u7684MAC\u5730\u5740\u6539\u4e3aRS\u7684MAC\uff0c\u5e76\u5c06\u8bf7\u6c42\u5206\u53d1\u7ed9\u8fd9\u53f0RS\uff1bRS\u76f4\u63a5\u8fd4\u56de\u6570\u636e\uff08IP\u4e00\u6837\uff09\uff1bLB\u548cRS\u5728\u540c\u4e00\u53f0\u4ea4\u6362\u673a\u4e0b * \u4f18\u70b9\uff1a\u80fd\u5904\u7406\u5f88\u5de8\u5927\u7684\u8bf7\u6c42\u91cf\uff0c\u5e94\u7b54\u5305\u901a\u8fc7\u5355\u72ec\u7684\u8def\u7531\u65b9\u6cd5\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef * \u7f3a\u70b9\uff1aLB\u7684\u7f51\u5361\u5fc5\u987b\u4e0e\u7269\u7406\u7f51\u5361\u5728\u4e00\u4e2a\u7269\u7406\u7f51\u6bb5\u4e0a \u5e38\u7528\u7684Nginx\u6a21\u5757? * rewrite\u6a21\u5757\uff0c\u5b9e\u73b0\u91cd\u5199 * access\u6a21\u5757\uff1a\u6765\u6e90\u63a7\u5236 * ssl\u6a21\u5757\uff1a\u5b89\u5168\u52a0\u5bc6 * ngx_http_gzip_module\uff1a\u7f51\u7edc\u4f20\u8f93\u538b\u7f29\u6a21\u5757 * ngx_http_proxy_module \u6a21\u5757\u5b9e\u73b0\u4ee3\u7406 * ngx_http_upstream_module\u6a21\u5757\u5b9e\u73b0\u5b9a\u4e49\u540e\u7aef\u670d\u52a1\u5668\u5217\u8868","title":"\u8d1f\u8f7d\u5747\u8861"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/ops_interview/#web","text":"Tomcat8005\u30018009\u30018080\u4e09\u4e2a\u7aef\u53e3\u7684\u542b\u4e49\uff1f * 8005\uff1a\u5173\u95ed\u4f7f\u7528 * 8009\uff1aAJP\u7aef\u53e3\uff0c\u5373\u5bb9\u5668\u4f7f\u7528\uff0c\u5982Apache\u80fd\u901a\u8fc7AJP\u534f\u8bae\u8bbf\u95eeTomcat\u76848009\u7aef\u53e3 * 8080\uff1a\u5e94\u7528\u4f7f\u7528 CDN\uff1f * \u5185\u5bb9\u5206\u53d1\u7f51\u7edc\uff0c\u901a\u8fc7\u5728\u73b0\u6709\u7684Internet\u4e2d\u589e\u52a0\u4e00\u5c42\u65b0\u7684\u7f51\u7edc\u67b6\u6784\uff0c\u5c06\u7f51\u7ad9\u7684\u5185\u5bb9\u53d1\u5e03\u5230\u6700\u63a5\u8fd1\u7528\u6237\u7684\u7f51\u7edc\u8fb9\u7f18\uff0c\u4f7f\u7528\u6237\u53ef\u5c31\u8fd1\u53d6\u5f97\u6240\u9700\u7684\u5185\u5bb9\uff0c\u63d0\u9ad8\u7528\u6237\u8bbf\u95ee\u7f51\u7ad9\u7684\u901f\u5ea6","title":"Web\u670d\u52a1"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/ops_interview/#_4","text":"raid0 raid1 raid5 \u5de5\u4f5c\u539f\u7406\u53ca\u7279\u70b9\uff1f * RAID 0\uff0c\u53ef\u4ee5\u662f\u4e00\u5757\u76d8\u548cN\u4e2a\u76d8\u7ec4\u5408\uff0c\u4f18\u70b9\u8bfb\u5199\u5feb\uff0c\u7f3a\u70b9\uff1a\u6ca1\u6709\u5197\u4f59\uff0c\u4e00\u5757\u574f\u4e86\u6570\u636e\u5c31\u5168\u6ca1\u6709\u4e86 * RAID 1\uff0c\u53ea\u80fd2\u5757\u76d8\uff0c\u76d8\u7684\u5927\u5c0f\u53ef\u4ee5\u4e0d\u4e00\u6837\uff0c\u4ee5\u5c0f\u7684\u4e3a\u51c6\uff0c100%\u7684\u5197\u4f59\uff0c\u7f3a\u70b9\uff1a\u6d6a\u8d39\u8d44\u6e90 * RAID 5 \uff0c3\u5757\u76d8\uff0c\u5bb9\u91cf\u8ba1\u7b9710*\uff08n-1\uff09,\u635f\u5931\u4e00\u5757\u76d8\uff0c\u8bfb\u6027\u80fd\u4e00\u822c\uff0c\u5199\u4e0d\u597d * \u5355\u53f0\u670d\u52a1\u5668\uff1a\u7cfb\u7edf\u76d8\uff0cRAID1 * \u6570\u636e\u5e93\u670d\u52a1\u5668\uff1a\u4e3b\u5e93\uff1aRAID10 \u4ece\u5e93 RAID5","title":"\u5b58\u50a8"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/ops_interview/#_5","text":"\u7070\u5ea6\u53d1\u5e03\uff1f * \u9ed1\u4e0e\u767d\u4e4b\u95f4\uff0c\u80fd\u591f\u5e73\u6ed1\u8fc7\u6e21\u7684\u4e00\u79cd\u53d1\u5e03\u65b9\u5f0f\uff0c\u5982AB Test\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u6574\u4f53\u7cfb\u7edf\u7684\u7a33\u5b9a\uff0c\u5728\u521d\u59cb\u7070\u5ea6\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u53d1\u73b0\u3001\u8c03\u6574\u95ee\u9898\uff0c\u4ee5\u4fdd\u8bc1\u5176\u5f71\u54cd\u5ea6","title":"\u53d8\u66f4\u4e0e\u53d1\u5e03"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/ops_interview/#_6","text":"DNS\u8fdb\u884c\u57df\u540d\u89e3\u6790\u7684\u8fc7\u7a0b\uff1f * \u672c\u673a\u7684host\u6587\u4ef6-- \u672c\u5730\u8bbe\u7f6e\u7684DNS\u670d\u52a1\u5668-- \u7f51\u7edc\u4e2d\u627e\u6839\u670d\u52a1\u5668-- \u4e00\u7ea7\u57df\u540d\u670d\u52a1\u5668.cn-- \u4e8c\u7ea7\u57df\u540d\u670d\u52a1\u5668.com.cn-- \u4e09\u7ea7\u57df\u540d\u670d\u52a1\u5668.baidu.com.cn\uff0c\u6b63\u597d\u6709\u8fd9\u4e2a\u7f51\u7ad9www.baidu.com\uff0c\u7136\u540e\u53d1\u7ed9\u8bf7\u6c42\u7684\u670d\u52a1\u5668\uff0c\u4fdd\u5b58\u4e00\u4efd\u4e4b\u540e\uff0c\u518d\u53d1\u7ed9\u5ba2\u6237\u7aef","title":"\u7f51\u7edc"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/ops_interview/#_7","text":"RabbitMQ\uff1f * \u6d88\u606f\u4e2d\u95f4\u4ef6\u662f\u5728\u6d88\u606f\u7684\u4f20\u606f\u8fc7\u7a0b\u4e2d\u4fdd\u5b58\u6d88\u606f\u7684\u5bb9\u5668\uff1b\u76ee\u7684\u662f\u63d0\u4f9b\u8def\u7531\u5e76\u4fdd\u8bc1\u6d88\u606f\u7684\u4f20\u9012\uff1b\u5982\u679c\u53d1\u9001\u6d88\u606f\u65f6\u63a5\u6536\u8005\u4e0d\u53ef\u7528\u6d88\u606f\u961f\u5217\u4e0d\u4f1a\u4fdd\u7559\u6d88\u606f\uff0c\u76f4\u5230\u53ef\u4ee5\u6210\u529f\u5730\u4f20\u9012\u4e3a\u6b62\uff0c\u6709\u65f6\u9650","title":"\u4e2d\u95f4\u4ef6"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/ops_interview/#_8","text":"mysql\u5982\u4f55\u51cf\u5c11\u4e3b\u4ece\u590d\u5236\u5ef6\u8fdf\uff1f\u53ef\u80fd\u539f\u56e0\uff1f * \u4ece\u5e93\u786c\u4ef6\u6bd4\u4e3b\u5e93\u5dee * \u6162SQL\u8bed\u53e5\u8fc7\u591a * \u7f51\u7edc\u5ef6\u8fdf * \u4e3b\u5e93\u8bfb\u5199\u538b\u529b\u5927\uff0c\u5efa\u8bae\u524d\u7aef\u52a0Cache * \u591a\u53f0slave\u6765\u5206\u644a\u8bfb\u8bf7\uff0c\u5176\u4e2d1\u53f0\u4e13\u7528\u4e8e\u5907\u4efd \u91cd\u7f6emysql root\u5bc6\u7801\uff1f * \u672c\u673ash\u4e0b\uff1a mysqladmin \u2013u root \u2013p password \"\u65b0\u5bc6\u7801\" * mysql \u73af\u5883\u4e2d\uff1a Update mysql.user set password=password('\u65b0\u5bc6\u7801') where user='root';flush privileges; \u6216\u8005 grant all on *.* to root@'localhost' identified by '\u65b0\u5bc6\u7801'\uff1b * \u5fd8\u8bb0root\u5bc6\u7801\u65f6\uff1a * \u505c\u6b62\u670d\u52a1 service mysqld stop * \u5b89\u5168\u6a21\u5f0f mysql/bin/mysqld_safe --skip-grant-table * \u7528\u7a7a\u5bc6\u7801\u7684root\u7528\u6237\u767b\u5f55 mysql -u root \uff0c\u540e\u540c\u4e0a mysql\u6570\u636e\u5907\u4efd? * mysql/bin/mysqldump \uff1a\u652f\u6301\u70ed\u5907\uff0c\u903b\u8f91\u5907\u4efd\uff0c\u901f\u5ea6\u4e0d\u5feb\uff0c\u9002\u5408\u6570\u636e\u6bd4\u8f83\u5c0f\u573a\u666f * LVM\u5feb\u7167\uff1a\u53ea\u80fd\u8fdb\u884c\u6ce0\u5907\u4efd * tar\u5305\u5907\u4efd","title":"\u6570\u636e\u5e93"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/ops_interview/#bash","text":"\u5206\u6790nginx\u8bbf\u95ee\u65e5\u5fd7\uff0c\u627e\u51fa\u8bbf\u95ee\u9875\u9762\u6570\u91cf\u5728\u524d\u5341\u4f4d\u7684ip: cat access.log | awk '{print $1}' | uniq -c | sort -rn | head -10 \u76d1\u542c\u4e3b\u673a\u4e3a192.168.1.1\uff0ctcp\u7aef\u53e3\u4e3a80\u7684\u6570\u636e\uff0c\u540c\u65f6\u5c06\u8f93\u51fa\u7ed3\u679c\u4fdd\u5b58\u8f93\u51fa\u5230tcpdump.log: tcpdump 'host 192.168.1.1 and port 80' tcpdump.log \u672c\u573080 \u7aef\u53e3\u7684\u8bf7\u6c42\u8f6c\u53d1\u52308080 \u7aef\u53e3\uff0c\u5f53\u524d\u4e3b\u673aIP \u4e3a192.168.2.1: iptables -A PREROUTING -d 192.168.2.1 -p tcp -m tcp -dport 80 -j DNAT-to-destination 192.168.2.1:8080 \u5b9e\u65f6\u6293\u53d6\u5e76\u663e\u793a\u5f53\u524d\u7cfb\u7edf\u4e2dtcp 80\u7aef\u53e3\u7684\u7f51\u7edc\u6570\u636e: tcpdump -nn tcp port 80 \u67e5\u770bhttp\u7684\u5e76\u53d1\u8bf7\u6c42\u6570\u4e0e\u5176TCP\u8fde\u63a5\u72b6\u6001: netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' \u547d\u4ee4\u53d6\u51fa linux \u4e2d eth0 \u7684 IP: ifconfig eth0|awk 'NR==2'|awk -F \":\" '{print $2}'|awk '{print $1}' \u6bcf\u5929\u665a\u4e0a 12 \u70b9\uff0c\u6253\u5305\u7ad9\u70b9\u76ee\u5f55/var/www/html \u5907\u4efd\u5230/data \u76ee\u5f55\u4e0b: cd /var/www/ /bin/tar zcf /data/html-`date +%m-%d%H`.tar.gz html/ ,\u4f7f\u7528crontab","title":"\u5e38\u7528bash"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/ops_interview/#_9","text":"\u4f18\u5316Linux\u7cfb\u7edf\uff1f * \u4e0d\u7528root\uff0c\u6dfb\u52a0\u666e\u901a\u7528\u6237\uff0c\u901a\u8fc7sudo\u6388\u6743 * \u66f4\u6539\u9ed8\u8ba4\u7684\u8fdc\u7a0b\u8fde\u63a5SSH\u670d\u52a1\u7aef\u53e3\u53ca\u7981\u6b62root\u7528\u6237\u8fdc\u7a0b * \u5b9a\u65f6\u81ea\u52a8\u66f4\u65b0\u670d\u52a1\u5668\u65f6\u95f4 * \u914d\u7f6e\u56fd\u5185yum\u6e90 * \u5173\u95edselinux\u53caiptables\uff0c\u4f46\u662f\u5de5\u4f5c\u573a\u666f\u5982\u679c\u6709\u5916\u7f51IP\u4e00\u5b9a\u8981\u6253\u5f00 * \u8c03\u6574\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u6570\u91cf * \u7cbe\u7b80\u5f00\u673a\u542f\u52a8\u670d\u52a1\uff08crond rsyslog network sshd\uff09 * \u5185\u6838\u53c2\u6570\u4f18\u5316\uff08/etc/sysctl.conf\uff09 * \u66f4\u6539\u5b57\u7b26\u96c6\uff0c\u652f\u6301\u4e2d\u6587\uff0c\u4f46\u5efa\u8bae\u8fd8\u662f\u7528\u82f1\u6587\u5b57\u7b26\u96c6\uff0c\u9632\u6b62\u4e71\u7801 * \u9501\u5b9a\u5173\u952e\u7cfb\u7edf\u6587\u4ef6 * \u6e05\u7a7a/etc/issue\uff0c\u53bb\u9664\u7cfb\u7edf\u53ca\u5185\u6838\u7248\u672c\u767b\u5f55\u524d\u7684\u5c4f\u5e55\u663e\u793a","title":"\u64cd\u4f5c\u7cfb\u7edf"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/ops_interview/#_10","text":"","title":"\u4e2a\u4eba\u5b66\u4e60"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/cmdbuild/","text":"CMDBuild\u914d\u7f6e\u7ba1\u7406\u5e73\u53f0 \u53c2\u8003 \u955c\u50cf\uff1a https://hub.docker.com/r/quentinv/cmdbuild \u5b89\u88c5\uff08docker\u7248\uff09 # \u5b89\u88c5pgsql docker run --name pgsql9.4 \\ -p 0.0.0.0:5432:5432 \\ -e POSTGRES_PASSWORD=admin123 \\ -d postgres:9.4 # \uff08\u53ef\u9009\uff0c\u6570\u636e\u6062\u590d\uff09\u590d\u5236sql\u8fdb\u5bb9\u5668 docker cp ./cmdb_bak.sql pgsql9.4:/tmp/ # \u8fdb\u5165\u5bb9\u5668\u540e\u64cd\u4f5c docker exec -it pgsql9.4 /bin/bash # \u8fdbPostgresql\u8d26\u53f7 su postgres # \u5efa\u5e93 createdb -O postgres cmdbuild # \u5bfc\u6570\u636e psql -U postgres -d cmdbuild /tmp/cmdb_bak.sql # \u9000\u51fa\u5bb9\u5668 # (\u53ef\u9009\uff0c\u6570\u636e\u5907\u4efd) /usr/bin/docker exec pgsql9.4 pg_dump -U postgres cmdbuild /backup/cmdbuild_`date + %Y-%m-%d `.sql # \u542f\u52a8cmdb docker run --name cmdbuild2.4 -p 8080:8080 -d quentinv/cmdbuild:t7-2.4.2 API\u8c03\u7528 # \u8ba4\u8bc1 curl -X POST \\ http://0.0.0.0:8080/services/rest/v1/sessions/ \\ -H 'Content-Type: application/json' \\ -H 'cache-control: no-cache' \\ -d '{ username : admin , password : admin123 }' # \u83b7\u53d6\u6307\u5b9alookup\u7684\u4e0b\u5c5e\u5b9a\u4e49\u5217\u8868\uff0cServerUseType\u662flookup\u552f\u4e00\u82f1\u6587\u540d curl -X GET \\ http://0.0.0.0:8080/services/rest/v1/lookup_types/ServerUseType/values \\ -H 'cache-control: no-cache' \\ -H 'cmdbuild-authorization: oas2l48e16er6hapt6gjqb2hu6' \\ # \u8ba4\u8bc1API\u53cd\u9988\u7684_id -H 'content-type: application/json'","title":"CMDBuild\u914d\u7f6e\u7ba1\u7406\u5e73\u53f0"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/cmdbuild/#cmdbuild","text":"","title":"CMDBuild\u914d\u7f6e\u7ba1\u7406\u5e73\u53f0"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/cmdbuild/#_1","text":"\u955c\u50cf\uff1a https://hub.docker.com/r/quentinv/cmdbuild","title":"\u53c2\u8003"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/cmdbuild/#docker","text":"# \u5b89\u88c5pgsql docker run --name pgsql9.4 \\ -p 0.0.0.0:5432:5432 \\ -e POSTGRES_PASSWORD=admin123 \\ -d postgres:9.4 # \uff08\u53ef\u9009\uff0c\u6570\u636e\u6062\u590d\uff09\u590d\u5236sql\u8fdb\u5bb9\u5668 docker cp ./cmdb_bak.sql pgsql9.4:/tmp/ # \u8fdb\u5165\u5bb9\u5668\u540e\u64cd\u4f5c docker exec -it pgsql9.4 /bin/bash # \u8fdbPostgresql\u8d26\u53f7 su postgres # \u5efa\u5e93 createdb -O postgres cmdbuild # \u5bfc\u6570\u636e psql -U postgres -d cmdbuild /tmp/cmdb_bak.sql # \u9000\u51fa\u5bb9\u5668 # (\u53ef\u9009\uff0c\u6570\u636e\u5907\u4efd) /usr/bin/docker exec pgsql9.4 pg_dump -U postgres cmdbuild /backup/cmdbuild_`date + %Y-%m-%d `.sql # \u542f\u52a8cmdb docker run --name cmdbuild2.4 -p 8080:8080 -d quentinv/cmdbuild:t7-2.4.2","title":"\u5b89\u88c5\uff08docker\u7248\uff09"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/cmdbuild/#api","text":"# \u8ba4\u8bc1 curl -X POST \\ http://0.0.0.0:8080/services/rest/v1/sessions/ \\ -H 'Content-Type: application/json' \\ -H 'cache-control: no-cache' \\ -d '{ username : admin , password : admin123 }' # \u83b7\u53d6\u6307\u5b9alookup\u7684\u4e0b\u5c5e\u5b9a\u4e49\u5217\u8868\uff0cServerUseType\u662flookup\u552f\u4e00\u82f1\u6587\u540d curl -X GET \\ http://0.0.0.0:8080/services/rest/v1/lookup_types/ServerUseType/values \\ -H 'cache-control: no-cache' \\ -H 'cmdbuild-authorization: oas2l48e16er6hapt6gjqb2hu6' \\ # \u8ba4\u8bc1API\u53cd\u9988\u7684_id -H 'content-type: application/json'","title":"API\u8c03\u7528"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/gitlab/","text":"Gitlab\u7248\u672c\u7ba1\u7406 \u53c2\u8003 \u4e2d\u6587\u793e\u533a\u7248github \u5b89\u88c5\uff08\u57fa\u4e8edocker\uff09 \u4ee510.2.8\u7248\u672c\u4e3a\u4f8b\uff0cdocker-compose.yml\u6587\u4ef6\u5982\u4e0b\uff1a version: '2' services: gitlab: container_name: gitlab image: twang2218/gitlab-ce-zh:10.2.8 # \u670d\u52a1\u786c\u4ef6\u9700\u6c42\uff0c500\u4eba\u4ee5\u4e0b\uff1a2Core\uff0c6G\u5185\u5b58\uff0c100G\u786c\u76d8 cpu_quota: 200000 mem_limit: 4G restart: unless-stopped # hostname: 'gitlab.example.com' environment: TZ: 'Asia/Shanghai' GITLAB_OMNIBUS_CONFIG: | gitlab_rails['time_zone'] = 'Asia/Shanghai' # external_url 'http://gitlab.example.com' # \u9700\u8981\u914d\u7f6e\u5230 gitlab.rb \u4e2d\u7684\u914d\u7f6e\u53ef\u4ee5\u5728\u8fd9\u91cc\u914d\u7f6e\uff0c\u6bcf\u4e2a\u914d\u7f6e\u4e00\u884c\uff0c\u6ce8\u610f\u7f29\u8fdb\u3002 # \u6bd4\u5982\u4e0b\u9762\u7684\u7535\u5b50\u90ae\u4ef6\u7684\u914d\u7f6e\uff1a # gitlab_rails['smtp_enable'] = true # gitlab_rails['smtp_address'] = smtp.exmail.qq.com # gitlab_rails['smtp_port'] = 465 # gitlab_rails['smtp_user_name'] = xxxx@xx.com # gitlab_rails['smtp_password'] = password # gitlab_rails['smtp_authentication'] = login # gitlab_rails['smtp_enable_starttls_auto'] = true # gitlab_rails['smtp_tls'] = true # gitlab_rails['gitlab_email_from'] = 'xxxx@xx.com' ports: - '22:22' - '80:80' - '443:443' volumes: # \u63d0\u524d\u5728\u5927\u78c1\u76d8/data\u4e0b\u5efa\u7acb\u76f8\u5173\u76ee\u5f55\uff1a/data/gitlab - /data/gitlab/etc/gitlab:/etc/gitlab - /data/gitlab/log/gitlab:/var/log/gitlab - /data/gitlab/opt/gitlab:/var/opt/gitlab # extra_hosts: # - gitlab.example.com:0.0.0.0 docker-compose up -d \u542f\u52a8 \u7b2c\u4e00\u542f\u52a8\u65f6\uff0c\u91cd\u7f6eroot\u5bc6\u7801 docker-compose down \u505c\u6b62\u670d\u52a1 \u96c6\u6210ldap\u8ba4\u8bc1 \u914d\u7f6email\u670d\u52a1 \u5907\u4efd\u548c\u6062\u590d \u5b98\u65b9\u7248\uff1a # \u5907\u4efd\uff0c\u5728docker\u4e2d\u6267\u884c gitlab-rake gitlab:backup:create # \u5728/var/opt/gitlab/backups\u4e2d\u751f\u6210\u7c7b\u4f3c\uff1a1555502732_2019_04_17_10.2.8_gitlab_backup.tar # \u4ece\u5907\u4efd\u4e2d\u6062\u590d\uff0c\u5148\u505c\u6b62\u670d\u52a1 gitlab-ctl stop unicorn gitlab-ctl stop sidekiq # \u4ece\u6307\u5b9a\u7f16\u53f7\u5907\u4efd\u4e2d\u6062\u590d gitlab-rake gitlab:backup:restore BACKUP=1555502732_2019_04_17_10.2.8 # \u91cd\u542f\u670d\u52a1 gitlab-ctl start \u66b4\u529b\u7248\uff1a # \u505cdocker\uff0c\u5907\u4efd\uff0c\u76f4\u63a5\u628adata\u6253\u5305\uff0c\u751f\u6210\u7c7b\u4f3c\uff1agitback-2019-04-18.tar.gz tar -zcvf /backup/data/gitback-${DATE}.tar.gz -C /data/ # \u6062\u590d\uff0c\u518d\u91cd\u542fdocker tar -xf gitback-2019-04-18.tar.gz -C /data/ docker-compose up -d","title":"Gitlab\u7248\u672c\u7ba1\u7406"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/gitlab/#gitlab","text":"","title":"Gitlab\u7248\u672c\u7ba1\u7406"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/gitlab/#_1","text":"\u4e2d\u6587\u793e\u533a\u7248github","title":"\u53c2\u8003"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/gitlab/#docker","text":"\u4ee510.2.8\u7248\u672c\u4e3a\u4f8b\uff0cdocker-compose.yml\u6587\u4ef6\u5982\u4e0b\uff1a version: '2' services: gitlab: container_name: gitlab image: twang2218/gitlab-ce-zh:10.2.8 # \u670d\u52a1\u786c\u4ef6\u9700\u6c42\uff0c500\u4eba\u4ee5\u4e0b\uff1a2Core\uff0c6G\u5185\u5b58\uff0c100G\u786c\u76d8 cpu_quota: 200000 mem_limit: 4G restart: unless-stopped # hostname: 'gitlab.example.com' environment: TZ: 'Asia/Shanghai' GITLAB_OMNIBUS_CONFIG: | gitlab_rails['time_zone'] = 'Asia/Shanghai' # external_url 'http://gitlab.example.com' # \u9700\u8981\u914d\u7f6e\u5230 gitlab.rb \u4e2d\u7684\u914d\u7f6e\u53ef\u4ee5\u5728\u8fd9\u91cc\u914d\u7f6e\uff0c\u6bcf\u4e2a\u914d\u7f6e\u4e00\u884c\uff0c\u6ce8\u610f\u7f29\u8fdb\u3002 # \u6bd4\u5982\u4e0b\u9762\u7684\u7535\u5b50\u90ae\u4ef6\u7684\u914d\u7f6e\uff1a # gitlab_rails['smtp_enable'] = true # gitlab_rails['smtp_address'] = smtp.exmail.qq.com # gitlab_rails['smtp_port'] = 465 # gitlab_rails['smtp_user_name'] = xxxx@xx.com # gitlab_rails['smtp_password'] = password # gitlab_rails['smtp_authentication'] = login # gitlab_rails['smtp_enable_starttls_auto'] = true # gitlab_rails['smtp_tls'] = true # gitlab_rails['gitlab_email_from'] = 'xxxx@xx.com' ports: - '22:22' - '80:80' - '443:443' volumes: # \u63d0\u524d\u5728\u5927\u78c1\u76d8/data\u4e0b\u5efa\u7acb\u76f8\u5173\u76ee\u5f55\uff1a/data/gitlab - /data/gitlab/etc/gitlab:/etc/gitlab - /data/gitlab/log/gitlab:/var/log/gitlab - /data/gitlab/opt/gitlab:/var/opt/gitlab # extra_hosts: # - gitlab.example.com:0.0.0.0 docker-compose up -d \u542f\u52a8 \u7b2c\u4e00\u542f\u52a8\u65f6\uff0c\u91cd\u7f6eroot\u5bc6\u7801 docker-compose down \u505c\u6b62\u670d\u52a1","title":"\u5b89\u88c5\uff08\u57fa\u4e8edocker\uff09"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/gitlab/#ldap","text":"","title":"\u96c6\u6210ldap\u8ba4\u8bc1"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/gitlab/#mail","text":"","title":"\u914d\u7f6email\u670d\u52a1"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/gitlab/#_2","text":"\u5b98\u65b9\u7248\uff1a # \u5907\u4efd\uff0c\u5728docker\u4e2d\u6267\u884c gitlab-rake gitlab:backup:create # \u5728/var/opt/gitlab/backups\u4e2d\u751f\u6210\u7c7b\u4f3c\uff1a1555502732_2019_04_17_10.2.8_gitlab_backup.tar # \u4ece\u5907\u4efd\u4e2d\u6062\u590d\uff0c\u5148\u505c\u6b62\u670d\u52a1 gitlab-ctl stop unicorn gitlab-ctl stop sidekiq # \u4ece\u6307\u5b9a\u7f16\u53f7\u5907\u4efd\u4e2d\u6062\u590d gitlab-rake gitlab:backup:restore BACKUP=1555502732_2019_04_17_10.2.8 # \u91cd\u542f\u670d\u52a1 gitlab-ctl start \u66b4\u529b\u7248\uff1a # \u505cdocker\uff0c\u5907\u4efd\uff0c\u76f4\u63a5\u628adata\u6253\u5305\uff0c\u751f\u6210\u7c7b\u4f3c\uff1agitback-2019-04-18.tar.gz tar -zcvf /backup/data/gitback-${DATE}.tar.gz -C /data/ # \u6062\u590d\uff0c\u518d\u91cd\u542fdocker tar -xf gitback-2019-04-18.tar.gz -C /data/ docker-compose up -d","title":"\u5907\u4efd\u548c\u6062\u590d"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/redmine/","text":"Redmine\u9700\u6c42\u7ba1\u7406\u5e73\u53f0 \u53c2\u8003 Redmine\u5b98\u65b9\u955c\u50cf\uff1a https://github.com/docker-library/redmine MySQL\u5b98\u65b9\u955c\u50cf\uff1a https://hub.docker.com/_/mysql \u5b89\u88c5\uff08\u57fa\u4e8eDocker\uff09 \u4ee5Redmine-3.2.1 + MySQL-5\u4e3a\u4f8b\uff1a # \u5b89\u88c5MySQL mkdir -p /var/lib/mysql docker run --name mysql -e MYSQL_ROOT_PASSWORD=admin123 -p 3306:3306 -v /var/lib/mysql:/var/lib/mysql -d mysql:5 # \u8fdb\u5165\u5bb9\u5668\u540e\u7ef4\u62a4 docker exec -it mysql bash mysql -uroot -padmin123 \u6267\u884csql\uff1a -- \u5efa\u5e93 CREATE DATABASE redmine CHARACTER SET utf8; -- \u5efa\u7528\u6237 CREATE USER 'redmine'@'localhost' IDENTIFIED BY 'redmine'; -- \u6388\u6743 GRANT ALL PRIVILEGES ON redmine.* TO 'redmine'@'localhost'; \u9000\u51fadb\u540e\uff0c\u5728\u5bb9\u5668\u4e2d\u7ee7\u7eed\uff1a # \uff08\u53ef\u9009\uff0c\u6062\u590d\u6570\u636e\uff09\u5bfc\u5165\u539fsqldump\uff0c\u8981\u6c42\u5e93\u5148\u5b58\u5728 mysql -uroot -padmin123 redmine ./redmine_bak.sql # \u542f\u52a8Redmine docker run \\ -d \\ --name redmine \\ --link mysql:mysql \\ -p 8080:3000 \\ redmine:3.2.1 # \uff08\u53ef\u9009\uff0c\u6570\u636e\u5907\u4efd\uff09 mysqldump -uroot -padmin123 redmine /backup/redmine_`date + %Y-%m-%d `.sql","title":"Redmine\u9700\u6c42\u7ba1\u7406\u5e73\u53f0"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/redmine/#redmine","text":"","title":"Redmine\u9700\u6c42\u7ba1\u7406\u5e73\u53f0"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/redmine/#_1","text":"Redmine\u5b98\u65b9\u955c\u50cf\uff1a https://github.com/docker-library/redmine MySQL\u5b98\u65b9\u955c\u50cf\uff1a https://hub.docker.com/_/mysql","title":"\u53c2\u8003"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/CICD/redmine/#docker","text":"\u4ee5Redmine-3.2.1 + MySQL-5\u4e3a\u4f8b\uff1a # \u5b89\u88c5MySQL mkdir -p /var/lib/mysql docker run --name mysql -e MYSQL_ROOT_PASSWORD=admin123 -p 3306:3306 -v /var/lib/mysql:/var/lib/mysql -d mysql:5 # \u8fdb\u5165\u5bb9\u5668\u540e\u7ef4\u62a4 docker exec -it mysql bash mysql -uroot -padmin123 \u6267\u884csql\uff1a -- \u5efa\u5e93 CREATE DATABASE redmine CHARACTER SET utf8; -- \u5efa\u7528\u6237 CREATE USER 'redmine'@'localhost' IDENTIFIED BY 'redmine'; -- \u6388\u6743 GRANT ALL PRIVILEGES ON redmine.* TO 'redmine'@'localhost'; \u9000\u51fadb\u540e\uff0c\u5728\u5bb9\u5668\u4e2d\u7ee7\u7eed\uff1a # \uff08\u53ef\u9009\uff0c\u6062\u590d\u6570\u636e\uff09\u5bfc\u5165\u539fsqldump\uff0c\u8981\u6c42\u5e93\u5148\u5b58\u5728 mysql -uroot -padmin123 redmine ./redmine_bak.sql # \u542f\u52a8Redmine docker run \\ -d \\ --name redmine \\ --link mysql:mysql \\ -p 8080:3000 \\ redmine:3.2.1 # \uff08\u53ef\u9009\uff0c\u6570\u636e\u5907\u4efd\uff09 mysqldump -uroot -padmin123 redmine /backup/redmine_`date + %Y-%m-%d `.sql","title":"\u5b89\u88c5\uff08\u57fa\u4e8eDocker\uff09"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/\u6279\u91cf\u90e8\u7f72/ansible/","text":"Ansible\u81ea\u52a8\u5316\u90e8\u7f72\u5de5\u5177 \u57fa\u4e8eparamiko\uff08\u7eafPython\u5b9e\u73b0\u7684ssh\u534f\u8bae\u5e93\uff09\u7684\u8fdc\u7a0b\u4e3b\u673a\u6267\u884c\u7684\u6d41\u7a0b\u6846\u67b6 \u5b89\u88c5 pip install ansible \u5e38\u7528 # \u6279\u91cf\u6267\u884c\uff1a\u9a8c\u8bc1\u6307\u5b9a\u6587\u6863\u7684MD5\uff0c-i\u6307\u5b9ahosts\u6587\u4ef6\uff0cprod_app\uff08\u6216\u8005\u6307\u5b9aIP\uff09\u76ee\u6807\u4e3b\u673a\u7ec4 ansible [-i /etc/ansible/hosts] prod_app -m shell -a md5sum /opt/scripts/tools.py # sync\u672c\u5730\u76ee\u5f55\u5230\u76ee\u6807\u4e3b\u673a\u7ec4\uff0c\u5f3a\u8986\u76d6 ansible -i /etc/ansible/hosts_cq.tmp prod_app -m synchronize -a 'src=/opt/scripts/git/ dest=/opt/scripts/tools/ delete=yes' # \u6279\u91cf\u63a8\u9001\u6587\u4ef6 ansible -i /etc/ansible/hosts_cq.tmp prod_app -m copy -a src=/home/op/shell/install.sh dest=/home/op/shell/install.sh /etc/ansible/hosts\u7ed3\u6784 [prod_app] 172.0.200.1 172.0.200.2 [prod_te] te01 ansible_ssh_port=22 ansible_ssh_host=172.0.205.3 te02 ansible_ssh_port=22 ansible_ssh_host=172.0.205.4 play_book --- - hosts: prod_te tasks: - name: check_te shell shell: cat /etc/hosts | grep te /tmp/check_te.log","title":"Ansible\u81ea\u52a8\u5316\u90e8\u7f72\u5de5\u5177"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/\u6279\u91cf\u90e8\u7f72/ansible/#ansible","text":"\u57fa\u4e8eparamiko\uff08\u7eafPython\u5b9e\u73b0\u7684ssh\u534f\u8bae\u5e93\uff09\u7684\u8fdc\u7a0b\u4e3b\u673a\u6267\u884c\u7684\u6d41\u7a0b\u6846\u67b6","title":"Ansible\u81ea\u52a8\u5316\u90e8\u7f72\u5de5\u5177"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/\u6279\u91cf\u90e8\u7f72/ansible/#_1","text":"pip install ansible","title":"\u5b89\u88c5"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/\u6279\u91cf\u90e8\u7f72/ansible/#_2","text":"# \u6279\u91cf\u6267\u884c\uff1a\u9a8c\u8bc1\u6307\u5b9a\u6587\u6863\u7684MD5\uff0c-i\u6307\u5b9ahosts\u6587\u4ef6\uff0cprod_app\uff08\u6216\u8005\u6307\u5b9aIP\uff09\u76ee\u6807\u4e3b\u673a\u7ec4 ansible [-i /etc/ansible/hosts] prod_app -m shell -a md5sum /opt/scripts/tools.py # sync\u672c\u5730\u76ee\u5f55\u5230\u76ee\u6807\u4e3b\u673a\u7ec4\uff0c\u5f3a\u8986\u76d6 ansible -i /etc/ansible/hosts_cq.tmp prod_app -m synchronize -a 'src=/opt/scripts/git/ dest=/opt/scripts/tools/ delete=yes' # \u6279\u91cf\u63a8\u9001\u6587\u4ef6 ansible -i /etc/ansible/hosts_cq.tmp prod_app -m copy -a src=/home/op/shell/install.sh dest=/home/op/shell/install.sh","title":"\u5e38\u7528"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/\u6279\u91cf\u90e8\u7f72/ansible/#etcansiblehosts","text":"[prod_app] 172.0.200.1 172.0.200.2 [prod_te] te01 ansible_ssh_port=22 ansible_ssh_host=172.0.205.3 te02 ansible_ssh_port=22 ansible_ssh_host=172.0.205.4","title":"/etc/ansible/hosts\u7ed3\u6784"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/\u6279\u91cf\u90e8\u7f72/ansible/#play_book","text":"--- - hosts: prod_te tasks: - name: check_te shell shell: cat /etc/hosts | grep te /tmp/check_te.log","title":"play_book"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/\u76d1\u63a7\u544a\u8b66/grafana/","text":"Grafana\u53ef\u89c6\u5316\u76d1\u63a7\u4eea\u8868\u76d8 \u5b89\u88c5\uff08\u57fa\u4e8edocker\uff09 # \u6570\u636e\u548c\u5de5\u4f5c\u76ee\u5f55 mkdir -p /data/grafana/data /data/grafana/log /opt/grafana-conf # docker\u542f\u52a8 docker run -d \\ -p 3000:3000 \\ --name=grafana \\ -e GF_SERVER_ROOT_URL=http://grafana.your.com \\ -e GF_SECURITY_ADMIN_PASSWORD=admin \\ -e GF_INSTALL_PLUGINS=alexanderzobnin-zabbix-app \\ --user $(id -u) \\ --volume /data/grafana/data:/var/lib/grafana \\ --volume /data/grafana/log:/var/log/grafana \\ # --volume /opt/grafana-conf/dashboards:/usr/share/grafana/public/dashboards \\ # --volume /opt/grafana-conf/grafana.ini:/etc/grafana/grafana.ini \\ --volume /etc/localtime:/etc/localtime \\ grafana/grafana:5.3.4 GF_SECURITY_ADMIN_PASSWORD \b\b\u7ba1\u7406\u5458\u5bc6\u7801 GF_INSTALL_PLUGINS \b\u9884\u5b89\u88c5\u7684\b\u63d2\u4ef6 --user $(id -u) \b\b\u5bb9\u5668\b\u8bfb\u5199\u5916\u6302\u78c1\u76d8\uff0c\u9700\u8981\b\u5f53\u524d\u7528\u6237\u6743\u9650 \u66f4\u65b0\u914d\u7f6e\u6d41\u7a0b \u66f4\u65b0\u672cgit\u5e93 \u4e0a\u751f\u4ea7\u73af\u5883\u7684\b\u914d\u7f6e\u76ee\u5f55\uff08/opt/grafana-conf/\uff09\u6267\u884cgit pull \u6267\u884c docker restart grafana \u5bfc\u51fa\u548c\u5bfc\u5165 \u53c2\u8003\uff1ahttps://github.com/hagen1778/grafana-import-export \u4f9d\u8d56\uff1ajq - commandline JSON processor \u914d\u7f6e\uff1a \u66f4\u65b0 config.sh \u4e2d\u7684 HOST \u548c FILE_DIR ORGS \u6570\u7ec4\uff0c\u5199\u7533\u8bf7\u5bf9\u5e94\u7684 Name:API_KEY # \u5bfc\u51fa ./exporter.sh # \u8f93\u51fa\u7ed3\u679c\u7c7b\u4f3c\uff1a elastalert-xxx.json % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 1939 100 1939 0 0 33215 0 --:--:-- --:--:-- --:--:-- 33431 # \u5168\u5bfc\u5165 ./importer.sh # \u6307\u5b9a\u5bfc\u5165\uff0c\u652f\u6301* ./importer.sh data/{Name}/dashboards/dashboard.json data/{Name}/datasources/*.json \u8e29\u5751 dashboards\u4e2d\u6709\u968f\u673aurl\uff0c\u5efa\u8bae\u4e0d\u8981\u7528\u5bfc\u51fa\u7684json\uff0c\u800c\u662f\u7528\u63d0\u524d\u5728\u8001Grafana\u4e0a\u7528\u201cExport\u201d\u6309\u94ae\u5bfc\u51fa\u7684json\uff0c\u518d\u4e00\u4e2a\u4e2a\u5bfc\u5165","title":"Grafana\u53ef\u89c6\u5316\u76d1\u63a7\u4eea\u8868\u76d8"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/\u76d1\u63a7\u544a\u8b66/grafana/#grafana","text":"","title":"Grafana\u53ef\u89c6\u5316\u76d1\u63a7\u4eea\u8868\u76d8"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/\u76d1\u63a7\u544a\u8b66/grafana/#docker","text":"# \u6570\u636e\u548c\u5de5\u4f5c\u76ee\u5f55 mkdir -p /data/grafana/data /data/grafana/log /opt/grafana-conf # docker\u542f\u52a8 docker run -d \\ -p 3000:3000 \\ --name=grafana \\ -e GF_SERVER_ROOT_URL=http://grafana.your.com \\ -e GF_SECURITY_ADMIN_PASSWORD=admin \\ -e GF_INSTALL_PLUGINS=alexanderzobnin-zabbix-app \\ --user $(id -u) \\ --volume /data/grafana/data:/var/lib/grafana \\ --volume /data/grafana/log:/var/log/grafana \\ # --volume /opt/grafana-conf/dashboards:/usr/share/grafana/public/dashboards \\ # --volume /opt/grafana-conf/grafana.ini:/etc/grafana/grafana.ini \\ --volume /etc/localtime:/etc/localtime \\ grafana/grafana:5.3.4 GF_SECURITY_ADMIN_PASSWORD \b\b\u7ba1\u7406\u5458\u5bc6\u7801 GF_INSTALL_PLUGINS \b\u9884\u5b89\u88c5\u7684\b\u63d2\u4ef6 --user $(id -u) \b\b\u5bb9\u5668\b\u8bfb\u5199\u5916\u6302\u78c1\u76d8\uff0c\u9700\u8981\b\u5f53\u524d\u7528\u6237\u6743\u9650","title":"\u5b89\u88c5\uff08\u57fa\u4e8edocker\uff09"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/\u76d1\u63a7\u544a\u8b66/grafana/#_1","text":"\u66f4\u65b0\u672cgit\u5e93 \u4e0a\u751f\u4ea7\u73af\u5883\u7684\b\u914d\u7f6e\u76ee\u5f55\uff08/opt/grafana-conf/\uff09\u6267\u884cgit pull \u6267\u884c docker restart grafana","title":"\u66f4\u65b0\u914d\u7f6e\u6d41\u7a0b"},{"location":"03.\u8fd0\u7ef4\u7814\u53d1/\u76d1\u63a7\u544a\u8b66/grafana/#_2","text":"\u53c2\u8003\uff1ahttps://github.com/hagen1778/grafana-import-export \u4f9d\u8d56\uff1ajq - commandline JSON processor \u914d\u7f6e\uff1a \u66f4\u65b0 config.sh \u4e2d\u7684 HOST \u548c FILE_DIR ORGS \u6570\u7ec4\uff0c\u5199\u7533\u8bf7\u5bf9\u5e94\u7684 Name:API_KEY # \u5bfc\u51fa ./exporter.sh # \u8f93\u51fa\u7ed3\u679c\u7c7b\u4f3c\uff1a elastalert-xxx.json % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 1939 100 1939 0 0 33215 0 --:--:-- --:--:-- --:--:-- 33431 # \u5168\u5bfc\u5165 ./importer.sh # \u6307\u5b9a\u5bfc\u5165\uff0c\u652f\u6301* ./importer.sh data/{Name}/dashboards/dashboard.json data/{Name}/datasources/*.json \u8e29\u5751 dashboards\u4e2d\u6709\u968f\u673aurl\uff0c\u5efa\u8bae\u4e0d\u8981\u7528\u5bfc\u51fa\u7684json\uff0c\u800c\u662f\u7528\u63d0\u524d\u5728\u8001Grafana\u4e0a\u7528\u201cExport\u201d\u6309\u94ae\u5bfc\u51fa\u7684json\uff0c\u518d\u4e00\u4e2a\u4e2a\u5bfc\u5165","title":"\u5bfc\u51fa\u548c\u5bfc\u5165"},{"location":"04.\u7ecf\u6d4e\u91d1\u878d/\u57fa\u91d1/","text":"\u8bc1\u5238\u6295\u8d44\u57fa\u91d1 \u4e3a\u4e86\u8003\u300a\u57fa\u91d1\u4ece\u4e1a\u8d44\u683c\u8bc1\u300b\u7684\u8bfb\u4e66\u7b14\u8bb0","title":"\u8bc1\u5238\u6295\u8d44\u57fa\u91d1"},{"location":"04.\u7ecf\u6d4e\u91d1\u878d/\u57fa\u91d1/#_1","text":"\u4e3a\u4e86\u8003\u300a\u57fa\u91d1\u4ece\u4e1a\u8d44\u683c\u8bc1\u300b\u7684\u8bfb\u4e66\u7b14\u8bb0","title":"\u8bc1\u5238\u6295\u8d44\u57fa\u91d1"},{"location":"04.\u7ecf\u6d4e\u91d1\u878d/\u57fa\u91d1/\u884c\u4e1a\u6982\u8ff0/","text":"\u884c\u4e1a\u6982\u8ff0 \u91d1\u878d\u5e02\u573a \u8d44\u4ea7\u7ba1\u7406 \u6295\u8d44\u57fa\u91d1 \u5c45\u6c11\u7406\u8d22 \u91d1\u878d\u5e02\u573a \u5c45\u6c11\u7406\u8d22\uff1a \u91d1\u878d\uff1a \u8d27\u5e01\u8d44\u91d1\u7684\u901a\u878d\uff0c\u8d27\u5e01\u8d44\u91d1\u6765\u6e90\u4e8e\u5c45\u6c11\u4ece\u4e8b\u7684\u751f\u4ea7\u6d3b\u52a8\u3002\u65e5\u5e38\u6536\u5165\u3001\u652f\u51fa\u3001\u50a8\u84c4\u3001\u6295\u8d44\u7b49\u662f\u7ec4\u6210\u90e8\u5206 \u7406\u8d22\uff1a \u5bf9\u8d22\u52a1\u8fdb\u884c\u7ba1\u7406\uff0c\u4ee5\u5b9e\u73b0\u8d22\u4ea7\u7684\u4fdd\u503c\u3001\u5347\u503c\uff1b\u4e3b\u8981\u662f\u50a8\u84c4\u548c\u7406\u8d222\u7c7b \u50a8\u84c4\uff1a \u5c45\u6c11\u6682\u65f6\u4e0d\u7528\u3001\u7ed3\u4f59\u7684\u8d27\u5e01\u6536\u5165\u5b58\u94f6\u884c\uff08\u6216\u5176\u4ed6\u91d1\u878d\u673a\u6784\uff09\u7684\u5b58\u6b3e\u6d3b\u52a8\uff0c\u7279\u5f81\u662f\u4fdd\u503c\u6027\uff08\u672c\u91d1\u5b89\u5168\uff09 \u6295\u8d44\uff1a \u6295\u8d44\u8005\u5f53\u671f\u6295\u5165\u4e00\u5b9a\u6570\u989d\u7684\u8d44\u91d1\uff0c\u671f\u671b\u5728\u672a\u6765\u6536\u83b7\u66f4\u591a\u56de\u62a5\uff0c\u5176\u80fd\u8865\u507f\u6295\u8d44\u8d44\u91d1\u88ab\u5360\u7528\u7684\u65f6\u95f4\u3001\u9884\u671f\u7684\u901a\u8d27\u81a8\u80c0\u7387\u3001\u66f4\u591a\u7684\u672a\u6765\u6536\u76ca\uff0c\u5177\u6709\u4e0d\u786e\u5b9a\u6027 \u91d1\u878d\u5e02\u573a\uff1a \u5b9a\u4e49\uff1a\u8d44\u91d1\u4f9b\u5e94\u8005\u3001\u8d44\u91d1\u9700\u6c42\u8005\u901a\u8fc7\u91d1\u878d\u5de5\u5177\u8fdb\u884c\u4ea4\u6613\u800c\u8d27\u5e01\u8d44\u91d1\u901a\u878d\u5e02\u573a \u5206\u7c7b\uff1a * \u4ea4\u6613\u5de5\u5177\u7684\u4e0d\u540c\u671f\u9650\uff1a * \u8d27\u5e01\uff08\u77ed\u671f\u91d1\u878d\uff09\u5e02\u573a\uff1a \u4e0d\u8d85\u8fc7\u4e00\u5e74\uff0c\u540c\u4e1a\u62c6\u501f\u3001\u56de\u8d2d\u3001\u7968\u636e\u3001\u5927\u9762\u989d\u53ef\u8f6c\u8ba9\u5b58\u5355\u7b49\u5e02\u573a * \u8d44\u672c\uff08\u957f\u671f\u91d1\u878d\uff09\u5e02\u573a\uff1a \u4e00\u5e74\u4ee5\u4e0a\u6709\u4ef7\u8bc1\u5238\u4e3a\u4ea4\u6613\u5de5\u5177\uff0c\u94f6\u884c\u4e2d\u957f\u671f\u5b58\u8d37\u6b3e\u3001\u6709\u4ef7\u8bc1\u5238\uff08\u4e2d\u957f\u671f\u503a\u5238\u548c\u80a1\u7968\uff09\u5e02\u573a * \u4e0d\u540c\u4ea4\u6613\u6807\u7684\u7269\uff1a * \u7968\u636e\u5e02\u573a\uff1a \u7968\u636e\u627f\u5151\u3001\u8d34\u73b0\uff0c\u662f\u8d27\u5e01\u5e02\u573a\u7684\u91cd\u8981\u7ec4\u6210 * \u8bc1\u5238\u5e02\u573a\uff1a \u6709\u4ef7\u8bc1\u5238\u53d1\u884c\u548c\u8f6c\u8ba9\u6d41\u901a * \u80a1\u7968\uff1a \u80a1\u4efd\u6709\u9650\u516c\u53f8\u53d1\u884c\u65b0\u80a1\u7968\u7684\u53d1\u884c\uff08\u80a1\u7968\u521d\u7ea7\uff09\u5e02\u573a\uff1b\u5df2\u53d1\u884c\u80a1\u7968\u7684\u8f6c\u8ba9\u6d41\u901a\u7684\u80a1\u7968\u4e8c\u7ea7\u5e02\u573a * \u503a\u5238\uff1a \u653f\u5e9c\u503a\u5238\u3001\u4f01\u4e1a\u503a\u5238\u3001\u91d1\u878d\u503a\u5238 * \u57fa\u91d1\uff1a * \u884d\u751f\u5de5\u5177\u5e02\u573a\uff1a \u884d\u751f\u91d1\u878d\u5de5\u5177\u8fdb\u884c\u4ea4\u6613\uff0c\u5957\u671f\u4fdd\u503c\u3001\u9632\u8303\u98ce\u9669\u4f5c\u7528 * \u8fdc\u671f\u5408\u7ea6 * \u671f\u8d27\u5408\u7ea6 * \u671f\u6743\u4ea4\u6613 * \u4e92\u6362\u534f\u8bae * \u5916\u6c47\u5e02\u573a\uff1a\u592e\u884c\u3001\u94f6\u884c\u3001\u7ecf\u7eaa\u4eba\u3001\u5ba2\u6237\u7684\u5916\u6c47\u4e70\u5356\u3001\u7ecf\u8425\u6d3b\u52a8\u7684\u603b\u548c * \u9ec4\u91d1\u5e02\u573a\uff1a \u9ec4\u91d1\u4ecd\u662f\u56fd\u9645\u50a8\u5907\u8d44\u4ea7\u4e4b\u4e00\uff0c\u5728\u652f\u4ed8\u4e2d\u6709\u5730\u4f4d * \u4ea4\u5272\u671f\u9650\uff1a * \u73b0\u8d27\u5e02\u573a\uff1a \u534f\u8bae\u8fbe\u6210\u540e2\u4e2a\u4ea4\u6613\u65e5\u5185\u4ea4\u5272\uff0c * \u671f\u8d27\u5e02\u573a\uff1a TODO \u91d1\u878d\u8d44\u4ea7 \u8d44\u4ea7\u7ba1\u7406\u884c\u4e1a \u4e2d\u56fd\u8d44\u4ea7\u7ba1\u7406\u884c\u4e1a\u73b0\u72b6 \u6295\u8d44\u57fa\u91d1\u7b80\u4ecb","title":"\u884c\u4e1a\u6982\u8ff0"},{"location":"04.\u7ecf\u6d4e\u91d1\u878d/\u57fa\u91d1/\u884c\u4e1a\u6982\u8ff0/#_1","text":"","title":"\u884c\u4e1a\u6982\u8ff0"},{"location":"04.\u7ecf\u6d4e\u91d1\u878d/\u57fa\u91d1/\u884c\u4e1a\u6982\u8ff0/#_2","text":"","title":"\u91d1\u878d\u5e02\u573a \u8d44\u4ea7\u7ba1\u7406 \u6295\u8d44\u57fa\u91d1"},{"location":"04.\u7ecf\u6d4e\u91d1\u878d/\u57fa\u91d1/\u884c\u4e1a\u6982\u8ff0/#_3","text":"\u5c45\u6c11\u7406\u8d22\uff1a \u91d1\u878d\uff1a \u8d27\u5e01\u8d44\u91d1\u7684\u901a\u878d\uff0c\u8d27\u5e01\u8d44\u91d1\u6765\u6e90\u4e8e\u5c45\u6c11\u4ece\u4e8b\u7684\u751f\u4ea7\u6d3b\u52a8\u3002\u65e5\u5e38\u6536\u5165\u3001\u652f\u51fa\u3001\u50a8\u84c4\u3001\u6295\u8d44\u7b49\u662f\u7ec4\u6210\u90e8\u5206 \u7406\u8d22\uff1a \u5bf9\u8d22\u52a1\u8fdb\u884c\u7ba1\u7406\uff0c\u4ee5\u5b9e\u73b0\u8d22\u4ea7\u7684\u4fdd\u503c\u3001\u5347\u503c\uff1b\u4e3b\u8981\u662f\u50a8\u84c4\u548c\u7406\u8d222\u7c7b \u50a8\u84c4\uff1a \u5c45\u6c11\u6682\u65f6\u4e0d\u7528\u3001\u7ed3\u4f59\u7684\u8d27\u5e01\u6536\u5165\u5b58\u94f6\u884c\uff08\u6216\u5176\u4ed6\u91d1\u878d\u673a\u6784\uff09\u7684\u5b58\u6b3e\u6d3b\u52a8\uff0c\u7279\u5f81\u662f\u4fdd\u503c\u6027\uff08\u672c\u91d1\u5b89\u5168\uff09 \u6295\u8d44\uff1a \u6295\u8d44\u8005\u5f53\u671f\u6295\u5165\u4e00\u5b9a\u6570\u989d\u7684\u8d44\u91d1\uff0c\u671f\u671b\u5728\u672a\u6765\u6536\u83b7\u66f4\u591a\u56de\u62a5\uff0c\u5176\u80fd\u8865\u507f\u6295\u8d44\u8d44\u91d1\u88ab\u5360\u7528\u7684\u65f6\u95f4\u3001\u9884\u671f\u7684\u901a\u8d27\u81a8\u80c0\u7387\u3001\u66f4\u591a\u7684\u672a\u6765\u6536\u76ca\uff0c\u5177\u6709\u4e0d\u786e\u5b9a\u6027 \u91d1\u878d\u5e02\u573a\uff1a \u5b9a\u4e49\uff1a\u8d44\u91d1\u4f9b\u5e94\u8005\u3001\u8d44\u91d1\u9700\u6c42\u8005\u901a\u8fc7\u91d1\u878d\u5de5\u5177\u8fdb\u884c\u4ea4\u6613\u800c\u8d27\u5e01\u8d44\u91d1\u901a\u878d\u5e02\u573a \u5206\u7c7b\uff1a * \u4ea4\u6613\u5de5\u5177\u7684\u4e0d\u540c\u671f\u9650\uff1a * \u8d27\u5e01\uff08\u77ed\u671f\u91d1\u878d\uff09\u5e02\u573a\uff1a \u4e0d\u8d85\u8fc7\u4e00\u5e74\uff0c\u540c\u4e1a\u62c6\u501f\u3001\u56de\u8d2d\u3001\u7968\u636e\u3001\u5927\u9762\u989d\u53ef\u8f6c\u8ba9\u5b58\u5355\u7b49\u5e02\u573a * \u8d44\u672c\uff08\u957f\u671f\u91d1\u878d\uff09\u5e02\u573a\uff1a \u4e00\u5e74\u4ee5\u4e0a\u6709\u4ef7\u8bc1\u5238\u4e3a\u4ea4\u6613\u5de5\u5177\uff0c\u94f6\u884c\u4e2d\u957f\u671f\u5b58\u8d37\u6b3e\u3001\u6709\u4ef7\u8bc1\u5238\uff08\u4e2d\u957f\u671f\u503a\u5238\u548c\u80a1\u7968\uff09\u5e02\u573a * \u4e0d\u540c\u4ea4\u6613\u6807\u7684\u7269\uff1a * \u7968\u636e\u5e02\u573a\uff1a \u7968\u636e\u627f\u5151\u3001\u8d34\u73b0\uff0c\u662f\u8d27\u5e01\u5e02\u573a\u7684\u91cd\u8981\u7ec4\u6210 * \u8bc1\u5238\u5e02\u573a\uff1a \u6709\u4ef7\u8bc1\u5238\u53d1\u884c\u548c\u8f6c\u8ba9\u6d41\u901a * \u80a1\u7968\uff1a \u80a1\u4efd\u6709\u9650\u516c\u53f8\u53d1\u884c\u65b0\u80a1\u7968\u7684\u53d1\u884c\uff08\u80a1\u7968\u521d\u7ea7\uff09\u5e02\u573a\uff1b\u5df2\u53d1\u884c\u80a1\u7968\u7684\u8f6c\u8ba9\u6d41\u901a\u7684\u80a1\u7968\u4e8c\u7ea7\u5e02\u573a * \u503a\u5238\uff1a \u653f\u5e9c\u503a\u5238\u3001\u4f01\u4e1a\u503a\u5238\u3001\u91d1\u878d\u503a\u5238 * \u57fa\u91d1\uff1a * \u884d\u751f\u5de5\u5177\u5e02\u573a\uff1a \u884d\u751f\u91d1\u878d\u5de5\u5177\u8fdb\u884c\u4ea4\u6613\uff0c\u5957\u671f\u4fdd\u503c\u3001\u9632\u8303\u98ce\u9669\u4f5c\u7528 * \u8fdc\u671f\u5408\u7ea6 * \u671f\u8d27\u5408\u7ea6 * \u671f\u6743\u4ea4\u6613 * \u4e92\u6362\u534f\u8bae * \u5916\u6c47\u5e02\u573a\uff1a\u592e\u884c\u3001\u94f6\u884c\u3001\u7ecf\u7eaa\u4eba\u3001\u5ba2\u6237\u7684\u5916\u6c47\u4e70\u5356\u3001\u7ecf\u8425\u6d3b\u52a8\u7684\u603b\u548c * \u9ec4\u91d1\u5e02\u573a\uff1a \u9ec4\u91d1\u4ecd\u662f\u56fd\u9645\u50a8\u5907\u8d44\u4ea7\u4e4b\u4e00\uff0c\u5728\u652f\u4ed8\u4e2d\u6709\u5730\u4f4d * \u4ea4\u5272\u671f\u9650\uff1a * \u73b0\u8d27\u5e02\u573a\uff1a \u534f\u8bae\u8fbe\u6210\u540e2\u4e2a\u4ea4\u6613\u65e5\u5185\u4ea4\u5272\uff0c * \u671f\u8d27\u5e02\u573a\uff1a TODO","title":"\u5c45\u6c11\u7406\u8d22&amp;\u91d1\u878d\u5e02\u573a"},{"location":"04.\u7ecf\u6d4e\u91d1\u878d/\u57fa\u91d1/\u884c\u4e1a\u6982\u8ff0/#_4","text":"","title":"\u91d1\u878d\u8d44\u4ea7&amp;\u8d44\u4ea7\u7ba1\u7406\u884c\u4e1a"},{"location":"04.\u7ecf\u6d4e\u91d1\u878d/\u57fa\u91d1/\u884c\u4e1a\u6982\u8ff0/#_5","text":"","title":"\u4e2d\u56fd\u8d44\u4ea7\u7ba1\u7406\u884c\u4e1a\u73b0\u72b6"},{"location":"04.\u7ecf\u6d4e\u91d1\u878d/\u57fa\u91d1/\u884c\u4e1a\u6982\u8ff0/#_6","text":"","title":"\u6295\u8d44\u57fa\u91d1\u7b80\u4ecb"},{"location":"05.\u5f00\u6e90\u9879\u76ee/stock-starer\u80a1\u7968\u76ef\u76d8/readme/","text":"Stock Starer\u80a1\u7968\u76ef\u76d8 \u4e00\u4e2a\u4e1a\u4f59\u5c0f\u9879\u76ee\uff0c\u7528\u4e8e\u76d1\u63a7\u6307\u5b9a\u80a1\u7968\u7684\u6210\u4ea4\u6307\u6807\uff0c\u89e6\u53d1\u4e8b\u4ef6\u7684\u4e3b\u52a8\u901a\u77e5 \u6e90\u7801 ! https://github.com/jeffchen81/stock-starer \u8bbe\u8ba1\u8bf4\u660e \u573a\u666f \u5b9a\u65f6\u4efb\u52a11\uff1a\u901a\u8fc7\u7f51\u4e0aOpen API\uff0c\u6293\u53d6\u6307\u5b9a\u80a1\u7968\u7684\u5373\u65f6\u4ea4\u6613\u4fe1\u606f\uff0c\u683c\u5f0f\u5316\u540e\u5b58\u5165\u539f\u59cb\u6570\u636e\u8868 \u5b9a\u65f6\u4efb\u52a12\uff1a\u6839\u636e\u6307\u6807\u516c\u5f0f\uff0c\u8ba1\u7b97\u51fa\u65b0\u7684\u6307\u6807\u6570\u636e\uff0c\u5b58\u5165\u6307\u6807\u6570\u636e\u8868 \u5b9a\u65f6\u4efb\u52a13\uff1a\u5224\u65ad\u6307\u6807\u6570\u636e\u662f\u5426\u89e6\u53d1\u63d0\u9192\u4e8b\u4ef6\uff0c\u5982\u89e6\u53d1\u5c31\u53d1\u90ae\u4ef6\u7ed9\u7528\u6237 \uff08\u53ef\u9009\uff09\u53ef\u89c6\u5316\u56fe\u8868\uff1a\u6307\u5b9a\u80a1\u7968\u7684\u6307\u6807\u8d8b\u52bf\u56fe \u6280\u672f\u9009\u578b \u5f00\u53d1\u8bed\u8a00\uff1apython2.7 \u6570\u636e\u5e93\uff1asqlite \u4efb\u52a1\u8c03\u5ea6\u5668\uff1acrontab \u80a1\u7968\u6307\u6807\uff1aMACD \u6570\u636e\u6a21\u578b","title":"Stock Starer\u80a1\u7968\u76ef\u76d8"},{"location":"05.\u5f00\u6e90\u9879\u76ee/stock-starer\u80a1\u7968\u76ef\u76d8/readme/#stock-starer","text":"\u4e00\u4e2a\u4e1a\u4f59\u5c0f\u9879\u76ee\uff0c\u7528\u4e8e\u76d1\u63a7\u6307\u5b9a\u80a1\u7968\u7684\u6210\u4ea4\u6307\u6807\uff0c\u89e6\u53d1\u4e8b\u4ef6\u7684\u4e3b\u52a8\u901a\u77e5","title":"Stock Starer\u80a1\u7968\u76ef\u76d8"},{"location":"05.\u5f00\u6e90\u9879\u76ee/stock-starer\u80a1\u7968\u76ef\u76d8/readme/#_1","text":"! https://github.com/jeffchen81/stock-starer","title":"\u6e90\u7801"},{"location":"05.\u5f00\u6e90\u9879\u76ee/stock-starer\u80a1\u7968\u76ef\u76d8/readme/#_2","text":"","title":"\u8bbe\u8ba1\u8bf4\u660e"},{"location":"05.\u5f00\u6e90\u9879\u76ee/stock-starer\u80a1\u7968\u76ef\u76d8/readme/#_3","text":"\u5b9a\u65f6\u4efb\u52a11\uff1a\u901a\u8fc7\u7f51\u4e0aOpen API\uff0c\u6293\u53d6\u6307\u5b9a\u80a1\u7968\u7684\u5373\u65f6\u4ea4\u6613\u4fe1\u606f\uff0c\u683c\u5f0f\u5316\u540e\u5b58\u5165\u539f\u59cb\u6570\u636e\u8868 \u5b9a\u65f6\u4efb\u52a12\uff1a\u6839\u636e\u6307\u6807\u516c\u5f0f\uff0c\u8ba1\u7b97\u51fa\u65b0\u7684\u6307\u6807\u6570\u636e\uff0c\u5b58\u5165\u6307\u6807\u6570\u636e\u8868 \u5b9a\u65f6\u4efb\u52a13\uff1a\u5224\u65ad\u6307\u6807\u6570\u636e\u662f\u5426\u89e6\u53d1\u63d0\u9192\u4e8b\u4ef6\uff0c\u5982\u89e6\u53d1\u5c31\u53d1\u90ae\u4ef6\u7ed9\u7528\u6237 \uff08\u53ef\u9009\uff09\u53ef\u89c6\u5316\u56fe\u8868\uff1a\u6307\u5b9a\u80a1\u7968\u7684\u6307\u6807\u8d8b\u52bf\u56fe","title":"\u573a\u666f"},{"location":"05.\u5f00\u6e90\u9879\u76ee/stock-starer\u80a1\u7968\u76ef\u76d8/readme/#_4","text":"\u5f00\u53d1\u8bed\u8a00\uff1apython2.7 \u6570\u636e\u5e93\uff1asqlite \u4efb\u52a1\u8c03\u5ea6\u5668\uff1acrontab \u80a1\u7968\u6307\u6807\uff1aMACD","title":"\u6280\u672f\u9009\u578b"},{"location":"05.\u5f00\u6e90\u9879\u76ee/stock-starer\u80a1\u7968\u76ef\u76d8/readme/#_5","text":"","title":"\u6570\u636e\u6a21\u578b"}]}